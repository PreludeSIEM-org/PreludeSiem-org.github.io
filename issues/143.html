<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #143: prelude-manager overstepping varchar(255) field - LibpreludeDB - UNITY 360</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="AoXAeuvF+ZIZEM0AWfNtZLYz0Pf3ircpdVv3i7+6swoRqqgVItH0EZO6xfpEuyQ6ynihae2A7mer1TMbO7qHCQ==" />
<link rel='shortcut icon' href='/themes/prelude/favicon/Prelude-icon.png' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css" />
<link rel="stylesheet" media="all" href="/themes/prelude/stylesheets/application.css" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-3.1.4.js"></script>
<script src="/javascripts/application.js"></script>
<script src="/javascripts/responsive.js"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>



<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="LibpreludeDB - Bug #143: prelude-manager overstepping varchar(255) field" href="http://www.prelude-siem.org/issues/143.atom" />
<script src="/javascripts/context_menu.js"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css" /></head>
<body class="theme-Prelude project-libpreludedb controller-issues action-show">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/libpreludedb/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li><li><a class="register" href="/account/register">Register</a></li></ul>    </div>
    
    <ul><li><a class="PreludeOSS" href="/projects/prelude">Prelude OSS</a></li><li><a target="_blank" class="SIEMVersion" href="http://www.prelude-siem.com">Prelude SIEM</a></li><li><a class="VigiloOSS" href="/projects/vigilo-nms">Vigilo OSS</a></li><li><a target="_blank" class="NMSVersion" href="http://www.vigilo-nms.com">Vigilo NMS</a></li><li><a class="|" href="#">|</a></li><li><a class="Projects" href="/projects">Projects</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/libpreludedb/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/libpreludedb/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        
    </div>

    <h1>
        <img src="/themes/prelude/img/prelude-logo.png" style="height: 55px"/>
        <a href="https://www.ow2.org/bin/view/Press_Releases/OW2_Open_Source_Community_announces_OW2con_16_Best_Project_Awards" target="_blank"><img src="/themes/prelude/img/ow2-logo.png" style="margin-top: -10px; height: 55px"/></a>
    </h1>

    
    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/libpreludedb">Overview</a></li><li><a class="activity" href="/projects/libpreludedb/activity">Activity</a></li><li><a class="roadmap" href="/projects/libpreludedb/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/libpreludedb/issues">Issues</a></li><li><a class="gantt" href="/projects/libpreludedb/issues/gantt">Gantt</a></li><li><a class="calendar" href="/projects/libpreludedb/issues/calendar">Calendar</a></li><li><a class="repository" href="/projects/libpreludedb/repository">Repository</a></li><li><a target="_blank" class="IDMEFProbe" href="https://www.prelude-siem.com/en/technological-partners/">IDMEF Probes</a></li><li><a target="_blank" class="PrewikkaApps" href="https://github.com/Prelude-SIEM-Contrib">SIEM Apps</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/libpreludedb/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/libpreludedb/issues/report">Summary</a></li>

<li><a href="/projects/libpreludedb/issues/calendar">Calendar</a></li>
<li><a href="/projects/libpreludedb/issues/gantt">Gantt</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #143</h2>

<div class="issue tracker-1 status-5 priority-4 priority-default closed details">

  

<div class="subject">
<div><h3>prelude-manager overstepping varchar(255) field</h3></div>
</div>
        <p class="author">
        Added by  <a title="04/12/2006 03:51 PM" href="/projects/libpreludedb/activity?from=2006-04-12">over 18 years</a> ago.
        Updated <a title="04/29/2009 12:23 PM" href="/projects/libpreludedb/activity?from=2009-04-29">over 15 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/6">Yoann VANDOORSELAERE</a></div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="06/06/2006" href="/versions/29">0.9.8</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value"></div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent">0%</p></div></div></div></div>
<div class="splitcontent"><div class="splitcontentleft"><div class="cf_1 attribute"><div class="label"><span>Resolution</span>:</div><div class="value">worksforme</div></div></div><div class="splitcontentleft"></div></div>

</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hi,</p>


	<p>I have been finding log messages like this since I installed prelude a month ago:</p>


<pre>
prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(255)
</pre>

	<p>I think the manager is trying to insert data that's the wrong size (and perhaps, since postgres is more strict than [[MySQL]], I'm actually getting an error).  I can't tell if this is really prelude-manager's fault, but since the manager is the last step before database insertion, I am assuming that it should make sure that the input is formatted correctly.</p>


	<p>Here's some information on my setup:</p>


	<p>prelude-manager-0.9.1<br />libpreludedb-0.9.2<br />libprelude-0.9.3<br />postgresql-8.1.3<br />snort-2.4.3<br />prelude-lml-0.9.1</p>


	<p>I have a few snort sensors attached to prelude as well as prelude-lml.  I started running prelude-manager with -D 9 to see if I can catch some more info next time this happens, but if anyone here has some ideas please let me know.</p>
  </div>
</div>
<div class="attachments">
<div class="contextual">
  
</div>
<p><a class="icon icon-attachment" href="/attachments/download/34/preludedb-data.diff">preludedb-data.diff</a>    <a class="icon-only icon-magnifier" title="View" href="/attachments/34/preludedb-data.diff">View</a>
   - Fix insertion issue
  <span class="size">(1.52 KB)</span>
    <span class="author">Yoann VANDOORSELAERE, 06/01/2006 01:16 PM</span>
  </p>
</div>






</div>


<div id="history">
<h3>History</h3>
  <div id="change-366" class="journal has-details">
    <div id="note-1">
    <h4><a href="#note-1" class="journal-link">#1</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="04/17/2006 10:23 AM" href="/projects/libpreludedb/activity?from=2006-04-17">over 18 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-367" class="journal has-notes">
    <div id="note-2">
    <h4><a href="#note-2" class="journal-link">#2</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="04/21/2006 12:42 PM" href="/projects/libpreludedb/activity?from=2006-04-21">over 18 years</a> ago
    </h4>

    <div id="journal-367-notes" class="wiki"><p>Could you please edit your manager configuration file, and in the database configuration section, add the following settings:</p>


<pre>
log = /tmp/manager-query.log
</pre>

	<p>Then arrange to reproduce the issue, and provide the last SQL query available from the log file before the problem happened.</p>


	<p>Thanks,</p></div>
    </div>
  </div>
  
  <div id="change-368" class="journal has-notes">
    <div id="note-3">
    <h4><a href="#note-3" class="journal-link">#3</a>
    
    Updated by  <a title="05/31/2006 10:52 PM" href="/projects/libpreludedb/activity?from=2006-05-31">over 18 years</a> ago
    </h4>

    <div id="journal-368-notes" class="wiki"><p>I had the chance to try this again on a new system. here's some information:</p>


	<p>This is a sample of the errors from the log file (note how they're not all the same):</p>


	<p>May 29 08:00:02 locsrc@globemaster prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(255) .<br />May 30 08:00:02 locsrc@globemaster prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(255) .<br />May 31 08:00:02 locsrc@globemaster prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(255) .<br />May 31 15:10:52 locsrc@globemaster prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(8) .<br />May 31 15:10:52 locsrc@globemaster prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(8) .<br />May 31 16:09:25 locsrc@globemaster prelude-manager: could not insert message into database: ERROR:  value too long for type character varying(8).<br />May 31 16:12:38 locsrc@globemaster prelude-manager: could not insert message into database: ERROR:  value too long for type character varying(8).<br />May 31 16:28:47 locsrc@globemaster prelude-manager: could not insert message into database: ERROR:  invalid input syntax for type bytea.<br />May 31 16:28:47 locsrc@globemaster prelude-manager: could not insert message into database: ERROR:  invalid input syntax for type bytea.</p>


	<p>It's hard to get you good output from manager-query.log since in the 2 or 3 minutes that I ran it, the log file grew to 115MB!  Since there were thousands of logs for bytea errors, the following output is likely related to those (sensitive stuff carefully changed to keep character lengths):</p>


	<p>0.000s BEGIN<br />0.000s INSERT INTO Prelude_Alert (messageid) <abbr title="&#039;79909015648438&#039;">VALUES</abbr><br />0.000s SELECT max(_ident) FROM Prelude_Alert;<br />0.000s INSERT INTO Prelude_CreateTime (_parent_type, _message_ident, time, gmtoff, usec) <abbr title="&#039;A&#039;, 22101, &#039;2006-05-31 20:22:17&#039;, -14400, 709782">VALUES</abbr><br />0.000s INSERT INTO Prelude_DetectTime (_message_ident, time, gmtoff, usec) <abbr title="22101, &#039;2006-05-31 20:13:26&#039;, -14400, 0">VALUES</abbr><br />0.000s INSERT INTO Prelude_AnalyzerTime (_parent_type, _message_ident, time, gmtoff, usec) <abbr title="&#039;A&#039;, 22101, &#039;2006-05-31 20:22:17&#039;, -14400, 740981">VALUES</abbr><br />0.000s INSERT INTO Prelude_Assessment (_message_ident) <abbr title="22101">VALUES</abbr><br />0.000s INSERT INTO Prelude_Impact (_message_ident, severity, completion, type, description) <abbr title="22101, &#039;low&#039;, &#039;succeeded&#039;, &#039;user&#039;, &#039;ABCDEF logged off&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22101, 0, &#039;4004684483993713&#039;, &#039;prelude-manager&#039;, &#039;http://www.prelude-ids.com&#039;, &#039;Prelude Manager&#039;, &#039;0.9.3&#039;, &#039;Concentrator&#039;, &#039;Linux&#039;, &#039;2.6.14-hardened-r5&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22101, 0, NULL, &#039;prelude-manager&#039;, 31628, &#039;/usr/bin/prelude-manager&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22101, 1, &#039;3612974876905030&#039;, &#039;prelude-lml&#039;, &#039;http://www.prelude-ids.com&#039;, &#039;Prelude LML&#039;, &#039;0.9.2&#039;, &#039;Log Analyzer&#039;, &#039;Linux&#039;, &#039;2.6.14-hardened-r5&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22101, 1, NULL, &#039;prelude-lml&#039;, 14358, &#039;/usr/bin/prelude-lml&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22101, 2, NULL, &#039;NTsyslog&#039;, &#039;ntsyslog.sourceforge.net&#039;, NULL, NULL, &#039;Logging&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;A&#039;, 22101, 2, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22101, 2, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22101, -1, NULL, &#039;NTsyslog&#039;, &#039;ntsyslog.sourceforge.net&#039;, NULL, NULL, &#039;Logging&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;A&#039;, 22101, -1, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22101, -1, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Source (_message_ident, _index, ident, spoofed, interface) <abbr title="22101, 0, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_User (_parent_type, _message_ident, _parent0_index, ident, category) <abbr title="&#039;S&#039;, 22101, 0, NULL, &#039;os-device&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, 0, 0, 0, 0, NULL, &#039;current-user&#039;, &#039;DOMAINE\\ABCDEF$ &#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, 0, 0, 0, 1, NULL, &#039;current-user&#039;, &#039;ABCDEF&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, 0, 0, 0, -1, NULL, &#039;current-user&#039;, &#039;ABCDEF&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Source (_message_ident, _index, ident, spoofed, interface) <abbr title="22101, -1, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_User (_parent_type, _message_ident, _parent0_index, ident, category) <abbr title="&#039;S&#039;, 22101, -1, NULL, &#039;os-device&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, -1, 0, 0, 0, NULL, &#039;current-user&#039;, &#039;DOMAINE\\ABCDEF$ &#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, -1, 0, 0, 1, NULL, &#039;current-user&#039;, &#039;ABCDEF&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22101, -1, 0, 0, -1, NULL, &#039;current-user&#039;, &#039;ABCDEF&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Target (_message_ident, _index, ident, decoy, interface) <abbr title="22101, 0, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;T&#039;, 22101, 0, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;T&#039;, 22101, 0, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Target (_message_ident, _index, ident, decoy, interface) <abbr title="22101, -1, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;T&#039;, 22101, -1, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;T&#039;, 22101, -1, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Classification (_message_ident, ident, text) <abbr title="22101, NULL, &#039;Logoff&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_AdditionalData (_parent_type, _message_ident, _index, type, meaning, data) <abbr title="&#039;A&#039;, 22101, 0, &#039;string&#039;, &#039;Log received from&#039;, &#039;/var/log/lan.snare&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_AdditionalData (_parent_type, _message_ident, _index, type, meaning, data) <abbr title="&#039;A&#039;, 22101, 1, &#039;string&#039;, &#039;Original Log&#039;, &#039;May 31 16:13:26 abcdef/abcdef security[success] 538 DOMAINE\\ABCDEF$  User Logoff:  User Name:ABCDEF$  Domain:DOMAINE  Logon ID:(0x0,0xF9022B">VALUES</abbr>  Logon Type:3  ')<br />0.000s ROLLBACK<br />0.000s BEGIN<br />0.000s INSERT INTO Prelude_Alert (messageid) <abbr title="&#039;79913310615734&#039;">VALUES</abbr><br />0.000s SELECT max(_ident) FROM Prelude_Alert;<br />0.000s INSERT INTO Prelude_CreateTime (_parent_type, _message_ident, time, gmtoff, usec) <abbr title="&#039;A&#039;, 22102, &#039;2006-05-31 20:22:17&#039;, -14400, 711345">VALUES</abbr><br />0.000s INSERT INTO Prelude_DetectTime (_message_ident, time, gmtoff, usec) <abbr title="22102, &#039;2006-05-31 20:13:27&#039;, -14400, 0">VALUES</abbr><br />0.000s INSERT INTO Prelude_AnalyzerTime (_parent_type, _message_ident, time, gmtoff, usec) <abbr title="&#039;A&#039;, 22102, &#039;2006-05-31 20:22:17&#039;, -14400, 741102">VALUES</abbr><br />0.000s INSERT INTO Prelude_Assessment (_message_ident) <abbr title="22102">VALUES</abbr><br />0.000s INSERT INTO Prelude_Impact (_message_ident, severity, completion, type, description) <abbr title="22102, &#039;low&#039;, &#039;succeeded&#039;, &#039;user&#039;, &#039;Administrator  Domain logged off&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22102, 0, &#039;4004684483993713&#039;, &#039;prelude-manager&#039;, &#039;http://www.prelude-ids.com&#039;, &#039;Prelude Manager&#039;, &#039;0.9.3&#039;, &#039;Concentrator&#039;, &#039;Linux&#039;, &#039;2.6.14-hardened-r5&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22102, 0, NULL, &#039;prelude-manager&#039;, 31628, &#039;/usr/bin/prelude-manager&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22102, 1, &#039;3612974876905030&#039;, &#039;prelude-lml&#039;, &#039;http://www.prelude-ids.com&#039;, &#039;Prelude LML&#039;, &#039;0.9.2&#039;, &#039;Log Analyzer&#039;, &#039;Linux&#039;, &#039;2.6.14-hardened-r5&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22102, 1, NULL, &#039;prelude-lml&#039;, 14358, &#039;/usr/bin/prelude-lml&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22102, 2, NULL, &#039;NTsyslog&#039;, &#039;ntsyslog.sourceforge.net&#039;, NULL, NULL, &#039;Logging&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;A&#039;, 22102, 2, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22102, 2, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Analyzer (_parent_type, _message_ident, _index, analyzerid, name, manufacturer, model, version, class, ostype, osversion) <abbr title="&#039;A&#039;, 22102, -1, NULL, &#039;NTsyslog&#039;, &#039;ntsyslog.sourceforge.net&#039;, NULL, NULL, &#039;Logging&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;A&#039;, 22102, -1, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;A&#039;, 22102, -1, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Source (_message_ident, _index, ident, spoofed, interface) <abbr title="22102, 0, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_User (_parent_type, _message_ident, _parent0_index, ident, category) <abbr title="&#039;S&#039;, 22102, 0, NULL, &#039;os-device&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, 0, 0, 0, 0, NULL, &#039;current-user&#039;, &#039;DOMAINE\\Administrator &#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, 0, 0, 0, 1, NULL, &#039;current-user&#039;, &#039;Administrator  Domain&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, 0, 0, 0, -1, NULL, &#039;current-user&#039;, &#039;Administrator  Domain&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Source (_message_ident, _index, ident, spoofed, interface) <abbr title="22102, -1, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_User (_parent_type, _message_ident, _parent0_index, ident, category) <abbr title="&#039;S&#039;, 22102, -1, NULL, &#039;os-device&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, -1, 0, 0, 0, NULL, &#039;current-user&#039;, &#039;DOMAINE\\Administrator &#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, -1, 0, 0, 1, NULL, &#039;current-user&#039;, &#039;Administrator  Domain&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_UserId (_parent_type, _message_ident, _parent0_index, _parent1_index, _parent2_index, _index, ident, type, name, number, tty) <abbr title="&#039;S&#039;, 22102, -1, 0, 0, -1, NULL, &#039;current-user&#039;, &#039;Administrator  Domain&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Target (_message_ident, _index, ident, decoy, interface) <abbr title="22102, 0, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;T&#039;, 22102, 0, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;T&#039;, 22102, 0, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Target (_message_ident, _index, ident, decoy, interface) <abbr title="22102, -1, NULL, &#039;unknown&#039;, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Node (_parent_type, _message_ident, _parent0_index, ident, category, location, name) <abbr title="&#039;T&#039;, 22102, -1, NULL, &#039;unknown&#039;, NULL, &#039;abcdef/abcdef&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_Process (_parent_type, _message_ident, _parent0_index, ident, name, pid, path) <abbr title="&#039;T&#039;, 22102, -1, NULL, &#039;security[success]&#039;, NULL, NULL">VALUES</abbr><br />0.000s INSERT INTO Prelude_Classification (_message_ident, ident, text) <abbr title="22102, NULL, &#039;Logoff&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_AdditionalData (_parent_type, _message_ident, _index, type, meaning, data) <abbr title="&#039;A&#039;, 22102, 0, &#039;string&#039;, &#039;Log received from&#039;, &#039;/var/log/lan.snare&#039;">VALUES</abbr><br />0.000s INSERT INTO Prelude_AdditionalData (_parent_type, _message_ident, _index, type, meaning, data) <abbr title="&#039;A&#039;, 22102, 1, &#039;string&#039;, &#039;Original Log&#039;, &#039;May 31 16:13:27 abcdef/abcdef security[success] 538 DOMAINE\\Administrator  User Logoff:  User Name:Administrator  Domain:DOMAINE  Logon ID:(0x0,0xF90497">VALUES</abbr>  Logon Type:3  ')<br />0.000s ROLLBACK</p>


	<p>I can't tell what logs are causing these right now... perhaps it was this:</p>


	<p>May 31 16:28:42 abcdef/abcdef security[success] 538 DOMAINE\Administrator  User Logoff:  User Name:Administrator  Domain:DOMAINE  Logon ID:(0x0,0xFEEF9D)  Logon Type:3</p>


	<p>Let me know if you need any more info.</p></div>
    </div>
  </div>
  
  <div id="change-369" class="journal has-notes">
    <div id="note-4">
    <h4><a href="#note-4" class="journal-link">#4</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="06/01/2006 01:18 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-369-notes" class="wiki"><p>Eric, could you please try the attached patch and report whether it fix your problem ?</p></div>
    </div>
  </div>
  
  <div id="change-370" class="journal has-notes">
    <div id="note-5">
    <h4><a href="#note-5" class="journal-link">#5</a>
    
    Updated by  <a title="06/01/2006 04:05 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-370-notes" class="wiki"><p>The patch failed, I forgot to mention that am using the following versions:</p>


	<p>libpreludedb:    0.9.5.1<br />libprelude:      0.9.5<br />prelude-manager: 0.9.3<br />prelude-lml:     0.9.2</p></div>
    </div>
  </div>
  
  <div id="change-371" class="journal has-notes">
    <div id="note-6">
    <h4><a href="#note-6" class="journal-link">#6</a>
    
    Updated by  <a title="06/01/2006 04:23 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-371-notes" class="wiki"><p>I was able to apply the patch successfully (I was doing it wrong before), and I think it fixes the problems.  I ran lml for a few seconds, it captured thousands of alerts, and I didn't see any more bytea/varchar errors in the logs (no more rollbacks in the manager log either).</p>


	<p>Thanks!</p></div>
    </div>
  </div>
  
  <div id="change-372" class="journal has-notes has-details">
    <div id="note-7">
    <h4><a href="#note-7" class="journal-link">#7</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="06/01/2006 04:27 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Closed</i></li>
       <li><strong>Resolution</strong> set to <i>fixed</i></li>
    </ul>
    <div id="journal-372-notes" class="wiki"><p>(In r8224) Always use prelude_escape_binary() when we're inserting additional data. This is<br />important even in case we're inserting a string, since the database field might be<br />of a type that require binary kind of escaping. Fix <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: prelude-manager overstepping varchar(255) field (Closed)" href="/issues/143">#143</a>.</p></div>
    </div>
  </div>
  
  <div id="change-373" class="journal has-notes">
    <div id="note-8">
    <h4><a href="#note-8" class="journal-link">#8</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="06/01/2006 04:29 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-373-notes" class="wiki"><p>By the way, the comments doesn't fit the summary of this bug.<br />You were originally reporting the following error:</p>


<pre>
prelude-manager: could not insert message into database: Query error: ERROR:  value too long for type character varying(255)
</pre>

	<p>Are you able to reproduce this ?</p></div>
    </div>
  </div>
  
  <div id="change-374" class="journal has-notes">
    <div id="note-9">
    <h4><a href="#note-9" class="journal-link">#9</a>
    
    Updated by  <a title="06/01/2006 05:19 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-374-notes" class="wiki"><p>I have been looking through the alerts from lml in prewikka, and I noticed that in sections like Additional Data, stuff looks like this:</p>


	<p>Log received from      /var/log/abc.snare\000<br />Original Log     Jun 1 09:15:46 abc/abc security[success] 680 NT AUTHORITY\\SYSTEM Account Used for Logon by: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0 Account Name: abcdefg Workstation: AB-CD \000</p>


	<p>Are the trailing \000's a result of this patch?</p></div>
    </div>
  </div>
  
  <div id="change-375" class="journal has-notes">
    <div id="note-10">
    <h4><a href="#note-10" class="journal-link">#10</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="06/01/2006 05:24 PM" href="/projects/libpreludedb/activity?from=2006-06-01">over 18 years</a> ago
    </h4>

    <div id="journal-375-notes" class="wiki"><p>Yes, this is fixed in r8225</p></div>
    </div>
  </div>
  
  <div id="change-376" class="journal has-notes has-details">
    <div id="note-11">
    <h4><a href="#note-11" class="journal-link">#11</a>
    
    Updated by  <a title="06/12/2006 04:52 PM" href="/projects/libpreludedb/activity?from=2006-06-12">over 18 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Closed</i> to <i>Feedback</i></li>
       <li><strong>Resolution</strong> deleted (<del><i>fixed</i></del>)</li>
    </ul>
    <div id="journal-376-notes" class="wiki"><p>I just got more messages like this in my logs using the most recent versions:</p>


	<p>Jun 12 10:54:55 globemaster prelude-manager: could not insert message into database: ERROR:  value too long for type character varying(255).</p>


	<p>Will try to hunt down the source...</p></div>
    </div>
  </div>
  
  <div id="change-377" class="journal has-notes">
    <div id="note-12">
    <h4><a href="#note-12" class="journal-link">#12</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="06/12/2006 04:54 PM" href="/projects/libpreludedb/activity?from=2006-06-12">over 18 years</a> ago
    </h4>

    <div id="journal-377-notes" class="wiki"><p>Please watch at the SQL query log and report the statement preceding the ROLLBACK. <br />Regards,</p></div>
    </div>
  </div>
  
  <div id="change-378" class="journal has-notes has-details">
    <div id="note-13">
    <h4><a href="#note-13" class="journal-link">#13</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="05/02/2007 02:48 PM" href="/projects/libpreludedb/activity?from=2007-05-02">over 17 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Feedback</i> to <i>Closed</i></li>
       <li><strong>Resolution</strong> set to <i>worksforme</i></li>
    </ul>
    <div id="journal-378-notes" class="wiki"><p>Closing this issue due to lack of feedback. Please re-open if appropriate.</p></div>
    </div>
  </div>
  
  <div id="change-1063" class="journal has-details">
    <div id="note-14">
    <h4><a href="#note-14" class="journal-link">#14</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="04/29/2009 12:23 PM" href="/projects/libpreludedb/activity?from=2009-04-29">over 15 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Project</strong> changed from <i>PRELUDE SIEM</i> to <i>LibpreludeDB</i></li>
       <li><strong>Category</strong> deleted (<del><i>2</i></del>)</li>
       <li><strong>Target version</strong> deleted (<del><i>0.9.8</i></del>)</li>
    </ul>
    
    </div>
  </div>
  


</div>


<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>

<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/143.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/143.pdf">PDF</a></span>
</p>



<script>
//<![CDATA[
contextMenuInit('/issues/context_menu')
//]]>
</script>

        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
<!-- Piwik -->
<noscript><p><img src="//www.prelude-siem.org/piwik/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
<script type="text/javascript">
  var piwik_site_id = '3';

  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "*.dev.prelude-ids.com"]);
  _paq.push(["setDomains", ["*.dev.prelude-ids.com","*.prelude-ids.org","*.prelude-siem.org","*.www.prelude-ids.org","*.www.prelude-siem.org", "*.vigilo-nms.org", "*.www.vigilo-nms.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//www.prelude-siem.org/piwik/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', piwik_site_id]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2017 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111535491-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111535491-5');
</script>
 
</body>
</html>
