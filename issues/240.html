<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Feature #240: [PATCH] - SSL Client Certificate Authentification module - Prewikka - UNITY 360</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="gWuwEjn3ZNtk7XFlzGT6vvJTxboA9wYMkgU+XKMj12+SRNh98ONpWO5HeZ/RLLPgjhi0JBr9X0JMi/rMJyPjbA==" />
<link rel='shortcut icon' href='/themes/prelude/favicon/Prelude-icon.png' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css" />
<link rel="stylesheet" media="all" href="/themes/prelude/stylesheets/application.css" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-3.1.4.js"></script>
<script src="/javascripts/application.js"></script>
<script src="/javascripts/responsive.js"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>



<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Prewikka - Feature #240: [PATCH] - SSL Client Certificate Authentification module" href="http://www.prelude-siem.org/issues/240.atom" />
<script src="/javascripts/context_menu.js"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css" /></head>
<body class="theme-Prelude project-prewikka controller-issues action-show">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/prewikka/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li><li><a class="register" href="/account/register">Register</a></li></ul>    </div>
    
    <ul><li><a class="PreludeOSS" href="/projects/prelude">Prelude OSS</a></li><li><a target="_blank" class="SIEMVersion" href="http://www.prelude-siem.com">Prelude SIEM</a></li><li><a class="VigiloOSS" href="/projects/vigilo-nms">Vigilo OSS</a></li><li><a target="_blank" class="NMSVersion" href="http://www.vigilo-nms.com">Vigilo NMS</a></li><li><a class="|" href="#">|</a></li><li><a class="Projects" href="/projects">Projects</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/prewikka/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/prewikka/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        
    </div>

    <h1>
        <img src="/themes/prelude/img/prelude-logo.png" style="height: 55px"/>
        <a href="https://www.ow2.org/bin/view/Press_Releases/OW2_Open_Source_Community_announces_OW2con_16_Best_Project_Awards" target="_blank"><img src="/themes/prelude/img/ow2-logo.png" style="margin-top: -10px; height: 55px"/></a>
    </h1>

    
    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/prewikka">Overview</a></li><li><a class="activity" href="/projects/prewikka/activity">Activity</a></li><li><a class="roadmap" href="/projects/prewikka/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/prewikka/issues">Issues</a></li><li><a class="gantt" href="/projects/prewikka/issues/gantt">Gantt</a></li><li><a class="calendar" href="/projects/prewikka/issues/calendar">Calendar</a></li><li><a class="repository" href="/projects/prewikka/repository">Repository</a></li><li><a target="_blank" class="IDMEFProbe" href="https://www.prelude-siem.com/en/technological-partners/">IDMEF Probes</a></li><li><a target="_blank" class="PrewikkaApps" href="https://github.com/Prelude-SIEM-Contrib">SIEM Apps</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/prewikka/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/prewikka/issues/report">Summary</a></li>

<li><a href="/projects/prewikka/issues/calendar">Calendar</a></li>
<li><a href="/projects/prewikka/issues/gantt">Gantt</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Feature #240</h2>

<div class="issue tracker-2 status-1 priority-4 priority-default details">
    <div class="next-prev-links contextual">
      <a title="#238" accesskey="p" href="/issues/238">« Previous</a> |
        <span class="position">3 of 6</span> |
      <a title="#315" accesskey="n" href="/issues/315">Next »</a>
    </div>

  

<div class="subject">
<div><h3>[PATCH] - SSL Client Certificate Authentification module</h3></div>
</div>
        <p class="author">
        Added by  <a title="06/18/2007 04:58 PM" href="/projects/prewikka/activity?from=2007-06-18">over 17 years</a> ago.
        Updated <a title="09/28/2016 11:07 PM" href="/projects/prewikka/activity?from=2016-09-28">about 8 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">New</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value">-</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value">-</div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value"></div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent">0%</p></div></div></div></div>
<div class="splitcontent"><div class="splitcontentleft"><div class="cf_1 attribute"><div class="label"><span>Resolution</span>:</div><div class="value"></div></div></div><div class="splitcontentleft"></div></div>

</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hi</p>


	<p>Here is a patch to use a SSL Client certificate to authenticate user. The username should be equal to the user certificate CN (the full DN is too long to be used, login field is limited to 32 char)</p>


Limitations:
	<ul>
	<li>Currently only tested in a SSL mod_python setup</li>
		<li>Need SSLOptions +StdEnvVars</li>
		<li>Used with python 2.3</li>
	</ul>


	<p>In prewikka.conf</p>


<pre>
[auth ssl]
</pre>

	<p>And this file in a new directory <em>prewikka/modules/auth/ssl/</em><br /><pre>
# Copyright (C) 2006 [[PreludeIDS]] Technologies. All Rights Reserved.
# Author: Francois Harvey &lt;fharvey+prelude at securiweb dot net&gt;
#
# This file is part of the Prewikka program.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; see the file COPYING.  If not, write to
# the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.

import os

from prewikka import Auth, User, Database

# Use the SSL_CLIENT_S_DN_CN from a SSL x509 Certificate to map the user
class SSLAuth(Auth.Auth):
    def getUser(self, request):
        if not request._req.subprocess_env['HTTPS']:
                raise Auth.AuthError(message=_("SSL Authentication failed: Not in a SSL session."))
        user = request._req.subprocess_env['SSL_CLIENT_S_DN_CN']
        if not user:
            raise Auth.AuthError(message=_("SSL Authentication failed: no user specified (hint: look at the certificate CN)."))

        return User.User(self.db, user, self.db.getLanguage(user), User.ALL_PERMISSIONS, self.db.getConfiguration(user))

def load(env, config):
    return SSLAuth(env)

</pre></p>
  </div>
</div>
<div class="attachments">
<div class="contextual">
  
</div>
<p><a class="icon icon-attachment" href="/attachments/download/96/ssl.py">ssl.py</a>    <a class="icon-only icon-magnifier" title="View" href="/attachments/96/ssl.py">View</a>
   - SSL Patch
  <span class="size">(1.59 KB)</span>
    <span class="author">admin admin, 06/18/2007 04:58 PM</span>
  </p>
</div>






</div>


<div id="history">
<h3>History</h3>
  <div id="change-630" class="journal has-notes">
    <div id="note-1">
    <h4><a href="#note-1" class="journal-link">#1</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="07/12/2007 03:33 PM" href="/projects/prewikka/activity?from=2007-07-12">over 17 years</a> ago
    </h4>

    <div id="journal-630-notes" class="wiki"><p>Thanks for this contribution! The patch look good, the only drawback is that it require the use of the mod_python backend. Could you add the necessary interface to Request.py (and then to the mod_python and CGI implementation), so that the module will work independently from the backend?</p>


	<p>Thanks again!</p></div>
    </div>
  </div>
  
  <div id="change-1045" class="journal has-details">
    <div id="note-2">
    <h4><a href="#note-2" class="journal-link">#2</a>
    
    Updated by <a class="user active" href="/users/6">Yoann VANDOORSELAERE</a> <a title="04/29/2009 12:21 PM" href="/projects/prewikka/activity?from=2009-04-29">over 15 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Project</strong> changed from <i>PRELUDE SIEM</i> to <i>Prewikka</i></li>
       <li><strong>Category</strong> deleted (<del><i>5</i></del>)</li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-1708" class="journal has-details">
    <div id="note-3">
    <h4><a href="#note-3" class="journal-link">#3</a>
    
    Updated by <a class="user active" href="/users/307">Jean-Charles ROGEZ</a> <a title="09/23/2013 11:00 AM" href="/projects/prewikka/activity?from=2013-09-23">about 11 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Assignee</strong> deleted (<del><i>Yoann VANDOORSELAERE</i></del>)</li>
       <li><strong>Target version</strong> set to <i>122</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-1709" class="journal has-details">
    <div id="note-4">
    <h4><a href="#note-4" class="journal-link">#4</a>
    
    Updated by <a class="user active" href="/users/307">Jean-Charles ROGEZ</a> <a title="09/23/2013 11:01 AM" href="/projects/prewikka/activity?from=2013-09-23">about 11 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Jean-Charles ROGEZ</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2442" class="journal has-details">
    <div id="note-5">
    <h4><a href="#note-5" class="journal-link">#5</a>
    
    Updated by <a class="user active" href="/users/301">Thomas </a> <a title="11/08/2015 12:09 PM" href="/projects/prewikka/activity?from=2015-11-08">almost 9 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> changed from <i>122</i> to <i>Prelude OSS 3.0.0</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3035" class="journal has-details">
    <div id="note-6">
    <h4><a href="#note-6" class="journal-link">#6</a>
    
    Updated by <a class="user active" href="/users/301">Thomas </a> <a title="04/23/2016 07:49 PM" href="/projects/prewikka/activity?from=2016-04-23">over 8 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> changed from <i>Prelude OSS 3.0.0</i> to <i>Prelude OSS 3.1.0</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3911" class="journal has-notes has-details">
    <div id="note-7">
    <h4><a href="#note-7" class="journal-link">#7</a>
    
    Updated by <a class="user active" href="/users/301">Thomas </a> <a title="09/28/2016 11:07 PM" href="/projects/prewikka/activity?from=2016-09-28">about 8 years</a> ago
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>New</i></li>
       <li><strong>Assignee</strong> deleted (<del><i>Jean-Charles ROGEZ</i></del>)</li>
       <li><strong>Target version</strong> deleted (<del><i>Prelude OSS 3.1.0</i></del>)</li>
    </ul>
    <div id="journal-3911-notes" class="wiki"><p>Patch has to be updated</p></div>
    </div>
  </div>
  


</div>


<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>

<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/240.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/240.pdf">PDF</a></span>
</p>



<script>
//<![CDATA[
contextMenuInit('/issues/context_menu')
//]]>
</script>

        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
<!-- Piwik -->
<noscript><p><img src="//www.prelude-siem.org/piwik/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
<script type="text/javascript">
  var piwik_site_id = '3';

  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "*.dev.prelude-ids.com"]);
  _paq.push(["setDomains", ["*.dev.prelude-ids.com","*.prelude-ids.org","*.prelude-siem.org","*.www.prelude-ids.org","*.www.prelude-siem.org", "*.vigilo-nms.org", "*.www.vigilo-nms.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//www.prelude-siem.org/piwik/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', piwik_site_id]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2017 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111535491-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111535491-5');
</script>
 
</body>
</html>
