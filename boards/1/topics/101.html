<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Install issue - Hangs trying to register Correlator (Manager Side) - PRELUDE SIEM - UNITY 360</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="OsixoHnM+phJLNuH3eaMgIz/4WxfySAQKKxRBCnlDXsp59nPsNj3G8OG033ArsXe8LSQ8kXDeV72IpWUreU5eA==" />
<link rel='shortcut icon' href='/themes/prelude/favicon/Prelude-icon.png' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css" />
<link rel="stylesheet" media="all" href="/themes/prelude/stylesheets/application.css" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-3.1.4.js"></script>
<script src="/javascripts/application.js"></script>
<script src="/javascripts/responsive.js"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>





  <script src="/plugin_assets/redmine_wiki_extensions/javascripts/jquery.tablesorter.js"></script>
  <link rel="stylesheet" media="screen" href="/plugin_assets/redmine_wiki_extensions/stylesheets/wiki_extensions.css" />
  <link rel="stylesheet" media="print" href="/plugin_assets/redmine_wiki_extensions/stylesheets/wiki_extensions_print.css" />
  <script src="/plugin_assets/redmine_wiki_extensions/javascripts/wiki_extensions.js"></script>

<!-- page specific tags -->
</head>
<body class="theme-Prelude project-prelude controller-messages action-show">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/prelude/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li><li><a class="register" href="/account/register">Register</a></li></ul>    </div>
    
    <ul><li><a class="PreludeOSS" href="/projects/prelude">Prelude OSS</a></li><li><a target="_blank" class="SIEMVersion" href="http://www.prelude-siem.com">Prelude SIEM</a></li><li><a class="VigiloOSS" href="/projects/vigilo-nms">Vigilo OSS</a></li><li><a target="_blank" class="NMSVersion" href="http://www.vigilo-nms.com">Vigilo NMS</a></li><li><a class="|" href="#">|</a></li><li><a class="Projects" href="/projects">Projects</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/prelude/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/prelude/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        
    </div>

    <h1>
        <img src="/themes/prelude/img/prelude-logo.png" style="height: 55px"/>
        <a href="https://www.ow2.org/bin/view/Press_Releases/OW2_Open_Source_Community_announces_OW2con_16_Best_Project_Awards" target="_blank"><img src="/themes/prelude/img/ow2-logo.png" style="margin-top: -10px; height: 55px"/></a>
    </h1>

    
    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/prelude">Overview</a></li><li><a class="activity" href="/projects/prelude/activity">Activity</a></li><li><a class="roadmap" href="/projects/prelude/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/prelude/issues">Issues</a></li><li><a class="MyWiki" href="/projects/prelude/wiki">Documentation</a></li><li><a class="boards selected" href="/projects/prelude/boards">Forums</a></li><li><a class="MyFiles" href="/projects/prelude/files">Downloads</a></li><li><a target="_blank" class="screenshot" href="https://www.prelude-siem.com/prelude-siem/#alerter">Screenshot</a></li><li><a target="_blank" class="IDMEFProbe" href="https://www.prelude-siem.com/en/technological-partners/">IDMEF Probes</a></li><li><a target="_blank" class="PrewikkaApps" href="https://github.com/Prelude-SIEM-Contrib">SIEM Apps</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/prelude/boards">Forums</a> » <a href="/projects/prelude/boards/1">User</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Install issue - Hangs trying to register Correlator (Manager Side)</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/589">Tony Su</a> <a title="12/18/2016 09:38 AM" href="/projects/prelude/activity?from=2016-12-18">almost 8 years</a> ago</span></p>
<div class="wiki">
<p>Following SUSE/openSUSE instructions on an openSUSE 42.2<br /><a class="external" href="https://www.prelude-siem.org/projects/prelude/wiki/InstallingPackageOpenSuSE#InstallingPackageOpenSuSE">https://www.prelude-siem.org/projects/prelude/wiki/InstallingPackageOpenSuSE#InstallingPackageOpenSuSE</a></p>


	<p>Working my way down the page, all has been successful until...</p>


	<p>Registering Correlator (prelude manager side) hangs with the following stdout</p>


	<ol>
	<li>prelude-admin registration-server prelude-manager<br />The "k6l4mpt6" password will be requested by "prelude-admin register" <br />in order to connect. Please remove the quotes before using it.</li>
	</ol>


	<p>Generating 1024 bits Diffie-Hellman key for anonymous authentication...<br />Waiting for peers install request on 0.0.0.0:5553...<br />Waiting for peers install request on :::5553...</p>
</div>

</div>
<br />

<h3 class="comments">Replies (7)</h3>
  <div class="message reply" id="message-105">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=105#message-105">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/301">Thomas </a> <a title="12/18/2016 11:07 PM" href="/projects/prelude/activity?from=2016-12-18">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>Hello</p>


	<p>Yes, it is normal. You have to do the next step on an other termial to do the registration.<br />You have to read this : <a class="wiki-page" href="/projects/prelude/wiki/InstallingAgentRegistration">InstallingAgentRegistration</a></p>


	<p>Regards</p></div>
  
  </div>
  <div class="message reply" id="message-108">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=108#message-108">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/589">Tony Su</a> <a title="12/19/2016 08:09 PM" href="/projects/prelude/activity?from=2016-12-19">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>I think I finally figured out what is needed but still results in an error...</p>


	<p>This is an attempt to register the LML Prelude Agent to the Prelude Manager running on the same machine<br />The firewall has been dropped, so it's not blocking.<br />OpenSSL is installed, here are the installed packages<br /><pre>
# zypper se -i openssl
Loading repository data...
Reading installed packages...

S | Name                  | Summary                                    | Type   
--+-----------------------+--------------------------------------------+--------
i | libopenssl1_0_0       | Secure Sockets and Transport Layer Secur-&gt; | package
i | libopenssl1_0_0-32bit | Secure Sockets and Transport Layer Secur-&gt; | package
i | openssl               | Secure Sockets and Transport Layer Secur-&gt; | package
i | python-pyOpenSSL      | Python wrapper module around the OpenSSL-&gt; | package
</pre></p>


	<p>First, the following in one console, which is left hanging...<br /><pre>
 prelude-admin registration-server prelude-manager
The "r1a6m48u" password will be requested by "prelude-admin register" 
in order to connect. Please remove the quotes before using it.

Generating 1024 bits Diffie-Hellman key for anonymous authentication...
Waiting for peers install request on 0.0.0.0:5553...
Waiting for peers install request on :::5553...
</pre></p>


	<p>Then, I opened up a new console and attempted to register the Prelude LML agent using the example in the documentation(and using the one shot password in displayed by the still hanging prelude manager in the first console) but results in the following error. There is a verified /etc/hosts entry that resolves localhost to 127.0.0.1.<br /><pre>
# prelude-admin register prelude-lml "idmef:w admin:r" localhost

You now need to start "prelude-admin" registration-server on localhost:
example: "prelude-admin registration-server prelude-manager" 

Enter the one-shot password provided on localhost: 
Confirm the one-shot password provided on localhost: 

Connecting to registration server (localhost:5553)... 
GnuTLS handshake failed: Bad record MAC.
</pre></p>


	<p>The first console now displays as follows<br /><pre>
# prelude-admin registration-server prelude-manager
The "r1a6m48u" password will be requested by "prelude-admin register" 
in order to connect. Please remove the quotes before using it.

Generating 1024 bits Diffie-Hellman key for anonymous authentication...
Waiting for peers install request on 0.0.0.0:5553...
Waiting for peers install request on :::5553...

Connection from ::1:56416...
GnuTLS handshake failed: Decryption has failed..
</pre></p>


	<p>On the chance that somehow prelude-manager is bound to the external network interface, I tried to register the Agent using that IP address, but that results in the same error.</p></div>
  
  </div>
  <div class="message reply" id="message-109">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=109#message-109">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/301">Thomas </a> <a title="12/20/2016 01:34 AM" href="/projects/prelude/activity?from=2016-12-20">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>Do you use the packaged version or you compiled yourself your version ?</p></div>
  
  </div>
  <div class="message reply" id="message-111">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=111#message-111">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/589">Tony Su</a> <a title="12/21/2016 12:41 AM" href="/projects/prelude/activity?from=2016-12-21">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>For clarification,<br />Everything in this Forums thread can be reproduced by reading from the first post,</p>


	<p>So, this is in a brand new, openSUSE 42.2.<br />I then installed the LAMP pattern and wsgi packages as described in this other Forum post (no packages required for building from source)<br /><a class="external" href="https://www.prelude-siem.org/boards/1/topics/97?r=106#message-106">https://www.prelude-siem.org/boards/1/topics/97?r=106#message-106</a></p>


	<p>Then, brand new installed Prelude packages as described in the first post (link posted again here)<br /><a class="external" href="https://www.prelude-siem.org/projects/prelude/wiki/InstallingPackageOpenSuSE#InstallingPackageOpenSuSE">https://www.prelude-siem.org/projects/prelude/wiki/InstallingPackageOpenSuSE#InstallingPackageOpenSuSE</a></p>


	<p>Following the directions in the above link is where I reached the point where I didn't understand why I was seeing a hanging console and posted for the first time in this thread. After your response, I did exactly what you see in my above post which throws the encryption/decryption error.</p>


	<p>If you set up your development/testbed machine differently,<br />I am willing to try setting up a machine that way.</p></div>
  
  </div>
  <div class="message reply" id="message-112">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=112#message-112">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/301">Thomas </a> <a title="12/21/2016 01:10 AM" href="/projects/prelude/activity?from=2016-12-21">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>Which version of gnutls do you have ?<br />Do you have some special hardening on your OpenSuse?<br />Do you have selinux enable ? If yes, try to put it in permissive<br />Maybe try to reset your profile registration (rm -rf /etc/prelude)</p>


	<p>Regards</p></div>
  
  </div>
  <div class="message reply" id="message-113">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=113#message-113">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/589">Tony Su</a> <a title="12/21/2016 09:42 AM" href="/projects/prelude/activity?from=2016-12-21">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>That was the issue, gnutls was not installed.</p>


	<p>After installation, registration succeeded.<br />Something new to add to the dependency list...</p>


	<p>Thx!</p></div>
  
  </div>
  <div class="message reply" id="message-114">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/1/topics/101?r=114#message-114">RE: Install issue - Hangs trying to register Correlator (Manager Side)</a>
    -
    Added by <a class="user active" href="/users/589">Tony Su</a> <a title="12/21/2016 07:57 PM" href="/projects/prelude/activity?from=2016-12-21">almost 8 years</a> ago
  </h4>
  <div class="wiki"><p>Next problem on this same box...</p>


	<p>After the above which successfully registers the Prelude Agent with LML sensors with the Prelude Manager,</p>


	<p>Unfortunately when starting up the Prelude Correlator service, it throws the following error.<br />Googling the error returns only an issue which was silently resolved 4 years ago(was fixed by patch, not by User configuration)</p>


	<p><a class="external" href="https://www.prelude-siem.org/issues/404">https://www.prelude-siem.org/issues/404</a></p>


<pre>
systemctl status prelude-correlator
â— prelude-correlator.service - Prelude-Correlator service
   Loaded: loaded (/usr/lib/systemd/system/prelude-correlator.service; disabled; vendor preset: disabled)
   Active: activating (start) since Wed 2016-12-21 10:49:11 PST; 726ms ago
 Main PID: 27297 (code=exited, status=1/FAILURE);         : 27300 (prelude-correla)
    Tasks: 1 (limit: 512)
   CGroup: /system.slice/prelude-correlator.service
           â””â”€27300 /usr/bin/python /usr/bin/prelude-correlator -d -P /run/prelude-correlator/prelude-correlator.pid

Dec 21 10:49:11 PRELUDE systemd[1]: prelude-correlator.service: Service hold-off time over, scheduling restart.
Dec 21 10:49:11 PRELUDE systemd[1]: Stopped Prelude-Correlator service.
Dec 21 10:49:11 PRELUDE systemd[1]: Starting Prelude-Correlator service...
Dec 21 10:49:12 PRELUDE prelude-correlator[27300]: 21 Dec 10:49:12 preludecorrelator.pluginmanager (pid:27300) INFO: [BusinessHourPlugin]: disabled on user request
Dec 21 10:49:12 PRELUDE preludecorrelator.pluginmanager[27300]: INFO: [BusinessHourPlugin]: disabled on user request
Dec 21 10:49:12 PRELUDE prelude-correlator[27300]: 21 Dec 10:49:12 preludecorrelator.pluginmanager (pid:27300) INFO: [FirewallPlugin]: disabled on user request
Dec 21 10:49:12 PRELUDE preludecorrelator.pluginmanager[27300]: INFO: [FirewallPlugin]: disabled on user request
</pre></div>
  
  </div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-7/7)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
<!-- Piwik -->
<noscript><p><img src="//www.prelude-siem.org/piwik/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
<script type="text/javascript">
  var piwik_site_id = '3';

  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "*.dev.prelude-ids.com"]);
  _paq.push(["setDomains", ["*.dev.prelude-ids.com","*.prelude-ids.org","*.prelude-siem.org","*.www.prelude-ids.org","*.www.prelude-siem.org", "*.vigilo-nms.org", "*.www.vigilo-nms.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//www.prelude-siem.org/piwik/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', piwik_site_id]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2017 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111535491-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111535491-5');
</script>
 
</body>
</html>
