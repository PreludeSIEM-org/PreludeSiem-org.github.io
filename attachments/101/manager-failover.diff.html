<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>manager-failover.diff - Prelude Manager - UNITY 360</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ZTcYWEVwbYQJ6aDKFosCJtPF/Vl+o8BzxDx4UBb7Nhl2GHA3jGRgB4NDqDALw0t4r46Mx2SpmT0asrzAkvsCGg==" />
<link rel='shortcut icon' href='/themes/prelude/favicon/Prelude-icon.png' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css" />
<link rel="stylesheet" media="all" href="/themes/prelude/stylesheets/application.css" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-3.1.4.js"></script>
<script src="/javascripts/application.js"></script>
<script src="/javascripts/responsive.js"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>



<!-- page specific tags -->
    <link rel="stylesheet" media="screen" href="/stylesheets/scm.css" /></head>
<body class="theme-Prelude project-prelude-manager controller-attachments action-show">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/prelude-manager/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li><li><a class="register" href="/account/register">Register</a></li></ul>    </div>
    
    <ul><li><a class="PreludeOSS" href="/projects/prelude">Prelude OSS</a></li><li><a target="_blank" class="SIEMVersion" href="http://www.prelude-siem.com">Prelude SIEM</a></li><li><a class="VigiloOSS" href="/projects/vigilo-nms">Vigilo OSS</a></li><li><a target="_blank" class="NMSVersion" href="http://www.vigilo-nms.com">Vigilo NMS</a></li><li><a class="|" href="#">|</a></li><li><a class="Projects" href="/projects">Projects</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/prelude-manager/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        
        <label for='q'>
          <a accesskey="4" href="/projects/prelude-manager/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        
    </div>

    <h1>
        <img src="/themes/prelude/img/prelude-logo.png" style="height: 55px"/>
        <a href="https://www.ow2.org/bin/view/Press_Releases/OW2_Open_Source_Community_announces_OW2con_16_Best_Project_Awards" target="_blank"><img src="/themes/prelude/img/ow2-logo.png" style="margin-top: -10px; height: 55px"/></a>
    </h1>

    
    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/prelude-manager">Overview</a></li><li><a class="activity" href="/projects/prelude-manager/activity">Activity</a></li><li><a class="roadmap" href="/projects/prelude-manager/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/prelude-manager/issues">Issues</a></li><li><a class="gantt" href="/projects/prelude-manager/issues/gantt">Gantt</a></li><li><a class="calendar" href="/projects/prelude-manager/issues/calendar">Calendar</a></li><li><a class="repository" href="/projects/prelude-manager/repository">Repository</a></li><li><a target="_blank" class="IDMEFProbe" href="https://www.prelude-siem.com/en/technological-partners/">IDMEF Probes</a></li><li><a target="_blank" class="PrewikkaApps" href="https://github.com/Prelude-SIEM-Contrib">SIEM Apps</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <h2>manager-failover.diff</h2>

<div class="attachments">
<p>Implement a second failover for failure with a specific message. - 
   <span class="author"><a class="user active" href="/users/6">Yoann VANDOORSELAERE</a>, 07/12/2007 10:52 AM</span></p>
<p><a href="/attachments/download/101/manager-failover.diff">Download</a>   <span class="size">(6.91 KB)</span></p>
</div>

  <form action="/attachments/101/manager-failover.diff" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
    <p>
      View differences:
      <label><input type="radio" name="type" id="type_inline" value="inline" onchange="this.form.submit()" checked="checked" /> inline</label>
      <label><input type="radio" name="type" id="type_sbs" value="sbs" onchange="this.form.submit()" /> side by side</label>
    </p>
</form>  
<div class="autoscroll">
<table class="filecontent">
<thead>
  <tr>
    <th colspan="3" class="filename">
      plugins/reports/db/db.c
    </th>
  </tr>
</thead>
<tbody>
<tr>
  <th class="line-num">88</th>
  <th class="line-num">88</th>
  <td class="line-code ">
    <pre>        if ( ret &lt; 0 )</pre>
  </td>
</tr>
<tr>
  <th class="line-num">89</th>
  <th class="line-num">89</th>
  <td class="line-code ">
    <pre>                prelude_log(PRELUDE_LOG_WARN, &quot;could not insert message into database: %s.\n&quot;, preludedb_strerror(ret));</pre>
  </td>
</tr>
<tr>
  <th class="line-num">90</th>
  <th class="line-num">90</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">91</th>
  <td class="line-code diff_in">
    <pre>        if ( prelude_error_get_code(ret) == PRELUDEDB_ERROR_CONNECTION )</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">92</th>
  <td class="line-code diff_in">
    <pre>                ret = MANAGER_REPORT_PLUGIN_FAILURE_GLOBAL;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">93</th>
  <td class="line-code diff_in">
    <pre>        else</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">94</th>
  <td class="line-code diff_in">
    <pre>                ret = MANAGER_REPORT_PLUGIN_FAILURE_SINGLE;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">95</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">91</th>
  <th class="line-num">96</th>
  <td class="line-code ">
    <pre>        return ret;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">92</th>
  <th class="line-num">97</th>
  <td class="line-code ">
    <pre>}</pre>
  </td>
</tr>
<tr>
  <th class="line-num">93</th>
  <th class="line-num">98</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
</tbody>
</table>
</div>
<div class="autoscroll">
<table class="filecontent">
<thead>
  <tr>
    <th colspan="3" class="filename">
      src/include/prelude-manager.h
    </th>
  </tr>
</thead>
<tbody>
<tr>
  <th class="line-num">6</th>
  <th class="line-num">6</th>
  <td class="line-code ">
    <pre>* This file is part of the Prelude-Manager program.</pre>
  </td>
</tr>
<tr>
  <th class="line-num">7</th>
  <th class="line-num">7</th>
  <td class="line-code ">
    <pre>*</pre>
  </td>
</tr>
<tr>
  <th class="line-num">8</th>
  <th class="line-num">8</th>
  <td class="line-code ">
    <pre>* This program is free software; you can redistribute it and/or modify</pre>
  </td>
</tr>
<tr>
  <th class="line-num">9</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>* it under the terms of the GNU General Public License as published by<span> </span></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">9</th>
  <td class="line-code diff_in">
    <pre>* it under the terms of the GNU General Public License as published by<span></span></pre>
  </td>
</tr>
<tr>
  <th class="line-num">10</th>
  <th class="line-num">10</th>
  <td class="line-code ">
    <pre>* the Free Software Foundation; either version 2, or (at your option)</pre>
  </td>
</tr>
<tr>
  <th class="line-num">11</th>
  <th class="line-num">11</th>
  <td class="line-code ">
    <pre>* any later version.</pre>
  </td>
</tr>
<tr>
  <th class="line-num">12</th>
  <th class="line-num">12</th>
  <td class="line-code ">
    <pre>*</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">28</th>
  <th class="line-num">28</th>
  <td class="line-code ">
    <pre>/*</pre>
  </td>
</tr>
<tr>
  <th class="line-num">29</th>
  <th class="line-num">29</th>
  <td class="line-code ">
    <pre> * Report plugin entry structure.</pre>
  </td>
</tr>
<tr>
  <th class="line-num">30</th>
  <th class="line-num">30</th>
  <td class="line-code ">
    <pre> */</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">31</th>
  <td class="line-code diff_in">
    <pre>#define MANAGER_REPORT_PLUGIN_FAILURE_GLOBAL  -1</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">32</th>
  <td class="line-code diff_in">
    <pre>#define MANAGER_REPORT_PLUGIN_FAILURE_SINGLE  -2</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">33</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">31</th>
  <th class="line-num">34</th>
  <td class="line-code ">
    <pre>typedef struct {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">32</th>
  <th class="line-num">35</th>
  <td class="line-code ">
    <pre>        PRELUDE_PLUGIN_GENERIC;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">33</th>
  <th class="line-num">36</th>
  <td class="line-code ">
    <pre>        int (*run)(prelude_plugin_instance_t *pi, idmef_message_t *message);</pre>
  </td>
</tr>
</tbody>
</table>
</div>
<div class="autoscroll">
<table class="filecontent">
<thead>
  <tr>
    <th colspan="3" class="filename">
      src/report-plugins.c
    </th>
  </tr>
</thead>
<tbody>
<tr>
  <th class="line-num">54</th>
  <th class="line-num">54</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">55</th>
  <th class="line-num">55</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">56</th>
  <th class="line-num">56</th>
  <td class="line-code ">
    <pre>typedef struct {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">57</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>        <span>in</span>t failover_enabled;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">57</th>
  <td class="line-code diff_in">
    <pre>        <span>prelude_bool_</span>t failover_enabled;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">58</th>
  <th class="line-num">58</th>
  <td class="line-code ">
    <pre>        prelude_timer_t timer;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">59</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">59</th>
  <th class="line-num">60</th>
  <td class="line-code ">
    <pre>        prelude_failover_t *failover;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">61</th>
  <td class="line-code diff_in">
    <pre>        prelude_failover_t *failed_failover;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">60</th>
  <th class="line-num">62</th>
  <td class="line-code ">
    <pre>} plugin_failover_t;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">61</th>
  <th class="line-num">63</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">62</th>
  <th class="line-num">64</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">63</th>
  <th class="line-num">65</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">66</th>
  <td class="line-code diff_in">
    <pre>static int report_plugin_run_single(prelude_plugin_instance_t *pi, plugin_failover_t *pf, idmef_message_t *idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">67</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">68</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">69</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">64</th>
  <th class="line-num">70</th>
  <td class="line-code ">
    <pre>static void get_failover_filename(prelude_plugin_instance_t *pi, char *buf, size_t size)</pre>
  </td>
</tr>
<tr>
  <th class="line-num">65</th>
  <th class="line-num">71</th>
  <td class="line-code ">
    <pre>{</pre>
  </td>
</tr>
<tr>
  <th class="line-num">66</th>
  <th class="line-num">72</th>
  <td class="line-code ">
    <pre>        prelude_plugin_generic_t *plugin = prelude_plugin_instance_get_plugin(pi);</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">94</th>
  <th class="line-num">100</th>
  <td class="line-code ">
    <pre>                if ( ret &lt; 0 )</pre>
  </td>
</tr>
<tr>
  <th class="line-num">95</th>
  <th class="line-num">101</th>
  <td class="line-code ">
    <pre>                        break;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">96</th>
  <th class="line-num">102</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">97</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                ret = <span>prelude_plugin_run(pi, manager_report_plugin_t, run, pi</span>, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">98</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                if ( ret &lt; 0 &amp;&amp; <span>pf</span> )</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">103</th>
  <td class="line-code diff_in">
    <pre>                ret = <span>report_plugin_run_single(pi, pf</span>, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">104</th>
  <td class="line-code diff_in">
    <pre>                if ( ret &lt; 0 &amp;&amp; <span>ret != MANAGER_REPORT_PLUGIN_FAILURE_SINGLE</span> )</pre>
  </td>
</tr>
<tr>
  <th class="line-num">99</th>
  <th class="line-num">105</th>
  <td class="line-code ">
    <pre>                        break;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">100</th>
  <th class="line-num">106</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">101</th>
  <th class="line-num">107</th>
  <td class="line-code ">
    <pre>                prelude_msg_destroy(msg);</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">153</th>
  <th class="line-num">159</th>
  <td class="line-code ">
    <pre>                text = &quot;failed recovering&quot;;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">154</th>
  <th class="line-num">160</th>
  <td class="line-code ">
    <pre>        else {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">155</th>
  <th class="line-num">161</th>
  <td class="line-code ">
    <pre>                text = &quot;recovered&quot;;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">156</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                pf-&gt;failover_enabled = <span>0</span>;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">162</th>
  <td class="line-code diff_in">
    <pre>                pf-&gt;failover_enabled = <span>FALSE</span>;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">157</th>
  <th class="line-num">163</th>
  <td class="line-code ">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">158</th>
  <th class="line-num">164</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">159</th>
  <th class="line-num">165</th>
  <td class="line-code ">
    <pre>        prelude_log(PRELUDE_LOG_WARN, &quot;Plugin %s[%s]: %s from failover: %u/%u message flushed (%&quot; PRELUDE_PRIu64 &quot; bytes).\n&quot;,</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">192</th>
  <th class="line-num">198</th>
  <td class="line-code ">
    <pre>        get_failover_filename(pi, filename, sizeof(filename));</pre>
  </td>
</tr>
<tr>
  <th class="line-num">193</th>
  <th class="line-num">199</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">194</th>
  <th class="line-num">200</th>
  <td class="line-code ">
    <pre>        if ( ! prelude_plugin_instance_has_commit_func(pi) ) {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">195</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                prelude_log(PRELUDE_LOG_WARN, &quot;plugin %s does<span>n&#39;</span>t support failover.\n&quot;, plugin-&gt;name);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">201</th>
  <td class="line-code diff_in">
    <pre>                prelude_log(PRELUDE_LOG_WARN, &quot;plugin %s does<span> no</span>t support failover.\n&quot;, plugin-&gt;name);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">196</th>
  <th class="line-num">202</th>
  <td class="line-code ">
    <pre>                return -1;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">197</th>
  <th class="line-num">203</th>
  <td class="line-code ">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">198</th>
  <th class="line-num">204</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">209</th>
  <th class="line-num">215</th>
  <td class="line-code ">
    <pre>                return -1;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">210</th>
  <th class="line-num">216</th>
  <td class="line-code ">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">211</th>
  <th class="line-num">217</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">218</th>
  <td class="line-code diff_in">
    <pre>        snprintf(filename + strlen(filename), sizeof(filename) - strlen(filename), &quot;/invalid&quot;);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">219</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">220</th>
  <td class="line-code diff_in">
    <pre>        ret = prelude_failover_new(&amp;pf-&gt;failed_failover, filename);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">221</th>
  <td class="line-code diff_in">
    <pre>        if ( ret &lt; 0 ) {</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">222</th>
  <td class="line-code diff_in">
    <pre>                prelude_perror(ret, &quot;could not create failover object in %s&quot;, filename);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">223</th>
  <td class="line-code diff_in">
    <pre>                free(pf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">224</th>
  <td class="line-code diff_in">
    <pre>                return -1;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">225</th>
  <td class="line-code diff_in">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">226</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">212</th>
  <th class="line-num">227</th>
  <td class="line-code ">
    <pre>        prelude_plugin_instance_set_data(pi, pf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">213</th>
  <th class="line-num">228</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">214</th>
  <th class="line-num">229</th>
  <td class="line-code ">
    <pre>        try_recovering_from_failover(pi, pf);</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">251</th>
  <th class="line-num">266</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">252</th>
  <th class="line-num">267</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">253</th>
  <th class="line-num">268</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">254</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>static void failover_init(prelude_plugin_<span>generic_t *pg, prelude_plugin_</span>instance_t *pi, plugin_failover_t *pf)</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">269</th>
  <td class="line-code diff_in">
    <pre>static void failover_init(prelude_plugin_<span></span>instance_t *pi, plugin_failover_t *pf)</pre>
  </td>
</tr>
<tr>
  <th class="line-num">255</th>
  <th class="line-num">270</th>
  <td class="line-code ">
    <pre>{</pre>
  </td>
</tr>
<tr>
  <th class="line-num">256</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>        pf-&gt;failover_enabled = 1;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">271</th>
  <td class="line-code diff_in">
    <pre>        prelude_plugin_generic_t *pg = prelude_plugin_instance_get_plugin(pi);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">272</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">273</th>
  <td class="line-code diff_in">
    <pre>        pf-&gt;failover_enabled = TRUE;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">257</th>
  <th class="line-num">274</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">258</th>
  <th class="line-num">275</th>
  <td class="line-code ">
    <pre>        prelude_log(PRELUDE_LOG_WARN, &quot;Plugin %s[%s]: failure. Enabling failover.\n&quot;,</pre>
  </td>
</tr>
<tr>
  <th class="line-num">259</th>
  <th class="line-num">276</th>
  <td class="line-code ">
    <pre>                    pg-&gt;name, prelude_plugin_instance_get_name(pi));</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">271</th>
  <th class="line-num">288</th>
  <td class="line-code ">
    <pre>static int save_msgbuf(prelude_msgbuf_t *msgbuf, prelude_msg_t *msg)</pre>
  </td>
</tr>
<tr>
  <th class="line-num">272</th>
  <th class="line-num">289</th>
  <td class="line-code ">
    <pre>{</pre>
  </td>
</tr>
<tr>
  <th class="line-num">273</th>
  <th class="line-num">290</th>
  <td class="line-code ">
    <pre>        int ret;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">274</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>        p<span>lugin</span>_failover_t *pf = prelude_msgbuf_get_data(msgbuf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">291</th>
  <td class="line-code diff_in">
    <pre>        p<span>relude</span>_failover_t *pf = prelude_msgbuf_get_data(msgbuf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">275</th>
  <th class="line-num">292</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">276</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>        ret = prelude_failover_save_msg(pf<span>-&gt;failover</span>, msg);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">293</th>
  <td class="line-code diff_in">
    <pre>        ret = prelude_failover_save_msg(pf<span></span>, msg);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">277</th>
  <th class="line-num">294</th>
  <td class="line-code ">
    <pre>        if ( ret &lt; 0 )</pre>
  </td>
</tr>
<tr>
  <th class="line-num">278</th>
  <th class="line-num">295</th>
  <td class="line-code ">
    <pre>                prelude_perror(ret, &quot;error saving message to disk&quot;);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">279</th>
  <th class="line-num">296</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">283</th>
  <th class="line-num">300</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">284</th>
  <th class="line-num">301</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">285</th>
  <th class="line-num">302</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">286</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>static void save_idmef_message(p<span>lugin</span>_failover_t *pf, idmef_message_t *msg)</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">303</th>
  <td class="line-code diff_in">
    <pre>static void save_idmef_message(p<span>relude</span>_failover_t *pf, idmef_message_t *msg)</pre>
  </td>
</tr>
<tr>
  <th class="line-num">287</th>
  <th class="line-num">304</th>
  <td class="line-code ">
    <pre>{</pre>
  </td>
</tr>
<tr>
  <th class="line-num">288</th>
  <th class="line-num">305</th>
  <td class="line-code ">
    <pre>        /*</pre>
  </td>
</tr>
<tr>
  <th class="line-num">289</th>
  <th class="line-num">306</th>
  <td class="line-code ">
    <pre>         * this is a message we generated ourself...</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">295</th>
  <th class="line-num">312</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">296</th>
  <th class="line-num">313</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">297</th>
  <th class="line-num">314</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">315</th>
  <td class="line-code diff_in">
    <pre>static int report_plugin_run_single(prelude_plugin_instance_t *pi, plugin_failover_t *pf, idmef_message_t *idmef)</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">316</th>
  <td class="line-code diff_in">
    <pre>{</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">317</th>
  <td class="line-code diff_in">
    <pre>        int ret;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">318</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">319</th>
  <td class="line-code diff_in">
    <pre>        ret = prelude_plugin_run(pi, manager_report_plugin_t, run, pi, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">320</th>
  <td class="line-code diff_in">
    <pre>        if ( ret &lt; 0 &amp;&amp; pf ) {</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">321</th>
  <td class="line-code diff_in">
    <pre>                if ( ret == MANAGER_REPORT_PLUGIN_FAILURE_SINGLE )</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">322</th>
  <td class="line-code diff_in">
    <pre>                        save_idmef_message(pf-&gt;failed_failover, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">323</th>
  <td class="line-code diff_in">
    <pre>                else {</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">324</th>
  <td class="line-code diff_in">
    <pre>                        failover_init(pi, pf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">325</th>
  <td class="line-code diff_in">
    <pre>                        save_idmef_message(pf-&gt;failover, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">326</th>
  <td class="line-code diff_in">
    <pre>                }</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">327</th>
  <td class="line-code diff_in">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">328</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">329</th>
  <td class="line-code diff_in">
    <pre>        return ret;</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">330</th>
  <td class="line-code diff_in">
    <pre>}</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">331</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">332</th>
  <td class="line-code diff_in">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">298</th>
  <th class="line-num">333</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">299</th>
  <th class="line-num">334</th>
  <td class="line-code ">
    <pre>/*</pre>
  </td>
</tr>
<tr>
  <th class="line-num">300</th>
  <th class="line-num">335</th>
  <td class="line-code ">
    <pre> * Start all plugins of kind &#39;list&#39;.</pre>
  </td>
</tr>
<tr class="spacing">
  <th class="line-num">...</th><th class="line-num">...</th><td></td>
</tr>
<tr>
  <th class="line-num">322</th>
  <th class="line-num">357</th>
  <td class="line-code ">
    <pre>                        continue;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">323</th>
  <th class="line-num">358</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">324</th>
  <th class="line-num">359</th>
  <td class="line-code ">
    <pre>                if ( pf &amp;&amp; pf-&gt;failover_enabled ) {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">325</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                        save_idmef_message(pf<span></span>, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">360</th>
  <td class="line-code diff_in">
    <pre>                        save_idmef_message(pf<span>-&gt;failover</span>, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">326</th>
  <th class="line-num">361</th>
  <td class="line-code ">
    <pre>                        continue;</pre>
  </td>
</tr>
<tr>
  <th class="line-num">327</th>
  <th class="line-num">362</th>
  <td class="line-code ">
    <pre>                }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">328</th>
  <th class="line-num">363</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">329</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                ret = prelude_plugin_run(pi, manager_report_plugin_t, run, pi, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">330</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                if ( ret &lt; 0 &amp;&amp; pf ) {</pre>
  </td>
</tr>
<tr>
  <th class="line-num">331</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                        failover_init(pg, pi, pf);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">332</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                        save_idmef_message(pf, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num">333</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>                }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">334</th>
  <th class="line-num"></th>
  <td class="line-code diff_out">
    <pre>        }</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">364</th>
  <td class="line-code diff_in">
    <pre>                report_plugin_run_single(pi, pf, idmef);</pre>
  </td>
</tr>
<tr>
  <th class="line-num"></th>
  <th class="line-num">365</th>
  <td class="line-code diff_in">
    <pre>         }</pre>
  </td>
</tr>
<tr>
  <th class="line-num">335</th>
  <th class="line-num">366</th>
  <td class="line-code ">
    <pre>}</pre>
  </td>
</tr>
<tr>
  <th class="line-num">336</th>
  <th class="line-num">367</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
<tr>
  <th class="line-num">337</th>
  <th class="line-num">368</th>
  <td class="line-code ">
    <pre></pre>
  </td>
</tr>
</tbody>
</table>
</div>







        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
<!-- Piwik -->
<noscript><p><img src="//www.prelude-siem.org/piwik/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
<script type="text/javascript">
  var piwik_site_id = '3';

  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "*.dev.prelude-ids.com"]);
  _paq.push(["setDomains", ["*.dev.prelude-ids.com","*.prelude-ids.org","*.prelude-siem.org","*.www.prelude-ids.org","*.www.prelude-siem.org", "*.vigilo-nms.org", "*.www.vigilo-nms.org"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//www.prelude-siem.org/piwik/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', piwik_site_id]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2017 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111535491-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111535491-5');
</script>
 
</body>
</html>
