

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Prelude SIEM &mdash; Prelude Documentation 5.2</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Prelude Documentation 5.2" href="../index.html"/>
        <link rel="next" title="Prelude SIEM" href="../preludesiem-installation/preludesiem-installation.html"/>
        <link rel="prev" title="Prelude SIEM" href="../preludesiem-user-guide/preludesiem-user-guide.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Prelude Documentation
          

          
            
            <img src="../_static/Logo-prelude-oss-blanc.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                5.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Utilisation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#introduction">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#prelude-siem-la-supervision-de-securite">Prelude SIEM: The security monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#l-interface-graphique-de-prelude-siem">The Prelude SIEM graphical interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#tableaux-de-traitements-et-d-analyse">Tables for processing and analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#description-des-menus-de-prelude-gui">Prelude GUI menus description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#glossaire-et-abreviations">Glossary and abbreviations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-user-guide/preludesiem-user-guide.html#annexe-criteres-et-chemins">Annex: Criteria and paths</a></li>
</ul>
<p class="caption"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#objet">Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#domaine-d-application-de-ce-document">Scope of this document</a></li>
<li class="toctree-l2"><a class="reference internal" href="#audience-pour-ce-document">Audience for this document</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#prelude-siem-la-supervision-de-securite">Prelude SIEM: The security monitoring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#les-modules-prelude-siem">Prelude SIEM modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#configuration-du-bus-prelude-siem">Prelude SIEM bus configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-globale-global-conf">Global configuration file: global.conf</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#section-prelude">[prelude] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-node-address">[Node-Address] section</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-client-manager-client-conf">Client/Manager configuration file: client.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connexion-client-idmef-manager-idmef-client-conf">IDMEF Client/Manager connection: idmef_client.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connexion-client-tls-manager-tls-conf">TLS Client/Manager connection: tls.conf</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#configuration-des-modules-prelude-siem">Prelude SIEM modules configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-de-prelude-manager">Prelude Manager configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-generique">Generic confguration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">[prelude] section</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-generale">General configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-de-planification-de-prelude-manager">Scheduler settings for Prelude Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-tls">TLS options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-de-relaying">Relaying setting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protection-contre-de-possibles-defaillances">Protection against possible failures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-des-plugins-de-prelude-manager">Prelude Manager plugins configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-des-plugins-de-normalisation">Normalization plugins configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-des-plugins-de-reporting">Reporting plugins configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-des-plugins-de-filtrage">Filtering plugins configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-de-prelude-lml">Prelude LML configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">[prelude] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-format">[normalize] section</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prefix-regex">prefix-regex</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-format">time-format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file">file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#udp-server">udp-server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tcp-server">tcp-server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tcp-tls-server">tcp-ssl-server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#idmef-alter">idmef-alter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#idmef-alter-force">idmef-alter-force</a></li>
<li class="toctree-l4"><a class="reference internal" href="#charset">charset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parametres-globaux">Global settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#log-max-length">log-max-length</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rotations-des-journaux">Log rotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parametres-tls">TLS settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#section-pcre">[Pcre] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">[Debug] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-des-plugins">Plugins configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#source">source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plugin">plugin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pcre-option">pcre-option</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regex">regex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utilisation-de-plus-d-un-plugin-pcre">Using more than one PCRE plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-de-prelude-correlator">Prelude Correlator Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#section-general"><strong>[general] section</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-bruteforceplugin">[BruteForcePlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-businesshourplugin">[BusinessHourPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-opensshauthplugin">[OpenSSHAuthPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-eventscanplugin">[EventScanPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-eventstormplugin">[EventStormPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-eventsweepplugin">[EventSweepPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-wormplugin">[WormPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-ciarmyplugin">[CIArmyPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-dshieldplugin">[DshieldPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-spamhausdropplugin">[SpamhausDropPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-firewallplugin">[FirewallPlugin] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-python-rules">[python_rules] section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#section-include"><strong>[include] section</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-de-prelude-gui">Prelude GUI configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-principale">Main configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5"><strong>[general] section</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-interface">[interface] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-idmef-database">[idmef_database] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-database">[database] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-log-stderr">[log stderr] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-log-file">[log file] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-log-syslog">[log syslog] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-log-nteventlog">[log nteventlog] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-log-smtp">[log smtp] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-cron-alert">[cron alert] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-cron-heartbeat">[cron heartbeat] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-cron-search-history">[cronsearch_history] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><strong>[include] section</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-des-menus">Menu settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-additionnelle-fichier-external-app-conf">Additional configuration: external_app.conf file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#section-appli-app1">[appli app1] section</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-additionnelle-fichier-logs-conf">Additional configuration: logs.conf file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sections-elasticsearch">[elasticsearch] sections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-additionnelle-fichiers-auth-conf">Additional configuration: auth.conf file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#section-session-loginform">[session loginform] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-session-anonymous">[session anonymous] section</a></li>
<li class="toctree-l4"><a class="reference internal" href="#section-auth-dbauth">[auth dbauth] section</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-additionnelle-fichier-alerts-conf">Additional configuration: alerts.conf file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#section-datasearch-alert">[datasearch alert] section</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-additionnelle-fichier-riskoverview-conf">Additional configuration: riskoverview.conf file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#section-riskoverview">[riskoverview] section</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#glossaire-et-abreviations">Glossary &amp; abbreviations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#glossaire">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#abreviations">Abbreviations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#annexe-criteres-et-chemins-idmef">Annex: IDMEF criteria and paths</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#criteres-idmef">IDMEF criteria</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creation-de-filtre-a-l-aide-de-criteres-idmef">Filter creation with IDMEF criteria</a></li>
<li class="toctree-l3"><a class="reference internal" href="#syntaxe-des-criteres-idmef">IDMEF criteria syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#chemins-idmef">IDMEF paths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#correspondance-des-classes-idmef-et-des-chemins-idmef">Mapping an IDMEF class to an IDMEF path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elements-indexes">Indexed elements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#annexe-fichiers-de-configuration">Annex: Configuration files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-global-global-conf">Global configuration file: global.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-client-client-conf">Client configuration file: client.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-client-idmef-idmef-client-conf">IDMEF client configuration file: idmef-client.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-tls-tls-conf">TLS configuration file: tls.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-de-prelude-manager-prelude-manager-conf">Prelude Manager configuration file: prelude-manager.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-de-prelude-lml-prelude-lml-conf">Prelude LML configuration file: prelude-lml.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-de-prelude-correlator-prelude-correlator-conf">Prelude Correlator configuration file: prelude-correlator.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-de-prelude-gui-prewikka-conf">Prelude GUI configuration file: prewikka.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-additionnel-de-prelude-gui-alerts-conf">Additional Prelude GUI configuration file: alerts.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-additionnel-de-prelude-gui-auth-conf">Additional Prelude GUI configuration file: auth.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-additionnel-de-prelude-gui-external-app-conf">Additional Prelude GUI configuration file: external_app.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-additionnel-de-prelude-gui-logs-conf">Additional Prelude GUI configuration file: logs.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fichier-de-configuration-additionnel-de-prelude-gui-riskoverview-conf">Additional Prelude GUI configuration file: riskoverview.conf</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#annexe-aide-de-prelude-siem">Annex: Prelude SIEM help</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aide-de-prelude-manager">Prelude Manager help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aide-de-prelude-lml">Prelude LML help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aide-de-prelude-correlator">Prelude Correlator help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aide-de-prelude-admin">prelude-admin help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aide-de-preludedb-admin">preludedb-admin help</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#introduction">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#prelude-siem-la-supervision-de-securite">Prelude SIEM: The security monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#presentation-generale">Quick Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#installation-de-la-base-de-donnees-prelude-siem">Initialize the Prelude SIEM database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#installation-de-prelude-siem">Prelude SIEM installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#installation-du-serveur-web">Web server installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#glossaire-et-abreviations">Glossary &amp; abbreviations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preludesiem-installation/preludesiem-installation.html#sauvegarde">Backup</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Prelude Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Prelude SIEM</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>PUBLICATION HISTORY</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Date</th>
<th class="head">Modification</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>V 5.1</td>
<td>13/09/2019</td>
<td>Updates to take changes in Prelude 5.1 into account</td>
</tr>
<tr class="row-odd"><td>V 5.0</td>
<td>07/09/2018</td>
<td>Updates to take changes in Prelude 5.0 into account</td>
</tr>
<tr class="row-even"><td>V 4.1</td>
<td>21/07/2017</td>
<td>Updates to take changes in Prelude 4.1 into account</td>
</tr>
<tr class="row-odd"><td>V 4.0</td>
<td>27/02/2017</td>
<td>Updates to take changes in Prelude 4.0 into account</td>
</tr>
<tr class="row-even"><td>V 3.1</td>
<td>14/09/2016</td>
<td>Updates to take changes in Prelude 3.1 into account</td>
</tr>
<tr class="row-odd"><td>V 3.0</td>
<td>20/05/2016</td>
<td>Updates to take changes in Prelude 3.0 into account</td>
</tr>
<tr class="row-even"><td>V 2.1</td>
<td>21/08/2015</td>
<td>Updates to take changes in Prelude 2.1 into account</td>
</tr>
<tr class="row-odd"><td>V 2.0</td>
<td>20/10/2014</td>
<td>Initial version</td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objet">
<h2>Object<a class="headerlink" href="#objet" title="Permalink to this headline">¶</a></h2>
<p>This guide presents:</p>
<ul class="simple">
<li>The <strong>Prelude SIEM</strong> product;</li>
<li>The configuration files:</li>
<li><ul class="first">
<li><em>General configuration:</em> global.conf, client.conf, idmef-client.conf, tls.conf</li>
<li><em>Prelude SIEM modules configuration:</em><ul>
<li>Prelude Manager;</li>
<li>Prelude LML;</li>
<li>Prelude Correlator;</li>
<li>Prelude GUI;</li>
</ul>
</li>
<li>An example of multi-tenant configuration.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="domaine-d-application-de-ce-document">
<h2>Scope of this document<a class="headerlink" href="#domaine-d-application-de-ce-document" title="Permalink to this headline">¶</a></h2>
<p>This document is applicable to:</p>
<ul class="simple">
<li><strong>Prelude SIEM</strong> version 5.2;</li>
<li>Operating systems:<ul>
<li>CentOS/Redhat version 7 - 64 bits;</li>
</ul>
</li>
<li>Databases:<ul>
<li>PostgreSQL version 9.2 and newer;</li>
</ul>
</li>
<li>External sensors:<ul>
<li>Suricata version 4.0 and newer;</li>
<li>Samhain version 3.1 and newer;</li>
<li>OSSEC version 2.8 and newer;</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="audience-pour-ce-document">
<h2>Audience for this document<a class="headerlink" href="#audience-pour-ce-document" title="Permalink to this headline">¶</a></h2>
<p>This document is mainly dedicated to the following teams:</p>
<ul class="simple">
<li>The <strong>Prelude SIEM</strong> integration team;</li>
<li>The <strong>Prelude SIEM</strong> support and deployment team;</li>
<li>The <strong>Prelude SIEM</strong> administration team;</li>
<li>The <strong>Prelude SIEM</strong> users.</li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>This section gives links for the web page on <strong>Prelude SIEM</strong> product and operating systems:</p>
<ul class="simple">
<li>Prelude SIEM: <a class="reference external" href="https://www.prelude-siem.com">https://www.prelude-siem.com</a> and <a class="reference external" href="https://www.prelude-siem.org">https://www.prelude-siem.org</a></li>
<li>Operating systems:<ul>
<li>CentOS/Redhat: <a class="reference external" href="http://www.centos.org">http://www.centos.org</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="prelude-siem-la-supervision-de-securite">
<h1>Prelude SIEM: The security monitoring<a class="headerlink" href="#prelude-siem-la-supervision-de-securite" title="Permalink to this headline">¶</a></h1>
<p><strong>Prelude SIEM</strong> is an open-source security monitoring solution. Its objective is to centralize all security events of an information system and to offer a homogeneous vision to the operators. <strong>Prelude SIEM</strong> collects, normalizes, sorts, aggregates, correlates and reports all security-related events independently of the product brand or license giving rise to such events.</p>
<a class="reference internal image-reference" href="../_images/prelude_presentation1.png"><img alt="../_images/prelude_presentation1.png" class="align-center" src="../_images/prelude_presentation1.png" style="width: 15.4472cm; height: 12.7608cm;" /></a>
<p class="centered">
<strong>Figure: Features of Prelude SIEM</strong></p><p><strong>Prelude SIEM</strong> presents a specificity almost unique in the SIEM community: it implements the IDMEF format. This format is defined in an RFC since 2007 at the IETF and allows homogenizing the way a security alert is presented. Through the use of this format and its interconnection library, it is easy to make other tools communicate with <strong>Prelude SIEM</strong>. Beyond its capacity to analyze any type of log (system logs, log streams, flat files, etc.), <strong>Prelude SIEM</strong> also benefits from a native support with a number of HIDS and NIDS sensors; with the best known being Snort, Samhain, OSSEC and Suricata.</p>
<p><strong>Prelude SIEM</strong> is available in three versions:</p>
<ul class="simple">
<li><strong>Prelude OSS</strong>: Free, public and open-source version, released under GPL V2 license. Prelude OSS implements the event management part of Prelude (SEM). Since version 5.2, Prelude OSS also makes it possible to store, display and analyze raw security information (SIM). This version is intended for small parks of limited size (&lt;10 machines), students, research organizations, as well as for testing by users interested in acquiring Prelude SIEM. The performance of Prelude OSS is highly limited by the volume of data analyzed.</li>
<li><strong>Prelude SIEM</strong>: Professional version based on the open-source version <strong>Prelude OSS</strong> and that greatly enhances its performance. Prelude SIEM offers many additional features (ticket management, dynamic statistics, geolocation, archiving, etc.) and capabilities to be deployed and operated easily and efficiently on complex and large-scaled parks of machines.</li>
<li><strong>Prelude SOC</strong>: Fully scaled version, mainly for Security Operational Center (SOC) usage. Necessary modules for an operational security center, in addition to Prelude SIEM, are: Prelude MAP (network topological representation), Prelude CTI (Cyber Threat Intelligence) and Prelude NOC (performance and availability monitoring).</li>
</ul>
<div class="section" id="les-modules-prelude-siem">
<h2>Prelude SIEM modules<a class="headerlink" href="#les-modules-prelude-siem" title="Permalink to this headline">¶</a></h2>
<p>The following figure shows how Prelude SIEM’s modules communicate together:</p>
<a class="reference internal image-reference" href="../_images/prelude_modules1.png"><img alt="../_images/prelude_modules1.png" class="align-center" src="../_images/prelude_modules1.png" style="width: 12.1768cm; height: 11.704cm;" /></a>
<p class="centered">
<strong>Figure: Event tracking between Prelude SIEM modules</strong></p><p>The path of an event between the different Prelude SIEM modules is as follows:</p>
<ol class="arabic simple">
<li>The application generates a log and sends it to Prelude LML (either under file form or through a Syslog connection);</li>
<li>The log is analyzed by Prelude LML (thanks to its set of rules). If this log is considered suspicious, Prelude LML creates an IDMEF alert and sends it to its manager (Prelude Manager that can be chained to another Prelude Manager instance);</li>
<li>Prelude Manager performs the filters and treatments that are configured and then inserts the event into the database;</li>
<li>Prelude Correlator receives the alerts from Prelude Manager;</li>
<li>If several raw alerts match a correlation scenario, a correlation alert is generated and sent to Prelude Manager;</li>
<li>Prelude Manager also writes correlation alerts into the database;</li>
<li>Prelude GUI connects to the database via LibPreludeDB in order to read information and sends it to a browser.</li>
</ol>
<p>In parallel, Prelude Manager can receive alerts from other sources:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>A third-party intrusion detection sensor sends its alerts to Prelude Manager (e.g. OSSEC, Samhain, Suricata, etc).</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="configuration-du-bus-prelude-siem">
<h1>Prelude SIEM bus configuration<a class="headerlink" href="#configuration-du-bus-prelude-siem" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes general configuration of <strong>Prelude SIEM</strong>.</p>
<p>Each configuration file applies the following formalism:</p>
<ul class="simple">
<li>A tag, to indicate a section: <em>[name]</em></li>
<li>A section with configuration variables: key <em>= value</em> or <em>key</em></li>
<li>A section containing only variables</li>
<li>A comment with at the beginning of the sentences: <em>#</em></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[prelude]</span>
<span class="c1"># Commentaire à propos de la section (un commentaire, commençant par #)</span>
<span class="c1"># Commentaire à propos de la variable</span>
<span class="na">tcp-keepalive-time</span> <span class="o">=</span> <span class="s">7200 (une variable)</span>
<span class="c1"># Commentaire à propos de la variable</span>
<span class="na">tcp-keepalive-probes</span> <span class="o">=</span>
<span class="c1"># Commentaire à propos de la variable</span>
<span class="na">tcp-keepalive-intvl</span> <span class="o">=</span> <span class="s">75</span>
</pre></div>
</div>
<div class="section" id="id1">
<h2>Introduction<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>All <strong>Prelude SIEM</strong> agents have a common set of options, provided through the <strong>Prelude SIEM</strong> framework. You might modify these system wide options or in the specific configuration file a client might provide.</p>
<p>All options defined system wide might be overridden in the client own <strong>Prelude SIEM</strong> configuration file. These are just template values that the client will use in case the values are not defined.</p>
<p>Once the <strong>Prelude SIEM</strong> library installed, you can tune system wide options using the following configuration files:</p>
<ul class="simple">
<li><code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/global.conf</span></code></li>
<li><code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/client.conf</span></code></li>
<li><code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/idmef-client.conf</span></code></li>
<li><code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/tls.conf</span></code></li>
</ul>
<p>The following sections explain in detail how to configure these files.</p>
</div>
<div class="section" id="configuration-globale-global-conf">
<h2>Global configuration file: global.conf<a class="headerlink" href="#configuration-globale-global-conf" title="Permalink to this headline">¶</a></h2>
<p>This is the common default configuration file for all <strong>Prelude SIEM</strong> programs (sensors, agents, and Manager) using libprelude. It provides a system wide template for common IDMEF attributes used by sensors.</p>
<p>All of these settings are optional, but keep in mind setting them will help you to keep track of where an event is coming from, especially in a distributed environment witha high number of sensors.</p>
<p>This file is located in <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/global.conf</span></code></p>
<div class="section" id="section-prelude">
<h3>[prelude] section<a class="headerlink" href="#section-prelude" title="Permalink to this headline">¶</a></h3>
<p>The <strong>heartbeat-interval</strong> option defines how often a <strong>Prelude SIEM</strong> client should send a heartbeat. The default is 600 seconds, namely 10 minutes.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">heartbeat-interval</span> <span class="o">=</span> <span class="s">600</span>
</pre></div>
</div>
<p>You can define IDMEF attributes to be carried by events emitted by the program:</p>
<ul class="simple">
<li><strong>analyzer-name</strong>: Name for the analyzer (by default, this is set to the profile name used by the sensor);</li>
<li><strong>node-name</strong>: Name of the equipment (usually the name of the machine this sensor is running on);</li>
<li><strong>node-location</strong>: Location of the equipment (could be a city, or a country);</li>
<li><strong>node-category</strong>: The type of node the clients are running on (usually <em>host</em>).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All of these settings are optional.</p>
</div>
<p>The following table shows the possible values of <strong>node-category</strong> option:</p>
<table border="1" class="docutils" id="possible-values-for-node-category-option">
<caption><span class="caption-text">Possible values for node-category option</span><a class="headerlink" href="#possible-values-for-node-category-option" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>unknown</td>
<td>Unknown or not relevant</td>
</tr>
<tr class="row-odd"><td>ads</td>
<td>Windows 2000 Advanced Directory Services</td>
</tr>
<tr class="row-even"><td>afs</td>
<td>Andrew File System (Transarc)</td>
</tr>
<tr class="row-odd"><td>coda</td>
<td>Coda Distributed File System</td>
</tr>
<tr class="row-even"><td>dfs</td>
<td>Distributed File System (IBM)</td>
</tr>
<tr class="row-odd"><td>dns</td>
<td>Domain Name System</td>
</tr>
<tr class="row-even"><td>hosts</td>
<td>Local hosts file</td>
</tr>
<tr class="row-odd"><td>kerberos</td>
<td>Kerberos realm</td>
</tr>
<tr class="row-even"><td>nds</td>
<td>Novell Directory Services</td>
</tr>
<tr class="row-odd"><td>nis</td>
<td>Network Information Services (Sun)</td>
</tr>
<tr class="row-even"><td>nisplus</td>
<td>Network Information Services Plus (Sun)</td>
</tr>
<tr class="row-odd"><td>nt</td>
<td>Windows NT domain</td>
</tr>
<tr class="row-even"><td>wfw</td>
<td>Windows for Workgroups</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="section-node-address">
<h3>[Node-Address] section<a class="headerlink" href="#section-node-address" title="Permalink to this headline">¶</a></h3>
<p>You might also want to define one or several <strong>[Node-address]</strong> sections, containing the following options:</p>
<ul class="simple">
<li><strong>address</strong>: The address of the equipment;</li>
<li><strong>netmask</strong>: Netmask for this address;</li>
<li><strong>VLAN-name</strong>: Name of the Virtual LAN to which the address belongs;</li>
<li><strong>VLAN-num</strong>: Number of the Virtual LAN to which the address belongs;</li>
<li><strong>category</strong>: Type of address represented (usually <em>ipv4-addr</em> or <em>ipv6-addr</em>).</li>
</ul>
<p>The following table shows the possible values of <strong>category</strong> option (by default, defined to <em>unknown</em>):</p>
<table border="1" class="docutils" id="possible-values-for-category-option">
<caption><span class="caption-text">Possible values for category option</span><a class="headerlink" href="#possible-values-for-category-option" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Values</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>unknown</td>
<td>Unknown address type</td>
</tr>
<tr class="row-odd"><td>srm</td>
<td>Asynchronous Transfer Mode</td>
</tr>
<tr class="row-even"><td>e-mail</td>
<td>Electronic mail address (RFC 822)</td>
</tr>
<tr class="row-odd"><td>lotus-notes</td>
<td>Lotus Notes e-mail address</td>
</tr>
<tr class="row-even"><td>mac</td>
<td>Media Access Control (MAC) address</td>
</tr>
<tr class="row-odd"><td>sna</td>
<td>IBM Shared Network Architecture (SNA)</td>
</tr>
<tr class="row-even"><td>vm</td>
<td>IBM VM (“PROFS”) e-mail address</td>
</tr>
<tr class="row-odd"><td>ipv4-addr</td>
<td>IPv4 host address in dotted-decimal notation (a.b.c.d)</td>
</tr>
<tr class="row-even"><td>ipv4-addr-hex</td>
<td>IPv4 host address in hexadecimal notation</td>
</tr>
<tr class="row-odd"><td>ipv4-net</td>
<td>IPv4 network address in dotted-decimal notation, slash, CIDR (a.b.c.d/nn)</td>
</tr>
<tr class="row-even"><td>ipv4-net-mask</td>
<td>IPv4 network address in dotted-decimal notation, slash, network mask in dotted-decimal notation (a.b.c.d/w.x.y.z)</td>
</tr>
<tr class="row-odd"><td>ipv6-addr</td>
<td>IPv6 host address</td>
</tr>
<tr class="row-even"><td>ipv6-addr-hex</td>
<td>IPv6 host address in hexadecimal notation</td>
</tr>
<tr class="row-odd"><td>ipv6-net</td>
<td>IPv6 network address, slash, CIDR</td>
</tr>
<tr class="row-even"><td>ipv6-net-mask</td>
<td>IPv6 network address, slash, network mask</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="configuration-client-manager-client-conf">
<h2>Client/Manager configuration file: client.conf<a class="headerlink" href="#configuration-client-manager-client-conf" title="Permalink to this headline">¶</a></h2>
<p>This is the default configuration for programs linked to a manager (sensors and agents) that use Libprelude.</p>
<p>This file is located in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/client.conf</span></code> and contains only one section, which is <strong>[prelude]</strong>.</p>
<p>In this configuration file, you can configure the connection string that clients, which need to connect to a Prelude Manager, will use.</p>
<p>By default this option is uncommented and sets on the localhost IP address.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">127.0.0.1</span>
</pre></div>
</div>
<p>Note that whatever you specify here, any event sent through the <strong>Prelude SIEM</strong> framework is saved in case the remote Manager goes down. In this case, all events will be saved and the client will periodically attempt to reconnect and flush saved events.</p>
<p>Here are a few configuration examples:</p>
<ul class="simple">
<li>Connect and send events to <em>x.x.x.x</em>:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">x.x.x.x</span>
</pre></div>
</div>
<p>You can use boolean operators ‘||’ (OR) and ‘&amp;&amp;’ (AND) to set up a redundant configuration environment.</p>
<ul class="simple">
<li>Connect and send events to both <em>x.x.x.x</em> and <em>y.y.y.y</em>:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">x.x.x.x &amp;&amp; y.y.y.y</span>
</pre></div>
</div>
<ul class="simple">
<li>Connect and send events to <em>x.x.x.x</em>, or fallback to <em>y.y.y.y</em> if <em>x.x.x.x</em> failed:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">x.x.x.x || y.y.y.y</span>
</pre></div>
</div>
<ul class="simple">
<li>Connect and send events to <em>x.x.x.x</em> on specific port, or fallback to <em>y.y.y.y*and *z.z.z.z</em> if <em>x.x.x.x</em> failed:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">x.x.x.x:port || y.y.y.y &amp;&amp; z.z.z.z</span>
</pre></div>
</div>
<p>This mean the emission should occur on <em>x.x.x.x:port</em> or, if it fails, on <em>y.y.y.y</em> and <em>z.z.z.z</em> (if one of the two hosts in the AND fails, the emission will be considered as failed involving saving the message locally).</p>
<p>The following settings instruct the operating system when to consider a connection dead in case sent data is left unacknowledged.</p>
<p>These options are operating system specific, and might not work on certain platforms. In case you modify these settings on an unsupported system, a warning message will be issued when the agent starts.</p>
<p>Under Linux, the default system wide configuration is:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tcp-keepalive-time</span> <span class="o">=</span> <span class="s">7200</span>
<span class="na">tcp-keepalive-probes</span> <span class="o">=</span> <span class="s">9</span>
<span class="na">tcp-keepalive-intvl</span> <span class="o">=</span> <span class="s">75</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>tcp-keepalive-time</strong> represents the number of seconds the connection needs to be idle before TCP begins sending out keep-alive sensors;</li>
<li><strong>tcp-keepalive-probes</strong> represents the number of non-acknowledged packets to send before considering the connection dead;</li>
<li><strong>tcp-keepalive-intvl</strong> represents the interval between subsequent keepalive sensors.</li>
</ul>
<p>The average time to notice a dead connection can be calculated using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connexion</span> <span class="n">échouée</span> <span class="o">=</span> <span class="n">tcp</span><span class="o">-</span><span class="n">keepalive</span><span class="o">-</span><span class="n">time</span> <span class="o">+</span> <span class="p">(</span><span class="n">tcp</span><span class="o">-</span><span class="n">keepalive</span><span class="o">-</span><span class="n">probes</span> <span class="o">*</span> <span class="n">tcp</span><span class="o">-</span><span class="n">keepalive</span><span class="o">-</span><span class="n">intvl</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Configuration example</em>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tcp-keepalive-time</span> <span class="o">=</span> <span class="s">60</span>
<span class="na">tcp-keepalive-probes</span> <span class="o">=</span> <span class="s">3</span>
<span class="na">tcp-keepalive-intvl</span> <span class="o">=</span> <span class="s">10</span>
</pre></div>
</div>
<p>Using the above settings, a dead connection will be detected within 90 seconds.</p>
<p>You can set priorities for the ciphers, key exchange methods, macs and compression methods using TLS options (only available with GnuTLS 2.2.0 or higher) by setting the <strong>tls-options</strong> option.</p>
<p>The default setting is “NORMAL”.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-options</span> <span class="o">=</span> <span class="s">NORMAL</span>
</pre></div>
</div>
<p>The following table shows the possible values of <strong>tls-options</strong> option:</p>
<table border="1" class="docutils" id="possible-values-for-tls-options-option">
<caption><span class="caption-text">Possible values for tls-options option</span><a class="headerlink" href="#possible-values-for-tls-options-option" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>NORMAL</td>
<td>Enables all “secure” ciphersuites. The 256-bit ciphers are included as a fallback only. The ciphers are sorted by security margin.</td>
</tr>
<tr class="row-odd"><td>SECURE128</td>
<td>Enables all “secure” ciphersuites with ciphers up to 128 bits, sorted by security margin.</td>
</tr>
<tr class="row-even"><td>SECURE256</td>
<td>Enables all “secure” ciphersuites including the 256 bit ciphers, sorted by security margin.</td>
</tr>
<tr class="row-odd"><td>EXPORT</td>
<td>All the ciphersuites are enabled, including the low-security 40 bit ciphers.</td>
</tr>
<tr class="row-even"><td>NONE</td>
<td>Nothing is enabled. This disables even protocols and compression methods.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Much more settings might be enabled or disabled using this option: please see <em class="manpage">gnutls_priority_init(3)</em> for more details.</p>
</div>
</div>
<div class="section" id="connexion-client-idmef-manager-idmef-client-conf">
<h2>IDMEF Client/Manager connection: idmef_client.conf<a class="headerlink" href="#connexion-client-idmef-manager-idmef-client-conf" title="Permalink to this headline">¶</a></h2>
<p>This file located in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/idmef_client.conf</span></code> and includes both <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/global.conf</span></code> and <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/client.conf</span></code> configuration files:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">include</span> <span class="o">=</span> <span class="s">/etc/prelude/default/global.conf</span>
<span class="na">include</span> <span class="o">=</span> <span class="s">/etc/prelude/default/client.conf</span>
</pre></div>
</div>
<p>It is often used as the template by clients that need to connect to a <strong>Prelude Manager</strong>. You probably should not modify this file directly (use <em>global.conf</em> and <em>client.conf</em>).</p>
</div>
<div class="section" id="connexion-client-tls-manager-tls-conf">
<h2>TLS Client/Manager connection: tls.conf<a class="headerlink" href="#connexion-client-tls-manager-tls-conf" title="Permalink to this headline">¶</a></h2>
<p>This file located in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/tls.conf</span></code> allows to configure several TLS specific options.</p>
<p>Default size of the client/server generated private key:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">generated-key-size</span> <span class="o">=</span> <span class="s">2048</span>
</pre></div>
</div>
<p>Number of days the authority certificates (server side) will remain valid. These certificates are only used in order to sign client certificate.</p>
<p>Use 0 for the maximum possible value.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">authority-certificate-lifetime</span> <span class="o">=</span> <span class="s">0</span>
</pre></div>
</div>
<p>Number of days the generated certificates (client side) will remain valid. These certificates are only used in order to authenticate and encrypt client/server communication.</p>
<p>Use 0 for the maximum possible value.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">generated-certificate-lifetime</span> <span class="o">=</span> <span class="s">0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-des-modules-prelude-siem">
<h1>Prelude SIEM modules configuration<a class="headerlink" href="#configuration-des-modules-prelude-siem" title="Permalink to this headline">¶</a></h1>
<p>This chapter explains the configuration of <strong>Prelude SIEM</strong> modules.</p>
<p>Sections are important, and things won’t work correctly if they are not uncommented. For example you need to uncomment <strong>[db]</strong> section if you want the <strong>database</strong> plugin to be loaded.</p>
<div class="section" id="configuration-de-prelude-manager">
<h2>Prelude Manager configuration<a class="headerlink" href="#configuration-de-prelude-manager" title="Permalink to this headline">¶</a></h2>
<p><strong>Prelude Manager</strong> is a high availability server that accepts secured connections from distributed sensors or other managers and saves received events to a media specified by the user (database, logfile, mail, etc). It is capable of handling large number of connections, and processing large amounts of events. It uses a per client scheduling queues in order to process events by severity fairly across clients.</p>
<p>The configuration file is located in <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-manager/prelude-manager.conf</span></code>.</p>
<div class="section" id="configuration-generique">
<h3>Generic confguration<a class="headerlink" href="#configuration-generique" title="Permalink to this headline">¶</a></h3>
<p>This file includes the global.conf configuration file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">include</span> <span class="o">=</span> <span class="s">/etc/prelude/default/global.conf</span>
</pre></div>
</div>
<div class="section" id="id2">
<h4>[prelude] section<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Using the global <strong>[prelude]</strong> section, where you can define <strong>Prelude SIEM</strong> related options, you can define option of matter for <strong>Prelude Manager</strong>, and most specifically in the context of relaying, TCP/IP options that influence the behavior of when the operating system should consider a connection dead in case sent data is left unacknowledged.</p>
<p>Refer to the section <span class="xref std std-ref">Client/Manager configuration file: client.conf</span> to configure this section.</p>
</div>
</div>
<div class="section" id="configuration-generale">
<h3>General configuration<a class="headerlink" href="#configuration-generale" title="Permalink to this headline">¶</a></h3>
<p><strong>Prelude Manager</strong> can listen on a UNIX domain socket, or on an IPv4 or IPv6 address. The default is to listen on an UNIX domain socket. The <strong>listen</strong> option configures the address where the <strong>Prelude Manager</strong> server is listening on.</p>
<p>Multiple listen addresses are supported. If value is <em>unix</em>, or <em>unix:/path/to/unix/socket</em>, a UNIX domain socket will be used.</p>
<ul class="simple">
<li>Listen on <em>/tmp/prelude-unix</em> UNIX domain socket (this is the default value):</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listen</span> <span class="o">=</span> <span class="s">unix</span>
</pre></div>
</div>
<ul class="simple">
<li>Listen on <em>/tmp/myfilename</em> UNIX domain socket:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listen</span> <span class="o">=</span> <span class="s">unix:/tmp/prelude-manager.socket</span>
</pre></div>
</div>
<ul class="simple">
<li>Listen on the specified IP address and port:</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listen</span> <span class="o">=</span> <span class="s">&lt;IP address&gt;:&lt;port&gt;</span>
</pre></div>
</div>
<p>The IP address specified is compatible with ipv4 and ipv6. By default this option is uncommented and setting on the localhost IP address.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">listen</span> <span class="o">=</span> <span class="s">127.0.0.1</span>
</pre></div>
</div>
<p>You might set the user and group ID as which <strong>Prelude Manager</strong> will run. In order to use this option, <strong>Prelude Manager</strong> must be run initially as <em>root</em>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">user</span> <span class="o">=</span> <span class="s">prelude-manager</span>
<span class="na">group</span> <span class="o">=</span> <span class="s">prelude</span>
</pre></div>
</div>
<p>You can customize the number of second <strong>Prelude Manager</strong> wait for an incoming client to successfully authenticate before dropping a connection. The default value is 10 seconds.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">connection-timeout</span> <span class="o">=</span> <span class="s">10</span>
</pre></div>
</div>
</div>
<div class="section" id="options-de-planification-de-prelude-manager">
<h3>Scheduler settings for Prelude Manager<a class="headerlink" href="#options-de-planification-de-prelude-manager" title="Permalink to this headline">¶</a></h3>
<p>On systems with many concurrent sensors sending events to <strong>Prelude Manager</strong>, <strong>Prelude Manager</strong> might have a hard time keeping up with the demand for events reporting.</p>
<p>The <strong>Prelude Manager</strong> scheduler allocate reporting time per sensor, allowing to define the maximum number of events processed for one sensor before processing others sensors events (in case a sensor is sending a continuous events burst, this prevent other sensors starvation).</p>
<p>By default, for each sensor connected, a maximum of 100 events will be processed before processing others sensors events.</p>
<p>Additionally, priority will be given to events depending on their priority. Assuming there is enough events of each priority, 50 high priority message will be processed, 30 medium, and 20 low (totaling the maximum of 100 described above).</p>
<p>You might use the <strong>sched-priority</strong> option in order to change this setting:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">sched-priority</span> <span class="o">=</span> <span class="s">high:50 medium:30 low:20</span>
</pre></div>
</div>
<p>When the number of events waiting to be processed exceeds the defined amount of reserved memory (default is 1 Megabyte), <strong>Prelude Manager</strong> will start storing events on disk:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">sched-buffer-size</span> <span class="o">=</span> <span class="s">1M</span>
</pre></div>
</div>
</div>
<div class="section" id="options-tls">
<h3>TLS options<a class="headerlink" href="#options-tls" title="Permalink to this headline">¶</a></h3>
<p>Refer to the section <span class="xref std std-ref">Client/Manager configuration file: client.conf</span> for TLS option.</p>
<p>Refer to the section <span class="xref std std-ref">TLS Client/Manager connection: tls.conf</span> to customize the parameters of Diffie Hellman key exchange.</p>
</div>
<div class="section" id="options-de-relaying">
<h3>Relaying setting<a class="headerlink" href="#options-de-relaying" title="Permalink to this headline">¶</a></h3>
<p>If you want this Manager to retrieve messages from another Manager (useful if the other Manager is located within a DMZ):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">&lt;IP address&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">10.0.0.54</span>
</pre></div>
</div>
<p><strong>Prelude Manager</strong> will be connected to <em>10.0.0.54</em> to retrieve events from this host.</p>
<p>You can use booleans in order to specify more complex connections.</p>
<p>The following table is a recap of boolean operators usage:</p>
<table border="1" class="docutils" id="relaying-configuration-with-boolean-operators">
<caption><span class="caption-text">Relaying configuration with boolean operators</span><a class="headerlink" href="#relaying-configuration-with-boolean-operators" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Boolean operator</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>||</td>
<td>OR operator: selects only a host among several in order of priority.</td>
</tr>
<tr class="row-odd"><td>&amp;&amp;</td>
<td>AND operator: selects all hosts at the same time</td>
</tr>
<tr class="row-even"><td>|| and &amp;&amp;</td>
<td>Selects the hosts in order of priority</td>
</tr>
</tbody>
</table>
<p>Using the AND operator:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">x.x.x.x &amp;&amp; y.y.y.y</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">10.0.0.60 &amp;&amp; 10.0.0.64</span>
</pre></div>
</div>
<p><strong>Prelude Manager</strong> will be connected to both <em>10.0.0.60</em> and <em>10.0.0.64</em> host to retrieve events from them. If the connection to one of the hosts fails, the relaying will be ineffective.</p>
<p>Using the OR operator:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">x.x.x.x || y.y.y.y</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">10.0.0.60 || 10.0.0.64</span>
</pre></div>
</div>
<p><strong>Prelude Manager</strong> will connect to <em>10.0.0.60</em> to retrieve events from this host or <em>10.0.0.64*if *10.0.0.60</em> goes down.</p>
<p>Using both AND and OR operators:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">x.x.x.x || y.y.y.y &amp;&amp; z.z.z.z</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">child-managers</span> <span class="o">=</span> <span class="s">10.0.0.56 || 10.0.0.60 &amp;&amp; 10.0.0.64</span>
</pre></div>
</div>
<p>This mean <strong>Prelude Manager</strong> will connect to <em>10.0.0.56</em> or, if it fails, on <em>10.0.0.60</em> and <em>10.0.0.64</em>. If one of the two hosts in the “AND” expression fails, the relaying will be ineffective.</p>
<p>Refer to the section <span class="xref std std-ref">Plugins configuration</span> for parent managers configuration.</p>
</div>
<div class="section" id="protection-contre-de-possibles-defaillances">
<h3>Protection against possible failures<a class="headerlink" href="#protection-contre-de-possibles-defaillances" title="Permalink to this headline">¶</a></h3>
<p>Under certain conditions, you might want to activate failover for a given reporting plugin (as of the time of writing, only the <strong>db</strong> reporting plugin supports it). Failover is a <strong>Prelude Manager</strong> feature allowing storage of alerts in case the reporting plugin fails.</p>
<p>This is especially useful when the reporting plugin relies on another program (example: <strong>database</strong>).</p>
<p>If the protected reporting plugin fails for any reason to process the message, the failover subsystem will backup it as well as any future messages. It then will periodically try to re-initialize the plugin, and process any backed up messages.</p>
<p>As an example, if you activate report plugins failover for the <strong>db</strong> plugin, and then you stop the underlying database, messages will be saved and processed when the database will be restarted.</p>
<p>You might use this option multiple times for different plugins.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">failover</span> <span class="o">=</span> <span class="s">&lt;nom_du_plugin&gt;</span>
</pre></div>
</div>
<p>Example from the configuration file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">failover</span> <span class="o">=</span> <span class="s">db</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is not necessary to activate failover for the <strong>relaying</strong> plugins since the internal subsystem for this plugin will always failover in case of failure.</p>
</div>
</div>
<div class="section" id="configuration-des-plugins-de-prelude-manager">
<h3>Prelude Manager plugins configuration<a class="headerlink" href="#configuration-des-plugins-de-prelude-manager" title="Permalink to this headline">¶</a></h3>
<p><strong>Prelude Manager</strong> provides three plugins categories in order to carry out different actions:</p>
<ul class="simple">
<li>Normalization plugins;</li>
<li>Reporting plugins;</li>
<li>Filtering plugins.</li>
</ul>
<div class="section" id="configuration-des-plugins-de-normalisation">
<h4>Normalization plugins configuration<a class="headerlink" href="#configuration-des-plugins-de-normalisation" title="Permalink to this headline">¶</a></h4>
<p>For each incoming event, <strong>Prelude Manager</strong> will run a number of normalization routines: sanitize address, services information, etc.</p>
<div class="section" id="section-normalize">
<h5>[normalize] section<a class="headerlink" href="#section-normalize" title="Permalink to this headline">¶</a></h5>
<p>When the normalizer sees an incoming IPv4 mapped IPv6 address, the default behavior is to map it back to raw IPv4. For example, ::ffff:192.168.0.1 will be mapped back to 192.168.0.1</p>
<p>If you do not want IPv4 mapped IPv6 addresses, un-comment the following option:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">keep-ipv4-mapped-ipv6</span>
</pre></div>
</div>
<p>Alternatively, if you wish for any input IPv4 addresses to be converted to IPv6, un-comment the following option:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ipv6-only</span>
</pre></div>
</div>
<p><strong>Prelude Manager</strong> normalizer can add geolocation information to events when <code class="xref py py-mod docutils literal notranslate"><span class="pre">libmaxminddb</span></code> support is enabled, and the path to the maxminddb database is provided:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">geoip-database</span> <span class="o">=</span> <span class="s">/path/to/geoip_mmdb_file</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-des-plugins-de-reporting">
<h4>Reporting plugins configuration<a class="headerlink" href="#configuration-des-plugins-de-reporting" title="Permalink to this headline">¶</a></h4>
<p>Once an event has been normalized, <strong>Prelude Manager</strong> uses reporting plugins to export this IDMEF event into various output formats.</p>
<p>A same event can be exported through several plugins (for instance, database insertion and email sending), even through several instances of the same plugin (for instance, insertion in two databases), but won’t be exported several times through the same instance of a plugin.</p>
<p>A number of reporting plugins are available:</p>
<table border="1" class="docutils" id="available-reporting-plugins">
<caption><span class="caption-text">Available reporting plugins</span><a class="headerlink" href="#available-reporting-plugins" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Plugin name</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>relaying</td>
<td>A plugin relaying alerts to other managers</td>
</tr>
<tr class="row-odd"><td>db</td>
<td>A database plugin (MySQL, PostgreSQL, SQLite)</td>
</tr>
<tr class="row-even"><td>xmlmod</td>
<td>An XML reporting plugin</td>
</tr>
<tr class="row-odd"><td>debug</td>
<td>Allow to report alerts as text in a file, or to dump these alerts to stderr</td>
</tr>
<tr class="row-even"><td>textmod</td>
<td>A text reporting plugin</td>
</tr>
<tr class="row-odd"><td>smtp</td>
<td>Send textual alert through your SMTP server</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Check the <strong class="command">prelude-manager --help</strong> output for others.</p>
</div>
<div class="section" id="section-relaying">
<h5>[relaying] section<a class="headerlink" href="#section-relaying" title="Permalink to this headline">¶</a></h5>
<p><strong>Prelude Manager</strong> can act as a relay to another Manager by using the <strong>relaying</strong> plugin. Relaying managers control a set of analyzers, and relay alerts and messages received from these analyzers to another parent manager. This is a very useful feature when a network is divided into sub-networks.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">parent-managers</span> <span class="o">=</span> <span class="s">&lt;Adresse IP&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">parent-managers</span> <span class="o">=</span> <span class="s">172.25.104.56</span>
</pre></div>
</div>
<p>Started this way, <strong>Prelude Manager</strong> will connect to the specified parent manager localized by the <em>172.25.104.56</em> IP address.</p>
<p>You can use a boolean expression, with “AND” and “OR” operators.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">parent-managers</span> <span class="o">=</span> <span class="s">x.x.x.x || y.y.y.y &amp;&amp; z.z.z.z</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">parent-managers</span> <span class="o">=</span> <span class="s">10.0.0.56 || 10.0.0.60 &amp;&amp; 10.0.0.64</span>
</pre></div>
</div>
</div>
<div class="section" id="section-db">
<h5>[db] section<a class="headerlink" href="#section-db" title="Permalink to this headline">¶</a></h5>
<p>In order for <strong>Prelude Manager</strong> to report to a database, you need to use the db reporting plugin. Additionally, you need to provide this plugin with several arguments:</p>
<table border="1" class="docutils" id="options-of-the-db-reporting-plugin">
<caption><span class="caption-text">Options of the db reporting plugin</span><a class="headerlink" href="#options-of-the-db-reporting-plugin" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td>Type of database (mysql, pgsql or sqlite)</td>
</tr>
<tr class="row-odd"><td>file</td>
<td>only use for SQLite database. Sets path giving access to the database file</td>
</tr>
<tr class="row-even"><td>host</td>
<td>Hostname where the database is listening on (default is localhost)</td>
</tr>
<tr class="row-odd"><td>port</td>
<td>Port where the database is listening on, if applicable</td>
</tr>
<tr class="row-even"><td>name</td>
<td>Name of the database to use</td>
</tr>
<tr class="row-odd"><td>user</td>
<td>Username to use in order to connect to this database</td>
</tr>
<tr class="row-even"><td>pass</td>
<td>Password to use in order to connect to this database.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you use SQLite database, you need to initialize only two variables, which are <strong>type</strong> and <strong>file</strong>. MySQL and PostgreSQL don’t use the <strong>file</strong> variable.</p>
</div>
<p>Default configuration file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[db]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">&lt;database type : mysql | pgsql | sqlite3&gt;</span>
<span class="c1">#file = &lt;path/to/dbfile/idmef.sql&gt;</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">&lt;host of the database&gt;</span>
<span class="na">port</span> <span class="o">=</span> <span class="s">&lt;port of the database if necessary&gt;</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">&lt;database name&gt;</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">&lt;database username for the authentication&gt;</span>
<span class="na">pass</span> <span class="o">=</span> <span class="s">&lt;password associated with the username&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[db]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">mysql</span>
<span class="c1">#file = /var/lib/sqlite/sqlite-prelude.db</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">localhost</span>
<span class="na">port</span> <span class="o">=</span> <span class="s">3306</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">prelude</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">prelude</span>
<span class="na">pass</span> <span class="o">=</span> <span class="s">prelude</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You might want to store alerts in case the <strong>db</strong> reporting plugin fails. Refer to the section <span class="xref std std-ref">Protection against possible failures</span></p>
</div>
</div>
<div class="section" id="section-xmlmod">
<h5>[XmlMod] section<a class="headerlink" href="#section-xmlmod" title="Permalink to this headline">¶</a></h5>
<p>The <strong>Xmlmod</strong> plugin allows to report alerts as IDMEF XML in a file, or to dump these alerts to <em>/dev/stdout</em>. The default behavior is to write output to <em>/dev/stdout</em>.</p>
<p>Disable output file buffering. Uncomment the following option will prevent XML alerts to be truncated and thus make real-time parsing easier:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">disable-buffering</span>
</pre></div>
</div>
<p>Uncomment the following option will tell <strong>Xmlmod</strong> to check generated XML against IDMEF DTD:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">validate</span>
</pre></div>
</div>
<p>The <strong>format</strong> option tells Xmlmod to produce a pretty, human readable XML output:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">format</span>
</pre></div>
</div>
<p><em>/dev/stdout</em> value displays alerts on standard output:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">logfile</span> <span class="o">=</span> <span class="s">/dev/stdout</span>
</pre></div>
</div>
<p>File in which alerts will be generated in xml format:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">logfile</span> <span class="o">=</span> <span class="s">/var/log/prelude/prelude-xml.log</span>
</pre></div>
</div>
<p>Example of a <em>prelude-xml.log</em> file containing a heartbeat under XML format:</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;IDMEF-Message&gt;</span>
  <span class="nt">&lt;Heartbeat&gt;</span>
    <span class="nt">&lt;Analyzer</span> <span class="na">analyzerid=</span><span class="s">&quot;2042155273290843&quot;</span> <span class="na">name=</span><span class="s">&quot;prelude-manager&quot;</span>
<span class="na">manufacturer=</span><span class="s">&quot;http://www.prelude-siem.com&quot;</span> <span class="na">model=</span><span class="s">&quot;Prelude Manager&quot;</span> <span class="na">version=</span><span class="s">&quot;4.0.0&quot;</span>
<span class="na">class=</span><span class="s">&quot;Concentrator&quot;</span> <span class="na">ostype=</span><span class="s">&quot;Linux&quot;</span> <span class="na">osversion=</span><span class="s">&quot;4.9.10-200.fc25.x86_64&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Process&gt;</span>
        <span class="nt">&lt;name&gt;</span>prelude-manager<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;pid&gt;</span>8116<span class="nt">&lt;/pid&gt;</span>
        <span class="nt">&lt;path&gt;</span>/usr/bin/prelude-manager<span class="nt">&lt;/path&gt;</span>
      <span class="nt">&lt;/Process&gt;</span>
    <span class="nt">&lt;/Analyzer&gt;</span>
    <span class="nt">&lt;CreateTime</span> <span class="na">ntpstamp=</span><span class="s">&quot;0xd765276a.0x53251000&quot;</span><span class="nt">&gt;</span>2017-02-24T11:04:26.324784+02:00<span class="nt">&lt;/CreateTime&gt;</span>
    <span class="nt">&lt;AdditionalData</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">meaning=</span><span class="s">&quot;Analyzer status&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;string&gt;</span>starting<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/AdditionalData&gt;</span>
    <span class="nt">&lt;AdditionalData</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">meaning=</span><span class="s">&quot;Analyzer SHA1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;string&gt;</span>bc0db58a488d850a0b29a678fc1df62db14d74e3<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/AdditionalData&gt;</span>
    <span class="nt">&lt;/Heartbeat&gt;</span>
<span class="nt">&lt;/IDMEF-Message&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="section-debug">
<h5>[Debug] section<a class="headerlink" href="#section-debug" title="Permalink to this headline">¶</a></h5>
<p>The <strong>Debug</strong> plugin allows to report alert as text in a file, or to dump these alerts to standard output. The default behavior is to write on the standard output:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">logfile</span> <span class="o">=</span> <span class="s">/dev/stdout</span>
</pre></div>
</div>
<p>Report alerts as text in a file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">logfile</span> <span class="o">=</span> <span class="s">/var/log/prelude/prelude-debug.log</span>
</pre></div>
</div>
<p>You can specify the name of the IDMEF object to print (you might select multiple objects). If no object is provided, ‘Debug’ will print out the entire message.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">object</span> <span class="o">=</span> <span class="s">alert.classification.text, alert.source(0).node.address(0).address</span>
</pre></div>
</div>
</div>
<div class="section" id="section-textmod">
<h5>[TextMod] section<a class="headerlink" href="#section-textmod" title="Permalink to this headline">¶</a></h5>
<p>The <strong>TextMod</strong> plugin allows to report alerts as text in a file, or to dump these alerts on the standard output. The default behavior is to write on the standard output.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">logfile</span> <span class="o">=</span> <span class="s">/dev/stdout</span>
<span class="na">logfile</span> <span class="o">=</span> <span class="s">/var/log/prelude/prelude-text.log</span>
</pre></div>
</div>
<p>Example of text file generated:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>********************************************************************************
* Alert: ident=8aca6390-fc52-11e3-8eff
* Classification text: Remote Login
*
* Creation time: 0xd7552147.0xba79a000 (2017-02-24 12:21:59.728418+02:00)
* Detection time: 0xd755212b.0x00000000 (2017-02-24 12:21:31.0+02:00)
* Analyzer time: 0xd7552147.0xba7bd000 (2017-02-24 12:21:59.728452+02:00)
* Analyzer ID: 2042155273290843
* Analyzer name: prelude-manager
* Analyzer model: Prelude Manager
* Analyzer version: 4.0.0
* Analyzer class: Concentrator
* Analyzer manufacturer: http://www.prelude-siem.com
* Analyzer OS type: Linux
* Analyzer OS version: 4.9.10-200.fc25.x86_64
* Process: pid=5633 name=prelude-manager path=/usr/bin/prelude-manager
* Analyzer ID: 1779818670852139
* Analyzer name: prelude-lml
* Analyzer model: Prelude LML
* Analyzer version: 4.0.0
* Analyzer class: Log Analyzer
* Analyzer manufacturer: http://www.prelude-siem.com
* Analyzer OS type: Linux
* Analyzer OS version: 4.9.10-200.fc25.x86_64
* Process: pid=7710 name=prelude-lml path=/usr/bin/prelude-lml
* Analyzer name: sshd
* Analyzer class: Authentication
* Analyzer manufacturer: OpenSSH
* Node[unknown]: name:preldue-doc
* Process: pid=5655 name=sshd
</pre></div>
</div>
</div>
<div class="section" id="section-script">
<h5>[script] section<a class="headerlink" href="#section-script" title="Permalink to this headline">¶</a></h5>
<p>The <strong>script</strong> plugin allows to execute commands depending on the received alerts. If an IDMEF path is prefixed by a <em>$</em> symbol, it will be replaced by the corresponding value in the alert.</p>
<ul class="simple">
<li><strong>command</strong>: Path of the script to be executed</li>
</ul>
<p><em>Basic configuration example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[script]</span>
<span class="na">command</span> <span class="o">=</span> <span class="s">/bin/echo $alert.classification.text</span>
</pre></div>
</div>
<p>The error output of the script is located in <code class="file docutils literal notranslate"><span class="pre">/var/log/messages</span></code>.</p>
</div>
<div class="section" id="section-smtp">
<h5>[smtp] section<a class="headerlink" href="#section-smtp" title="Permalink to this headline">¶</a></h5>
<p>The <strong>SMTP</strong> plugin provides the ability to send textual alerts via e-mail using three options:</p>
<ul class="simple">
<li><strong>sender</strong>: e-mail sender address;</li>
<li><strong>recipients:</strong> e-mail recipient address;</li>
<li><strong>smtp-server</strong>: SMTP server address.</li>
</ul>
<p><em>Basic configuration example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[smtp]</span>
<span class="na">sender</span> <span class="o">=</span> <span class="s">prelude@myhostname</span>
<span class="na">recipients</span> <span class="o">=</span> <span class="s">recipient1@hostname, recipient2@hostname</span>
<span class="na">smtp-server</span> <span class="o">=</span> <span class="s">localhost</span>
</pre></div>
</div>
<p>By default, the <strong>SMTP</strong> plugin sends an e-mail containing the whole IDMEF event. If you wish to send a subset of the information, you may customize the content of the generated e-mail through several options:</p>
<p>You can define a specific subject to use with e-mail notification. The subject can include information from the event using IDMEF path.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">subject</span> <span class="o">=</span> <span class="s">Alerte : $alert.classification.text</span>
</pre></div>
</div>
<p>You can define a specific message body to use for e-mail notification. As with the “subject” option, the template can include information from the event using IDMEF path.</p>
<p>Additionally, you can provide a template for the message body of the e-mail notification. As for the “subject” option, the template can include information gathered from the event using IDMEF path.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">template</span> <span class="o">=</span> <span class="s">/chemin/vers/mon/template</span>
</pre></div>
</div>
<p>A template example is available in:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">template</span> <span class="o">=</span> <span class="s">/usr/share/doc/prelude-manager(-pro)/smtp/template.example</span>
</pre></div>
</div>
<p><em>Template file example:</em></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>***
* http://127.0.0.1:8000/alerts/alerts/AlertSummary?analyzerid=$alert.analyzer(-1).analyzer
id&amp;messageid=$alert.messageid
* $alert.classification.text : $alert.source(0).node.address(0).address -&gt;
$alert.target(0).node.address(0).address
*
* Create Time: $alert.create_time
* Sensor: $alert.analyzer(-1).name - $alert.analyzer(-1).node.name -
$alert.analyzer(-1).node.address(0).address
*
#if $alert.correlation_alert.name
* CorrelationAlert name: $alert.correlation_alert.name
#end if
***
</pre></div>
</div>
<p>Explanation: when an alert is received, the <strong>SMTP</strong> plugin retrieves the information from the alert to include it in the generated message.</p>
<p>The mechanism also works with correlation alerts, but other options need to be filled in. A correlation alert containing several alerts already received, the <strong>SMTP</strong> plugin must connect to the alert database to retrieve the information of the simple alerts in order to include them in the body of the mail:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dbtype</span> <span class="o">=</span> <span class="s">&lt;database type : mysql | pgsql | sqlite3&gt;</span>
<span class="na">dbhost</span> <span class="o">=</span> <span class="s">&lt;host of the database&gt;</span>
<span class="na">dbname</span> <span class="o">=</span> <span class="s">&lt;database name&gt;</span>
<span class="na">dbuser</span> <span class="o">=</span> <span class="s">&lt;database username for the authentication&gt;</span>
<span class="na">dbpass</span> <span class="o">=</span> <span class="s">&lt;password associated with the username&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dbtype</span> <span class="o">=</span> <span class="s">mysql</span>
<span class="na">dbhost</span> <span class="o">=</span> <span class="s">localhost</span>
<span class="na">dbname</span> <span class="o">=</span> <span class="s">prelude</span>
<span class="na">dbuser</span> <span class="o">=</span> <span class="s">prelude</span>
<span class="na">dbpass</span> <span class="o">=</span> <span class="s">passwd</span>
</pre></div>
</div>
<p>If you have specified your database settings above, you can also use the correlated-alert-template option, which is like the “template” option but is specific to correlated alerts retrieved from database. Commented by default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">correlated-alert-template</span> <span class="o">=</span> <span class="s">/path/to/my/template</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">correlated-alert-template</span> <span class="o">=</span> <span class="s">/usr/share/doc/prelude-manager(-pro)/smtp/template.example</span>
</pre></div>
</div>
</div>
<div class="section" id="section-snmp">
<h5>[smtp] section<a class="headerlink" href="#section-snmp" title="Permalink to this headline">¶</a></h5>
<p>The <strong>SNMP</strong> plugin provides the ability to send textual alerts via SNMP using these options:</p>
<table border="1" class="docutils" id="snmp-plugin-options">
<caption><span class="caption-text"><strong>SNMP</strong> plugin options</span><a class="headerlink" href="#snmp-plugin-options" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>traphost</td>
<td>Trap recipient. A specific port may be given using the suffix <em>:port</em>, eg.*localhost:16162*. To force the use of an IPv6 transport, add a <em>udp6:</em> prefix and put IPv6 addresses between brackets, e.g.: <em>udp6:[::1]</em>.</td>
</tr>
<tr class="row-odd"><td>version</td>
<td>Protocol version to use (either v1, v2c or v3)</td>
</tr>
<tr class="row-even"><td>community</td>
<td>SNMP community (v1/v2c only)</td>
</tr>
<tr class="row-odd"><td>sec-name</td>
<td>Security username</td>
</tr>
<tr class="row-even"><td>sec-level</td>
<td>Security level (either noAuthNoPriv, authNoPriv or authPriv)</td>
</tr>
<tr class="row-odd"><td>auth-protocol</td>
<td>Authentication protocol (either MD5 or SHA1)</td>
</tr>
<tr class="row-even"><td>auth-key</td>
<td>Authentication passphrase</td>
</tr>
<tr class="row-odd"><td>priv-protocol</td>
<td>Privacy protocol (either DES or AES)</td>
</tr>
<tr class="row-even"><td>priv-key</td>
<td>Privacy passphrase</td>
</tr>
<tr class="row-odd"><td>engineid</td>
<td>Identifiant du moteur SNMP, en hexadécimal.
L’identifiant doit être composé de 5 à 32 caractères, et être unique au sein du réseau.
Si cette option n’est pas renseigné, un identifiant sera généré aléatoirement à chaque démarrage du manager.</td>
</tr>
</tbody>
</table>
<p><em>Configuration example</em>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[snmp]</span>
<span class="na">traphost</span> <span class="o">=</span> <span class="s">localhost</span>
<span class="na">version</span> <span class="o">=</span> <span class="s">v3</span>
<span class="na">community</span> <span class="o">=</span> <span class="s">public</span>
<span class="na">sec-name</span> <span class="o">=</span> <span class="s">sec-name-not-configured</span>
<span class="na">sec-level</span> <span class="o">=</span> <span class="s">authPriv</span>
<span class="na">auth-protocol</span> <span class="o">=</span> <span class="s">SHA1</span>
<span class="na">auth-key</span> <span class="o">=</span> <span class="s">snmp-authentication-key</span>
<span class="na">priv-protocol</span> <span class="o">=</span> <span class="s">AES</span>
<span class="na">priv-key</span> <span class="o">=</span> <span class="s">snmp-privacy-key</span>
<span class="na">engineid</span> <span class="o">=</span> <span class="s">0x1234567890</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-des-plugins-de-filtrage">
<h4>Filtering plugins configuration<a class="headerlink" href="#configuration-des-plugins-de-filtrage" title="Permalink to this headline">¶</a></h4>
<p>Two filtering plugins are available:</p>
<ul class="simple">
<li><strong>IDMEF Criteria Filtering Plugin</strong>: Filtering events;</li>
<li><strong>Thresholding Filtering Plugin</strong>: Event suppression and thresholding.</li>
</ul>
<p>For further explanations on IDMEF-Criteria and IDMEF-Path refer to <span class="xref std std-ref">Annex: IDMEF criteria and paths</span>.</p>
<div class="section" id="section-idmef-criteria">
<h5>[idmef-criteria] section<a class="headerlink" href="#section-idmef-criteria" title="Permalink to this headline">¶</a></h5>
<p>The idmef-criteria filtering plugin allows you to filter events based on specific IDMEF-Criteria :</p>
<p>A filtering rule (i.e. an instance of the plugin) might be used to decide whether a specific action should be taken:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">rule</span> <span class="o">=</span> <span class="s">&lt;IDMEF criteria&gt;</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">&lt;plugin name&gt;</span>
</pre></div>
</div>
<p>The <strong>hook</strong> option can take the following values:</p>
<ul class="simple">
<li>either the name of a reporting plugin, for instance “db”;</li>
<li>the name and the instance of a reporting plugin, for instance “smtp[myinstance]”;</li>
<li>or the special value “reporting” explained below.</li>
</ul>
<p>The <strong>rule</strong> option takes an IDMEF criterion.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[idmef-criteria]</span>
<span class="na">rule</span> <span class="o">=</span> <span class="s">alert.classification.text == &#39;User login successful&#39; &amp;&amp; alert.assessment.impact.severity == high</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">relaying[default]</span>
</pre></div>
</div>
<p>This configuration will forward any event matching the defined criteria to  another manager. There may be several relaying managers, that’s why the instance name is defined here.</p>
<p>The <strong>rule</strong> argument might also be a filename containing the rules:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">rule</span> <span class="o">=</span> <span class="s">/path/to/myfile.rule</span>
</pre></div>
</div>
</div>
<div class="section" id="section-thresholding">
<h5>[thresholding] section<a class="headerlink" href="#section-thresholding" title="Permalink to this headline">¶</a></h5>
<p>The <strong>thresholding</strong> plugin allows suppressing events similar to previously received events, based on their IDMEF values.</p>
<p><em>Example from the configuration file:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">path</span> <span class="o">=</span> <span class="s">alert.classification.text, alert.source.node.address.address</span>
<span class="na">limit</span> <span class="o">=</span> <span class="s">3600</span>
<span class="na">count</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">relaying[default]</span>
</pre></div>
</div>
<p>This configuration will relay one event with a given <em>alert.classification.text, alert.source.node.address.address</em> value combination during 3600 seconds. Further events with the same combination will be suppressed during this period.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">path</span> <span class="o">=</span> <span class="s">alert.classification.text, alert.source.node.address.address</span>
<span class="na">threshold</span> <span class="o">=</span> <span class="s">3600</span>
<span class="na">count</span> <span class="o">=</span> <span class="s">10</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">relaying[default]</span>
</pre></div>
</div>
<p>This configuration will relay every tenth event with the same <em>alert.classification.text, alert.source.node.address.address</em> value combination during 3600 seconds.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Limit and threshold might be combined, allowing to setup a limit as soon as the first threshold is reached.</p>
</div>
<p><strong>Application of filtering rules in regards to reporting</strong></p>
<p>It is possible to chain filtering rules by using hooks, in which case the condition of a filtering rule will be verified if its own condition is verified, as well as at least one of the rules “hooked” on it.</p>
<p>The use of a reporting plugin for a given event depends on the following rules:</p>
<ul class="simple">
<li>if a filtering rule declared a hook on the special value “reporting” and if its condition is not verified, then the event is ignored;</li>
<li>if no filtering rule declared a hook on the reporting plugin, then the event will be processed by the plugin;</li>
<li>if at least one filtering rule having declared a hook on the reporting plugin is verified, then the event will be processed by the plugin; otherwise, it will be ignored.</li>
</ul>
<p><strong>Advanced configuration example:</strong></p>
<p>Declaring several plugins and chaining them allows you to create more complex filtering capabilities. In the example below, filtering, thresholding and SMTP plugins are combined to enhance your reporting.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[smtp]</span>
<span class="na">sender</span> <span class="o">=</span> <span class="s">prelude@mycompanyname.com</span>
<span class="na">recipients</span> <span class="o">=</span> <span class="s">me@mycompanyname.com</span>
<span class="na">smtp-server</span> <span class="o">=</span> <span class="s">mailserver.mycompanyname.com</span>

<span class="k">[idmef-criteria]</span>
<span class="na">rule</span> <span class="o">=</span> <span class="s">alert.classification.text == &#39;Login Attempt&#39;</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">smtp</span>

<span class="k">[idmef-criteria=sudotest]</span>
<span class="na">rule</span> <span class="o">=</span> <span class="s">alert.classification.text == &#39;SUDO Command Executed&#39;</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">smtp</span>

<span class="k">[thresholding]</span>
<span class="na">path</span> <span class="o">=</span> <span class="s">alert.classification.text</span>
<span class="na">limit</span> <span class="o">=</span> <span class="s">60</span>
<span class="na">count</span> <span class="o">=</span> <span class="s">10</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">reporting</span>

<span class="k">[thresholding=sudotest]</span>
<span class="na">path</span> <span class="o">=</span> <span class="s">alert.classification.text, alert.target(0).node.address(0).address</span>
<span class="na">limit</span> <span class="o">=</span> <span class="s">3600</span>
<span class="na">count</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">idmef-criteria[sudotest]</span>
</pre></div>
</div>
<p>In the example above, five plugin instances have been declared:</p>
<ul class="simple">
<li>one instance of the <strong>smtp</strong> reporting plugin, tasked to send events by email;</li>
<li>two instances of the <strong>idmef-criteria</strong> filtering plugin, tasked to ignore the events which don’t match the given classifications;</li>
<li>two instances of the <strong>thresholding</strong> filtering plugin, tasked to limit the number of events to process.</li>
</ul>
<p>At the reception of an IDMEF event, an email will be generated if all the following conditions are met:</p>
<ul class="simple">
<li>its classification is “Login Attempt” or “SUDO Command Executed”;</li>
<li>the threshold of 10 alerts having the same classification has not been reached during the last minute;</li>
<li>if the classification is “SUDO Command Executed”, no alert with the same classification and target address has been received for the last hour.</li>
</ul>
<p>In this example, the stacking of plugins allowed us to filter on a certain IDMEF alert type, to send an email in case of a match, while avoiding sending too many email in certain particular cases.</p>
</div>
</div>
</div>
</div>
<div class="section" id="configuration-de-prelude-lml">
<h2>Prelude LML configuration<a class="headerlink" href="#configuration-de-prelude-lml" title="Permalink to this headline">¶</a></h2>
<p>Multiple log files can be used with different formatting. You can configure <strong>Prelude LML</strong> so that it know how to handle each log format.</p>
<p>This is done using a <em>[format]</em> section, in the <strong>Prelude LML</strong> configuration file: <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/prelude-lml.conf</span></code>.</p>
<p>The configuration file of <strong>Prelude LML</strong> begins by include the configuration file of IDMEF.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">include</span> <span class="o">=</span> <span class="s">/etc/prelude/default/idmef-client.conf</span>
</pre></div>
</div>
<p>This file includes both files <em>global.conf</em> and <em>client.conf</em> located respectively in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/global.conf</span></code> and <code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/client.conf</span></code>. It is often used as the template by clients that need to connect to a <strong>Prelude Manager</strong>. Then, there is several sections to configure.</p>
<div class="section" id="id3">
<h3>[prelude] section<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Address where the <strong>Prelude Manager</strong> server is listening on. If value is <em>127.0.0.1</em>, the connection will occur through a UNIX socket.</p>
<p>This entry is commented. The default is to use the entry located in the <strong>Prelude</strong> system wide clients.conf (<code class="file docutils literal notranslate"><span class="pre">/etc/prelude/default/clients.conf</span></code>). You may overwrite the default address for this sensor by uncommenting this entry.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">server-addr</span> <span class="o">=</span> <span class="s">127.0.0.1</span>
</pre></div>
</div>
</div>
<div class="section" id="section-format">
<h3>[normalize] section<a class="headerlink" href="#section-format" title="Permalink to this headline">¶</a></h3>
<p>First thing to do is to define the <strong>prefix-regex</strong> and <strong>time-format</strong> corresponding to the log message within a <strong>[format]</strong> section. If not specified, the default syslog format define in <span class="target" id="index-4"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc5424.html"><strong>RFC 5424</strong></a> will be used.</p>
<p><em>Example configuration for syslog output:</em></p>
<ul class="simple">
<li>Each <strong>[format]</strong> section might have several log source entries: <strong>file</strong>, <strong>udp-server</strong>, <strong>tcp-server</strong> or <strong>tcp-tls-server</strong>;</li>
<li>If a log source is listed across different formats, then the first matching format for a given log source will be used.</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[format=syslog]</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%b %d %H:%M:%S&quot;</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^(?P&lt;timestamp&gt;.{15}) (?P&lt;hostname&gt;\S+) (?:(?P&lt;process&gt;\S+?): )?&quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/mylogfile</span>
<span class="na">udp-server</span> <span class="o">=</span> <span class="s">0.0.0.0:514</span>

<span class="k">[format=apache]</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%d/%b/%Y:%H:%M:%S&quot;</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^(?P&lt;hostname&gt;\S+) - - \[(?P&lt;timestamp&gt;.{20}) \+.{4}\] &quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/mylogfile</span>
<span class="na">udp-server</span> <span class="o">=</span> <span class="s">0.0.0.0:514</span>
</pre></div>
</div>
<p>The <em>[format]</em> section allows to define several options:</p>
<ul class="simple">
<li><a class="reference internal" href="#prefix-regex"><span class="std std-ref">prefix-regex</span></a>;</li>
<li><a class="reference internal" href="#time-format"><span class="std std-ref">time-format</span></a>;</li>
<li><a class="reference internal" href="#file"><span class="std std-ref">file</span></a>;</li>
<li><a class="reference internal" href="#charset"><span class="std std-ref">charset</span></a>;</li>
<li><a class="reference internal" href="#udp-server"><span class="std std-ref">udp-server</span></a>;</li>
<li><a class="reference internal" href="#tcp-server"><span class="std std-ref">tcp-server</span></a>;</li>
<li><a class="reference internal" href="#tcp-tls-server"><span class="std std-ref">tcp-ssl-server</span></a>;<ul>
<li>tls-mode;</li>
<li>tls-key-file;</li>
<li>tls-cert-file;</li>
<li>tls-ca-file;</li>
<li>tls-trusted-fingerprint;</li>
<li>tls-trusted-name;</li>
<li>tls-verify;</li>
</ul>
</li>
<li><a class="reference internal" href="#idmef-alter"><span class="std std-ref">idmef-alter</span></a>;</li>
<li><a class="reference internal" href="#idmef-alter-force"><span class="std std-ref">idmef-alter-force</span></a>.</li>
</ul>
<div class="section" id="prefix-regex">
<h4>prefix-regex<a class="headerlink" href="#prefix-regex" title="Permalink to this headline">¶</a></h4>
<p>This options tells to <strong>Prelude LML</strong> how to handle the log header. With this option, you can bind variable used by <strong>Prelude LML</strong> to fill specific fields in the generated IDMEF alert.</p>
<p>The <strong>prefix-regex</strong> variable should contain PCRE named sub patterns to pick out the information available in your syslog’s prefix.</p>
<p>The available field names are:</p>
<ul class="simple">
<li>hostname;</li>
<li>process;</li>
<li>pid;</li>
<li>timestamp.</li>
</ul>
<p>Here is an example of how it works. Use the following <strong>prefix-regex</strong>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^(?P&lt;timestamp&gt;.{15}) (?P&lt;hostname&gt;\S+) (?:(?P&lt;process&gt;\S+?)(?:\[(?P&lt;pid&gt;[0-9]+)\])?: )?&quot;</span>
</pre></div>
</div>
<p>With the following log entry:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Feb 27 14:14:03 prelude-doc emacs[4057]: file &#39;preludesiem-configuration&#39; saved
</pre></div>
</div>
<p>When <strong>Prelude LML</strong> parses this log entry using the <strong>prefix-regex</strong>, the <strong>timestamp</strong>,**hostname**, <strong>process</strong>, and <strong>pid</strong> variables will be set to the following values:</p>
<table border="1" class="docutils" id="prefix-regex-variables">
<caption><span class="caption-text"><strong>prefix-regex</strong> variables</span><a class="headerlink" href="#prefix-regex-variables" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Usage</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>timestamp</td>
<td>Bind to the Detect Time information of an IDMEF Alert</td>
<td>Feb 27 14:14:03</td>
</tr>
<tr class="row-odd"><td>hostname</td>
<td>Bind to the Target node information in an IDMEF Alert</td>
<td>prelude-doc</td>
</tr>
<tr class="row-even"><td>process</td>
<td>Bind to the Target process name in an IDMEF Alert</td>
<td>emacs</td>
</tr>
<tr class="row-odd"><td>pid</td>
<td>Bind to the Target process pid in an IDMEF Alert</td>
<td>4057</td>
</tr>
</tbody>
</table>
<p>Each of these values will be assigned in the relevant IDMEF fields of the generated alert.</p>
</div>
<div class="section" id="time-format">
<h4>time-format<a class="headerlink" href="#time-format" title="Permalink to this headline">¶</a></h4>
<p>This option should be set so that <strong>Prelude LML</strong> knows how the <em>timestamp</em> is defined in your log entry. This will be used to match the <em>timestamp</em> content defined through the <strong>prefix-regex</strong> option.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%b %d %H:%M:%S&quot;</span>
</pre></div>
</div>
<p>The following table shows all sequences and options you might use to configure <em>time-format</em>:</p>
<table border="1" class="docutils" id="descriptors-of-field-time-format">
<caption><span class="caption-text">Descriptors of field <strong>time-format</strong></span><a class="headerlink" href="#descriptors-of-field-time-format" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sequence</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%%</td>
<td>The % character</td>
</tr>
<tr class="row-odd"><td>%a or %A</td>
<td>The weekday name according to the current locale, in abbreviated form or the full name.</td>
</tr>
<tr class="row-even"><td>%b or %B or %h</td>
<td>The month name according to the current locale, in abbreviated form or the full name.</td>
</tr>
<tr class="row-odd"><td>%c</td>
<td>The date and time representation for the current locale.</td>
</tr>
<tr class="row-even"><td>%C</td>
<td>The century number (0-99).</td>
</tr>
<tr class="row-odd"><td>%d or %e</td>
<td>The day of month (1-31).</td>
</tr>
<tr class="row-even"><td>%D</td>
<td>Equivalent to %m/%d/%y. (This is the american style date, very confusing to non-americans, especially since %d/%m/%y is widely used in Europe. The ISO 8601 standard format is %Y-%m-%d.)</td>
</tr>
<tr class="row-odd"><td>%H</td>
<td>The hour (0-23).</td>
</tr>
<tr class="row-even"><td>%I</td>
<td>The hour on a 12-hour clock (1-12).</td>
</tr>
<tr class="row-odd"><td>%j</td>
<td>The day number in the year (1-366).</td>
</tr>
<tr class="row-even"><td>%</td>
<td>The month number (1-12).</td>
</tr>
<tr class="row-odd"><td>%M</td>
<td>The minute (0-59).</td>
</tr>
<tr class="row-even"><td>%n and %t</td>
<td>A whitespace</td>
</tr>
<tr class="row-odd"><td>%p</td>
<td>The locale’s equivalent of AM or PM. (Note: there may be none.)</td>
</tr>
<tr class="row-even"><td>%r</td>
<td>The 12-hour clock time (using the locale’s AM or PM). In the POSIX locale equivalent to %I:%M:%S %p. If t_fmt_ampm is empty in the LC_TIME part of the current locale then the behavior is undefined.</td>
</tr>
<tr class="row-odd"><td>%R</td>
<td>Equivalent to %H:%M.</td>
</tr>
<tr class="row-even"><td>%S</td>
<td>The second (0-60; 60 may occur for leap seconds; earlier also 61 was allowed).</td>
</tr>
<tr class="row-odd"><td>%T</td>
<td>Equivalent to %H:%M:%S.</td>
</tr>
<tr class="row-even"><td>%U</td>
<td>The week number with Sunday the first day of the week (0-53). The first Sunday of January is the first day of week 1.</td>
</tr>
<tr class="row-odd"><td>%w</td>
<td>The weekday number (0-6) with Sunday = 0.</td>
</tr>
<tr class="row-even"><td>%W</td>
<td>The week number with Monday the first day of the week (0-53). The first Monday of January is the first day of week 1.</td>
</tr>
<tr class="row-odd"><td>%x</td>
<td>The date, using the locale’s date format.</td>
</tr>
<tr class="row-even"><td>%X</td>
<td>The time, using the locale’s time format.</td>
</tr>
<tr class="row-odd"><td>%y</td>
<td>The year within century (0-99). When a century is not otherwise specified, values in the range 69-99 refer to years in the twentieth century (1969-1999); values in the range 00-68 refer to years in the twenty-first century (2000-2068).</td>
</tr>
<tr class="row-even"><td>%Y</td>
<td>The year, including century (for example, 1991).</td>
</tr>
</tbody>
</table>
<p>Some field descriptors can be modified by the <strong>E</strong> or <strong>O</strong> modifier characters to indicate that an alternative format or specification should be used. If the alternative format or specification does not exist in the current locale, the unmodified field descriptor isused.</p>
<p>The <strong>E</strong> modifier specifies that the input string may contain alternative locale-dependent versions of the date and time representation.</p>
<table border="1" class="docutils" id="descriptors-of-the-time-format-field-with-the-e-modifier">
<caption><span class="caption-text">Descriptors of the <strong>time-format</strong> field with the <strong>E</strong> modifier</span><a class="headerlink" href="#descriptors-of-the-time-format-field-with-the-e-modifier" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sequence</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%Ec</td>
<td>The locale’s alternative date and time representation.</td>
</tr>
<tr class="row-odd"><td>%EC</td>
<td>The name of the base year (period) in the locale’s alternative representation.</td>
</tr>
<tr class="row-even"><td>%Ex</td>
<td>The locale’s alternative date representation.</td>
</tr>
<tr class="row-odd"><td>%EX</td>
<td>The locale’s alternative time representation.</td>
</tr>
<tr class="row-even"><td>%Ey</td>
<td>The offset from %EC (year only) in the locale’s alternative representation.</td>
</tr>
<tr class="row-odd"><td>%EY</td>
<td>The full alternative year representation.</td>
</tr>
</tbody>
</table>
<p>The <strong>O</strong> modifier specifies that the numerical input may be in an alternative locale-dependent format.</p>
<table border="1" class="docutils" id="descriptors-of-the-time-format-field-with-the-o-modifier">
<caption><span class="caption-text">Descriptors of the <strong>time-format</strong> field with the <strong>O</strong> modifier</span><a class="headerlink" href="#descriptors-of-the-time-format-field-with-the-o-modifier" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sequence</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>%Od or %Oe</td>
<td>The day of the month using the locale’s alternative numeric symbols; leading zeros are permitted but not required.</td>
</tr>
<tr class="row-odd"><td>%OH</td>
<td>The hour (24-hour clock) using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-even"><td>%OI</td>
<td>The hour (12-hour clock) using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-odd"><td>%Om</td>
<td>The month using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-even"><td>%OM</td>
<td>The minutes using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-odd"><td>%OS</td>
<td>The seconds using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-even"><td>%OU</td>
<td>The week number of the year (Sunday as the first day of the week) using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-odd"><td>%Ow</td>
<td>The number of the weekday (Sunday=0) using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-even"><td>%OW</td>
<td>The week number of the year (Monday as the first day of the week) using the locale’s alternative numeric symbols.</td>
</tr>
<tr class="row-odd"><td>%Oy</td>
<td>The year (offset from %C) using the locale’s alternative numeric symbols.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <em>timestamp</em> variable is specific in that you have to specify an additional <strong>time-format</strong> option, so that LML is able to parse the time representation.</p>
</div>
</div>
<div class="section" id="file">
<h4>file<a class="headerlink" href="#file" title="Permalink to this headline">¶</a></h4>
<p>Specify a file to monitor, this option might be set several time if you want to monitor multiple files with this format.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/messages</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/auth.log</span>
</pre></div>
</div>
<p>Additionally, you can specify a pattern. <strong>Prelude LML</strong> will search all the pathnames matching pattern according to the rules used by the shell.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/*/*.log</span>
</pre></div>
</div>
</div>
<div class="section" id="udp-server">
<h4>udp-server<a class="headerlink" href="#udp-server" title="Permalink to this headline">¶</a></h4>
<p>Create a UDP server that is able to handle this format, and which listens to the specified address. The addressing used for <strong>udp-server</strong> is only ipv4.</p>
<p>This requires the configuration of rsyslog.conf file besides prelude-lml.conf</p>
<p><em>prelude-lml.conf</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">udp-server</span> <span class="o">=</span> <span class="s">127.0.0.1:2000</span>
</pre></div>
</div>
<p>We set a local IP address followed by a port number, that means syslog server in other words <strong>Prelude LML</strong> is listening on port number 2000.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The port used mustn’t be specific, however, it must be outside of the range [0-1024] if you execute <strong>Prelude LML</strong> as a non root user.</p>
</div>
<p><em>Example of a syslog server configuration:</em></p>
<p>The file rsyslog.conf:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*.* @10.0.0.54:2000
</pre></div>
</div>
<p>The hostname might be followed by a colon and the destination port number.</p>
<p>In the example, messages are forwarded via UDP to the machine addressed with <em>10.0.0.54</em>, the destination port is <em>2000</em>. The messages will not be compressed.</p>
<p>The following table is a brief summary of the rsyslog configuration file:</p>
<table border="1" class="docutils" id="important-data-for-rsyslog-configuration">
<caption><span class="caption-text">Important data for rsyslog configuration</span><a class="headerlink" href="#important-data-for-rsyslog-configuration" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>10.0.0.54</td>
<td>IP address</td>
</tr>
<tr class="row-odd"><td>2000</td>
<td>Port used (optional)</td>
</tr>
<tr class="row-even"><td><em>.</em></td>
<td>All messages for all priority levels</td>
</tr>
<tr class="row-odd"><td>&#64;</td>
<td>One &#64; character is use for udp</td>
</tr>
<tr class="row-even"><td>&#64;&#64;</td>
<td>Two &#64; characters is use for tcp</td>
</tr>
<tr class="row-odd"><td><em>.</em> &#64;127.0.0.1</td>
<td>This rule would redirect all messages to a remote host which the IP address is 10.0.0.54</td>
</tr>
</tbody>
</table>
<p>When you run <strong>Prelude LML</strong> you should see:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> prelude-lml
<span class="go">27 Feb 12:03:58 (process:27929) INFO: PCRE plugin loaded 661 rules.</span>
<span class="go">27 Feb 12:03:58 (process:27929) INFO: Listening for syslog message on 127.0.0.1:2000/udp.</span>
<span class="go">27 Feb 12:03:58 (process:27929) INFO: Connecting to 127.0.0.1:4690 prelude Manager server.</span>
<span class="go">27 Feb 12:03:58 (process:27929) INFO: TLS authentication succeed with Prelude Manager.</span>
<span class="go">27 Feb 12:03:58 (process:27929) WARNING: /var/log/httpd/access_log does not exist.</span>
</pre></div>
</div>
</div>
<div class="section" id="tcp-server">
<h4>tcp-server<a class="headerlink" href="#tcp-server" title="Permalink to this headline">¶</a></h4>
<p>Create a TCP server that is able to handle this source, and which listens to the specified address. The addressing used for <strong>tcp-server</strong> is only ipv4.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tcp-server</span> <span class="o">=</span> <span class="s">10.0.0.42</span>
</pre></div>
</div>
<p>The TCP server configuration is the same as UDP server. However, do not forget to put two characters <strong>&#64;</strong> instead of one.</p>
</div>
<div class="section" id="tcp-tls-server">
<h4>tcp-ssl-server<a class="headerlink" href="#tcp-tls-server" title="Permalink to this headline">¶</a></h4>
<p>This option creates a TCP/SSL server listening at the specified address. The addressing used for <strong>tcp-tls-server</strong> is only ipv4.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tcp-tls-server</span> <span class="o">=</span> <span class="s">10.0.0.43</span>
</pre></div>
</div>
<div class="section" id="modes-tls-disponibles">
<h5>Available TLS modes<a class="headerlink" href="#modes-tls-disponibles" title="Permalink to this headline">¶</a></h5>
<p>Two TLS modes are available:</p>
<ul class="simple">
<li><strong>x509</strong>: x509 based certificate authentication;</li>
<li><strong>anonymous</strong>: Anonymous TLS connection using ANON-ECDH or ANON-DH.</li>
</ul>
<p>These two modes can be combined, and the default value is <em>x509</em>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-mode</span> <span class="o">=</span> <span class="s">x509 anonymous</span>
</pre></div>
</div>
</div>
<div class="section" id="client-et-certificat">
<h5>Client and certificate<a class="headerlink" href="#client-et-certificat" title="Permalink to this headline">¶</a></h5>
<p>Several parameters have to be defined when TLS mode is used. These parameters concern the client key and the certificate files:</p>
<p>The client key parameter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-key-file</span> <span class="o">=</span> <span class="s">/chemin/vers/client.key</span>
</pre></div>
</div>
<p>The certificate file parameter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-cert-file</span> <span class="o">=</span> <span class="s">/chemin/vers/client.cert</span>
</pre></div>
</div>
<p>The certificate authority files parameter:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-ca-file</span> <span class="o">=</span> <span class="s">/chemin/vers/server.ca</span>
</pre></div>
</div>
</div>
<div class="section" id="option-de-verification-tls">
<h5>TLS verification option<a class="headerlink" href="#option-de-verification-tls" title="Permalink to this headline">¶</a></h5>
<p>When a list of trusted fingerprint and/or a list of trusted name is provided, the connecting client has to match one of the provided fingerprint or name, otherwise the connection will be refused.</p>
<p>The optional parameter below allows to define a trusted client fingerprint:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-trusted-fingerprint</span> <span class="o">=</span> <span class="s">SHA1:ae:8a:e5:97:66:2d:6d:cd:85:29:05:95:31:84:81:f1:27:3b:d1:73</span>
</pre></div>
</div>
<p>To define a list of trusted client fingerprints, the <strong>tls-trusted-fingerprint</strong> parameter must be defined several times.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-trusted-fingerprint</span> <span class="o">=</span> <span class="s">SHA1:ae:8a:e5:97:66:2d:6d:cd:85:29:05:95:31:84:81:f1:27:3b:d1:73</span>
<span class="na">tls-trusted-fingerprint</span> <span class="o">=</span> <span class="s">&lt;another fingerprint&gt;</span>
<span class="na">tls-trusted-fingerprint</span> <span class="o">=</span> <span class="s">&lt;another fingerprint&gt;</span>
</pre></div>
</div>
<p>If this option is used, then the connecting peers have to match one of the specified fingerprints. The SHA1 and MD5 format are accepted.</p>
<p>The optional parameter below allows to define a list of trusted client names:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-trusted-name</span> <span class="o">=</span> <span class="s">&lt;client name&gt;</span>
</pre></div>
</div>
<p>The value can takes into account wildcards, and the DNSName / IPAddress subject alternative name PKIX extension.</p>
<p>To define a list of trusted client names, the <strong>tls-trusted-name</strong> parameter must be defined several times.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-trusted-name</span> <span class="o">=</span> <span class="s">&lt;client name&gt;</span>
<span class="na">tls-trusted-name</span> <span class="o">=</span> <span class="s">&lt;another name&gt;</span>
<span class="na">tls-trusted-name</span> <span class="o">=</span> <span class="s">&lt;another name&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Both of these parameters can be used simultaneously.</p>
</div>
<p>The client certificate verification option can take two possible values:</p>
<ul class="simple">
<li><strong>client-cert-required</strong>: the client has to provide a valid certificate for the authentication to succeed;</li>
<li><strong>client-cert-optional:</strong> the client may connect without providing a valid x509 certificate.</li>
</ul>
<p>The value is set to <strong>client-cert-required</strong> by default. That means the client has to provide a valid certificate.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">tls-verify</span> <span class="o">=</span> <span class="s">client-cert-required</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="idmef-alter">
<h4>idmef-alter<a class="headerlink" href="#idmef-alter" title="Permalink to this headline">¶</a></h4>
<p><strong>Prelude LML</strong> allows you to include static values into events generated using a given format.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[format=syslog]</span>
<span class="na">idmef-alter</span> <span class="o">=</span> <span class="s">alert.analyzer(-1).node.location = my localization</span>
</pre></div>
</div>
<p>Using the example above, any events generated from a <em>syslog</em> format source will have the <em>alert.analyzer(-1).node.location</em> set to <em>my localization</em>, unless the path is already set. An analyzer is the emission source of an alert. It can be a service (webserver, PAM, ssh, anti virus, etc.). analyzer(-1) means that the last element of an analyzer list will be selected.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>idmef-alter</strong> will never overwrite an IDMEF path that is already set.</p>
</div>
</div>
<div class="section" id="idmef-alter-force">
<h4>idmef-alter-force<a class="headerlink" href="#idmef-alter-force" title="Permalink to this headline">¶</a></h4>
<p>Identical to <strong>idmef-alter</strong> field but you might use the <strong>idmef-alter-force</strong> option in case you want to overwrite a path that is already set.</p>
</div>
<div class="section" id="charset">
<h4>charset<a class="headerlink" href="#charset" title="Permalink to this headline">¶</a></h4>
<p>For each file added to a format, a character encoding can be specified using the <strong>charset</strong> option.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[format=MyFormat]</span>
<span class="na">charset</span> <span class="o">=</span> <span class="s">ISO-8859-1</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/messages</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/secure</span>
<span class="na">charset</span> <span class="o">=</span> <span class="s">UTF-8</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/auth.log</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/syslog</span>
<span class="na">udp-server</span> <span class="o">=</span> <span class="s">127.0.0.1:2000</span>
</pre></div>
</div>
<p>The following table recaps the example above:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="22%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Charset</strong></td>
<td><strong>Source</strong></td>
<td><strong>Explanation</strong></td>
</tr>
<tr class="row-even"><td rowspan="2">ISO-8859-1</td>
<td>file: messages</td>
<td rowspan="2">This will set the character set for “messages” and “secure” to “ISO-8859-1”</td>
</tr>
<tr class="row-odd"><td>file: secure</td>
</tr>
<tr class="row-even"><td rowspan="3">UTF-8</td>
<td>file: auth.log</td>
<td rowspan="3">This will set the character set for “auth.log”, “syslog” and UDP server to “UTF-8”</td>
</tr>
<tr class="row-odd"><td>file: syslog</td>
</tr>
<tr class="row-even"><td>udp-server: 127.0.0.1:2000</td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table: Charset usage example</strong></p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If no character encoding is specified, the system will attempt to automatically detect the encoding used. If the detection fails, then system wide default (retrieved from locale LC_CTYPE) will be used.</p>
</div>
<p>LC_CTYPE selects character classification, case conversion, and other characterattributes.</p>
<p>A number of charset are possible to configure:</p>
<table border="1" class="docutils" id="examples-of-charset">
<caption><span class="caption-text">Examples of charset</span><a class="headerlink" href="#examples-of-charset" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Charset</th>
<th class="head">Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Windows-1252 also called CP1252</td>
<td>Windows-1252 or CP-1252 is a character encoding of the Latin alphabet, used by default in the legacy components of Microsoft Windows in English and some other Western languages.</td>
</tr>
<tr class="row-odd"><td>ISO 8859-1</td>
<td><em>Latin alphabet No. 1</em>, is part of the ISO/IEC 8859 series of ASCII-based standard character encoding. It is generally intended for “Western European” languages. It is the basis for most popular 8-bit character sets, including Windows-1252 and the first block of characters in Unicode.</td>
</tr>
<tr class="row-even"><td>ISO 8859-15</td>
<td>8-bit single-byte coded graphic character sets. Latin alphabet No. 9, is part of the ISO/IEC 8859 series of ASCII-based standard character encoding. It is informally referred to as Latin-9. It is similar to ISO 8859-1, and thus generally intended for “Western European” languages, but replaces some less common symbols with the euro sign and some letters that were now deemed missing.</td>
</tr>
<tr class="row-odd"><td>UTF-8</td>
<td>UTF-8 is a variable-width encoding that can represent every character in the Unicode character set. It was designed for backward compatibility with ASCII and to avoid the complications of endianness and byte order marks in UTF-16 and UTF-32. UTF-8 has become the dominant character encoding for the World Wide Web, accounting for more than half of all web pages.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="parametres-globaux">
<h3>Global settings<a class="headerlink" href="#parametres-globaux" title="Permalink to this headline">¶</a></h3>
<div class="section" id="log-max-length">
<h4>log-max-length<a class="headerlink" href="#log-max-length" title="Permalink to this headline">¶</a></h4>
<p>Specifies the maximum length of logs, in bytes. If the log exceeds this size, it will be split into several parts, each one processed successively and independently from one another.</p>
</div>
<div class="section" id="rotations-des-journaux">
<h4>Log rotation<a class="headerlink" href="#rotations-des-journaux" title="Permalink to this headline">¶</a></h4>
<p>Logrotate allows you to limit the size of log files in <code class="file docutils literal notranslate"><span class="pre">/var/log/</span></code>.</p>
<p>For each log file, logrotate achieves 2 simultaneous operations:</p>
<ul class="simple">
<li>rotation: it archives the log file under another name and deletes the oldest archive;</li>
<li>compression: it potentially compresses the log file before archiving it.</li>
</ul>
<p><strong>Prelude LML</strong> configures the rotation of log files following two criteria:</p>
<ul class="simple">
<li><a class="reference internal" href="#max-rotation-size-offset"><span class="std std-ref">max-rotation-size-offset</span></a>;</li>
<li><a class="reference internal" href="#max-rotation-size-offset"><span class="std std-ref">max-rotation-size-offset</span></a>.</li>
</ul>
<div class="section" id="max-rotation-size-offset">
<h5>max-rotation-size-offset<a class="headerlink" href="#max-rotation-size-offset" title="Permalink to this headline">¶</a></h5>
<p>Specifies the maximum difference, in size, between the interval of two log files rotation. If this difference is reached, a high severity alert will be emitted. The K (kbytes) or M (mbytes) suffix must be used for size definition.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">max-rotation-size-offset</span> <span class="o">=</span> <span class="s">1K</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is necessary to indicate the unit in kbytes or mbytes.</p>
</div>
</div>
<div class="section" id="max-rotation-time-offset">
<h5>max-rotation-time-offset<a class="headerlink" href="#max-rotation-time-offset" title="Permalink to this headline">¶</a></h5>
<p>Specifies the maximum difference, in seconds, between the interval of two log files rotation. If this difference is reached, a high severity alert will be emitted.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">max-rotation-time-offset</span> <span class="o">=</span> <span class="s">300</span>
</pre></div>
</div>
</div>
<div class="section" id="warning-limit">
<h5>warning-limit<a class="headerlink" href="#warning-limit" title="Permalink to this headline">¶</a></h5>
<p>Maximum number of warnings a given source should emit in case it can not parse log entry with the provided <strong>prefix-regex</strong> and <strong>time-format</strong>:</p>
<ul class="simple">
<li>-1: unlimited number of warning;</li>
<li>0! no warning at all;</li>
<li>X: print at most X warnings.</li>
</ul>
<p>Example for unlimited number of warnings:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">warning-limit</span> <span class="o">=</span> <span class="s">-1</span>
</pre></div>
</div>
<p>Some logs with a prefix not parsable are generated intentionally. When running <strong>Prelude LML</strong>, warnings are printed in the console:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">27 Feb 07:50:33 (process:24720) WARNING: no appropriate format defined for log entry:</span>
<span class="go">&#39;De75c v9 2d1:2d9:5v6 devel5 sshd[17554]: Failed password for akarade from 12.34.56.78</span>
<span class="go">port 4214&#39;.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="parametres-tls">
<h4>TLS settings<a class="headerlink" href="#parametres-tls" title="Permalink to this headline">¶</a></h4>
<div class="section" id="dh-prime-length">
<h5>dh-prime-length<a class="headerlink" href="#dh-prime-length" title="Permalink to this headline">¶</a></h5>
<p>Number of bits for the prime used in the Diffie Hellman key exchange. The value should be one of 768, 1024, 2048, 3072 or 4096. The default is 1024.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dh-prime-length</span> <span class="o">=</span> <span class="s">1024</span>
</pre></div>
</div>
</div>
<div class="section" id="dh-parameters-regenerate">
<h5>dh-parameters-regenerate<a class="headerlink" href="#dh-parameters-regenerate" title="Permalink to this headline">¶</a></h5>
<p>How often to regenerate the parameters used in the Diffie Hellman key exchange. These should be discarded and regenerated once a day, once a week or once a month, depending on the security requirements, the default is 24 hours.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dh-parameters-regenerate</span> <span class="o">=</span> <span class="s">24</span>
</pre></div>
</div>
<p>Be careful, the generation is a CPU intensive operation. The value is in hours, 0 disables regeneration entirely.</p>
</div>
</div>
</div>
<div class="section" id="section-pcre">
<h3>[Pcre] section<a class="headerlink" href="#section-pcre" title="Permalink to this headline">¶</a></h3>
<p>This section defines the PCRE rules entrance point location.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/pcre.rules</span>
</pre></div>
</div>
<p>This variable might be set several times if you want to define multiple PCRE entrance point locations.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/pcre.rules</span>
<span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/second-pcre.rules</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The directory where all rulesets are included is also called <em>ruleset</em>.</p>
</div>
</div>
<div class="section" id="id4">
<h3>[Debug] section<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>This plugin issues an alert for each packet, careful to the logging activity it generates.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Debug]</span>
</pre></div>
</div>
<p>Trigger reports in the console.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">stderr</span>
</pre></div>
</div>
<p><strong>stderr</strong> means standard error. It’s an output stream typically used by programs to output error messages or diagnostic.</p>
<p>For example, when running <strong>Prelude LML</strong>, an attempt made to log into the account is failed intentionally:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ssh root@localhost
</pre></div>
</div>
<p><strong>Prelude LML</strong> prints the debug message in the console:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Debug: log received, log=May 23 10:42:51 localhost sshd[3726]: Failed password for root</span>
<span class="go">from 127.0.0.1 port 44953 ssh2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To use this feature, uncomment the line of plugin configuration in the file <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/prelude-lml.conf</span></code></p>
</div>
</div>
<div class="section" id="configuration-des-plugins">
<h3>Plugins configuration<a class="headerlink" href="#configuration-des-plugins" title="Permalink to this headline">¶</a></h3>
<p>Plugins configuration allows you to define how data are routed by <strong>Prelude LML</strong>. The configuration is made in the <em>plugins.rules</em> file located in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/plugins.rules</span></code>.</p>
<p>There are four fields to fill to configure a plugin:</p>
<ul class="simple">
<li><a class="reference internal" href="#source"><span class="std std-ref">source</span></a>;</li>
<li><a class="reference internal" href="#plugin"><span class="std std-ref">plugin</span></a>;</li>
<li><a class="reference internal" href="#pcre-option"><span class="std std-ref">pcre-option</span></a>;</li>
<li><a class="reference internal" href="#regex"><span class="std std-ref">regex</span></a>.</li>
</ul>
<p>The logs source matching <strong>source</strong>, with input data matching <strong>regex</strong>, will be sent to the defined <strong>plugin</strong>.</p>
<p><em>Application examples:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># source             plugin  pcre-option     regex</span>
<span class="na">*                    Debug   -               *</span>
<span class="na">*                    Pcre    -               *</span>
<span class="na">/var/log/auth.log    Plugin1 -               [Ll]ogin|[Aa]uthentication</span>
<span class="na">/var/log/secure      Plgn    -               123.0.4*</span>
</pre></div>
</div>
<p>The next paragraphs evoke the various possibilities for each field.</p>
<div class="section" id="source">
<h4>source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h4>
<p><strong>source</strong> should be one of the following choices:</p>
<table border="1" class="docutils" id="possible-sources-to-configure-a-plugin">
<caption><span class="caption-text">Possible sources to configure a plugin</span><a class="headerlink" href="#possible-sources-to-configure-a-plugin" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>*</td>
<td>Data from any sources (logfile, UDP listener, etc) is sent to “plugin”.</td>
</tr>
<tr class="row-odd"><td>REGEXP</td>
<td>Data which sources match regular expression REGEXP is sent to “plugin”.</td>
</tr>
<tr class="row-even"><td>address:port/udp</td>
<td>Data received from this machine is sent to “plugin”.</td>
</tr>
<tr class="row-odd"><td>/path/to/logfile</td>
<td>Data from this logfile is sent to “plugin”.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="plugin">
<h4>plugin<a class="headerlink" href="#plugin" title="Permalink to this headline">¶</a></h4>
<p>This field corresponds to the plugin name to use. <strong>Prelude LML</strong> comes with two plugins in the plugins.rules file:</p>
<ul class="simple">
<li>Debug;</li>
<li>Pcre.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The plugins must be called with the same name that in their section, in the <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/prelude-lml.conf</span></code> file.</p>
</div>
</div>
<div class="section" id="pcre-option">
<h4>pcre-option<a class="headerlink" href="#pcre-option" title="Permalink to this headline">¶</a></h4>
<p><strong>pcre-option</strong> is unsupported at the moment. The value is a dash character by default.</p>
</div>
<div class="section" id="regex">
<h4>regex<a class="headerlink" href="#regex" title="Permalink to this headline">¶</a></h4>
<p>This field allows to define the regular expression that the input data must match to be sent to the plugin.</p>
<p><em>Example:</em></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[Ll]ogin|[Aa]uthentication
</pre></div>
</div>
</div>
</div>
<div class="section" id="utilisation-de-plus-d-un-plugin-pcre">
<h3>Using more than one PCRE plugin<a class="headerlink" href="#utilisation-de-plus-d-un-plugin-pcre" title="Permalink to this headline">¶</a></h3>
<p>In some cases you will try to split your log file and match different rules on the multiple log files. In order to do that you must modify the <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/prelude-lml.conf</span></code> and <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-lml/plugins.rules</span></code> files. By default if you do not specify a Pcre name, there will be only one Pcre named by default.</p>
<p><em>Example:</em></p>
<ul class="simple">
<li>You have two syslog files in the following path:<ul>
<li>/var/log/auth.log;</li>
<li>/var/log/syslog.</li>
</ul>
</li>
<li>You have three rules files:<ul>
<li>ssh.rules;</li>
<li>nagios.rules;</li>
<li>sendmail.rules.</li>
</ul>
</li>
</ul>
<p>You need to create two different Pcre instances.</p>
<p><em>plugins.rules new file:</em></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># source             plugin          pcre-option     regex
/var/log/auth.log    Pcre[first]     -               [Ll]ogin|[Aa]uthentication
/var/log/syslog      Pcre[second]    -               *
</pre></div>
</div>
<p>The logs sources matching <em>auth.log</em> file, with input data matching <code class="regexp docutils literal notranslate"><span class="pre">[Ll]ogin|[Aa]uthentication</span></code>, will be sent to the <em>Pcre[first]</em> plugin. In the same way as, the logs sources matching <em>syslog</em> file, with all input data, will be sent to the <em>Pcre[second]</em> plugin.</p>
<p><em>New prelude-lml.conf:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[Pcre=first]</span>
<span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/ssh.rules</span>
<span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/nagios.rules</span>

<span class="k">[Pcre=second]</span>
<span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/nagios.rules</span>
<span class="na">ruleset</span> <span class="o">=</span> <span class="s">/etc/prelude-lml/ruleset/sendmail.rules</span>
</pre></div>
</div>
<p>When you run <strong>Prelude LML</strong> you should see the loading of two modules:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">23 May 15:23:18 (process:5158) INFO: PCRE plugin loaded 589 rules.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: PCRE plugin loaded 11 rules.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: PCRE plugin loaded 13 rules.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: PCRE plugin loaded 2 rules.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: PCRE plugin loaded 13 rules.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: Connecting to 127.0.0.1:4690 prelude Manager server.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: TLS authentication succeed with Prelude Manager.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: /var/log/syslog: resuming log analyzis at offset 14989.</span>
<span class="go">23 May 15:23:18 (process:5158) INFO: /var/log/auth.log: resuming log analyzis at offset 17834.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-de-prelude-correlator">
<h2>Prelude Correlator Configuration<a class="headerlink" href="#configuration-de-prelude-correlator" title="Permalink to this headline">¶</a></h2>
<p><strong>Prelude Correlator</strong> is configured in the prelude-correlator.conf file located in the path <code class="file docutils literal notranslate"><span class="pre">/etc/prelude-correlator/prelude-correlator.conf</span></code>.</p>
<p>The plugins might be configured in this file with some variables.</p>
<div class="section" id="section-general">
<h3><strong>[general] section</strong><a class="headerlink" href="#section-general" title="Permalink to this headline">¶</a></h3>
<p>This section allows to define criteria.</p>
<p>Only attempt to correlate input events that match the following criteria:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[general]</span>
<span class="na">criteria</span> <span class="o">=</span> <span class="s">&lt;IDMEF criteria&gt;</span>
<span class="na">grouping</span> <span class="o">=</span> <span class="s">&lt;IDMEF path&gt;</span>
</pre></div>
</div>
<p>The <strong>criteria</strong> entry allows you to filter events based on specific IDMEF fields.</p>
<p>Several <strong>Prelude SIEM</strong> components use IDMEF criteria in order to provide IDMEF filtering capability.</p>
<p><em>The criteria syntax:</em></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;IDMEF path&gt; &lt;operator&gt; &lt;value&gt;
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">criteria</span> <span class="o">=</span> <span class="s">alert.classification.text == &#39;User login successful&#39;</span>
</pre></div>
</div>
<p>You can also use boolean AND/OR operators:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">criteria</span> <span class="o">=</span> <span class="s">&#39;MySensor&#39; &amp;&amp; (&#39;alert.assessment.impact.severity = &#39;high&#39; ||</span>
<span class="na">alert.assessment.impact.completion</span> <span class="o">=</span> <span class="s">&#39;succeeded&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the criteria variable is disabled, so <strong>Prelude Correlator</strong> receives all alertscoming from <strong>Prelude Manager</strong>.</p>
</div>
<p>The following table shows a list of available operators for criteria:</p>
<table border="1" class="docutils" id="available-operators-for-criteria">
<caption><span class="caption-text">Available operators for criteria</span><a class="headerlink" href="#available-operators-for-criteria" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator symbol</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>=</td>
<td>Case sensitive equal</td>
</tr>
<tr class="row-odd"><td>=*</td>
<td>Case insensitive equal</td>
</tr>
<tr class="row-even"><td>!=</td>
<td>Case sensitive not equal</td>
</tr>
<tr class="row-odd"><td>!=*</td>
<td>Case insensitive not equal</td>
</tr>
<tr class="row-even"><td>~</td>
<td>Case sensitive regexp</td>
</tr>
<tr class="row-odd"><td>~*</td>
<td>Case insensitive regexp</td>
</tr>
<tr class="row-even"><td>!~</td>
<td>Case sensitive, non matching regexp</td>
</tr>
<tr class="row-odd"><td>!~*</td>
<td>Case insensitive, non matching regexp</td>
</tr>
<tr class="row-even"><td>&lt;</td>
<td>Lesser than</td>
</tr>
<tr class="row-odd"><td>&lt;=</td>
<td>Lesser or equal than</td>
</tr>
<tr class="row-even"><td>&gt;</td>
<td>Greater than</td>
</tr>
<tr class="row-odd"><td>&gt;=</td>
<td>Greater or equal than</td>
</tr>
<tr class="row-even"><td>&lt;&gt;</td>
<td>Case sensitive sub-string</td>
</tr>
<tr class="row-odd"><td>&lt;&gt;*</td>
<td>Case insensitive sub-string</td>
</tr>
<tr class="row-even"><td>!&lt;&gt;</td>
<td>Case sensitive not sub-string</td>
</tr>
<tr class="row-odd"><td>!&lt;&gt;*</td>
<td>Case insensitive not sub-string</td>
</tr>
<tr class="row-even"><td>||</td>
<td>OR (boolean)</td>
</tr>
<tr class="row-odd"><td>&amp;&amp;</td>
<td>AND (bolean)</td>
</tr>
</tbody>
</table>
<p>The <strong>grouping</strong> entry can be used to segment correlation depending on the value of an IDMEF field.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">grouping</span> <span class="o">=</span> <span class="s">alert.analyzer(-1).node.location</span>
</pre></div>
</div>
<p>This configuration makes it so that two alerts not originating from the same geographical location won’t be correlated with each other.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This feature should be used with caution, as the number of correlation contexts in memory will rise proportionally with the number of different values for the chosen IDMEF field.</p>
</div>
</div>
<div class="section" id="section-bruteforceplugin">
<h3>[BruteForcePlugin] section<a class="headerlink" href="#section-bruteforceplugin" title="Permalink to this headline">¶</a></h3>
<p>This section is commented by default, this implies that this plugin will be enabled.</p>
<p>To disabled it, uncomment those lines and set the <strong>disable</strong> option to <em>false</em>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[BruteForcePlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</div>
<div class="section" id="section-businesshourplugin">
<h3>[BusinessHourPlugin] section<a class="headerlink" href="#section-businesshourplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[BusinessHourPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
<p>This plugin is disabled by default, as it can be very verbose.</p>
</div>
<div class="section" id="section-opensshauthplugin">
<h3>[OpenSSHAuthPlugin] section<a class="headerlink" href="#section-opensshauthplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[OpenSSHAuthPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</div>
<div class="section" id="section-eventscanplugin">
<h3>[EventScanPlugin] section<a class="headerlink" href="#section-eventscanplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[EventScanPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</div>
<div class="section" id="section-eventstormplugin">
<h3>[EventStormPlugin] section<a class="headerlink" href="#section-eventstormplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[EventStormPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</div>
<div class="section" id="section-eventsweepplugin">
<h3>[EventSweepPlugin] section<a class="headerlink" href="#section-eventsweepplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[EventSweepPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</div>
<div class="section" id="section-wormplugin">
<h3>[WormPlugin] section<a class="headerlink" href="#section-wormplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[WormPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">repeat-target</span> <span class="o">=</span> <span class="s">5</span>
</pre></div>
</div>
<p><strong>repeat-target</strong> is the number of times a source repeats actions taken against it recently</p>
<p>The default value is set to 5.</p>
</div>
<div class="section" id="section-ciarmyplugin">
<h3>[CIArmyPlugin] section<a class="headerlink" href="#section-ciarmyplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[CIArmyPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">reload</span> <span class="o">=</span> <span class="s">604800</span>
<span class="na">uri</span> <span class="o">=</span> <span class="s">http://cinsscore.com/list/ci-badguys.txt</span>
<span class="na">timeout</span> <span class="o">=</span> <span class="s">10</span>
<span class="na">filename</span> <span class="o">=</span> <span class="s">/var/lib/prelude-correlator/prelude-correlator/ciarmy.dat</span>
</pre></div>
</div>
<p><strong>reload</strong> is the frequency (in seconds) at which the database CIArmy must be downloaded and reloaded. By default, the database is reloaded once a week.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If reload is set to 0, that means reloading is disabled.</p>
</div>
<p><strong>uri</strong> is the server address where the CIArmy database is loaded from.</p>
<p>The <strong>timeout</strong> variable defines the maximum allowed time (in seconds) for downloading the database.</p>
<p><strong>filename</strong> defines the location of the file containing the database.</p>
</div>
<div class="section" id="section-dshieldplugin">
<h3>[DshieldPlugin] section<a class="headerlink" href="#section-dshieldplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[DshieldPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">reload</span> <span class="o">=</span> <span class="s">604800</span>
<span class="na">uri</span> <span class="o">=</span> <span class="s">http://www.dshield.org/ipsascii.html?limit=10000</span>
<span class="na">timeout</span> <span class="o">=</span> <span class="s">10</span>
<span class="na">filename</span> <span class="o">=</span> <span class="s">/var/lib/prelude-correlator/prelude-correlator/dshield.dat</span>
</pre></div>
</div>
</div>
<div class="section" id="section-spamhausdropplugin">
<h3>[SpamhausDropPlugin] section<a class="headerlink" href="#section-spamhausdropplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SpamhausDropPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">reload</span> <span class="o">=</span> <span class="s">604800</span>
<span class="na">uri</span> <span class="o">=</span> <span class="s">http://www.spamhaus.org/drop/drop.txt</span>
<span class="na">filename</span> <span class="o">=</span> <span class="s">/var/lib/prelude-correlator/prelude-correlator/spamhaus_drop.dat</span>
</pre></div>
</div>
</div>
<div class="section" id="section-firewallplugin">
<h3>[FirewallPlugin] section<a class="headerlink" href="#section-firewallplugin" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[FirewallPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">flush-protected-hosts</span> <span class="o">=</span> <span class="s">3600</span>
</pre></div>
</div>
<p>The <strong>flush-protected-hosts</strong> variable allows you to define how much time a given target hosts should be considered as protected when a firewall <em>drop</em> is noticed for this machine.</p>
<p>By default the value is set to 3600.</p>
</div>
<div class="section" id="section-python-rules">
<h3>[python_rules] section<a class="headerlink" href="#section-python-rules" title="Permalink to this headline">¶</a></h3>
<p>In this section, you can specify where your python rules belongs.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">paths</span> <span class="o">=</span> <span class="s">/etc/prelude-correlator/rules/python</span>
</pre></div>
</div>
<p>This will load all python files under this folder and if a Python class has the same name as the python filename, it will be loaded as a rule.</p>
</div>
<div class="section" id="section-include">
<h3><strong>[include] section</strong><a class="headerlink" href="#section-include" title="Permalink to this headline">¶</a></h3>
<p>If you need to organize your configuration files, you can load other configuration files in this section.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">conf.d/*.conf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-de-prelude-gui">
<h2>Prelude GUI configuration<a class="headerlink" href="#configuration-de-prelude-gui" title="Permalink to this headline">¶</a></h2>
<p>This section explains how to configure the <strong>Prelude GUI</strong>.</p>
<p>Several configuration files exist, and are located in <code class="file docutils literal notranslate"><span class="pre">/etc/prewikka/</span></code>:</p>
<ul class="simple">
<li>prewikka.conf;</li>
<li>conf.d/alerts.conf;</li>
<li>conf.d/auth.conf;</li>
<li>conf.d/external_app.conf;</li>
<li>conf.d/logs.conf;</li>
<li>conf.d/riskoverview.conf.</li>
</ul>
<p>All <em>.conf</em> files can contain the same sections. In this case identical sections are merged:</p>
<ul class="simple">
<li>If an option appears in only one section, it is taken into account;</li>
<li>If an option appears in several sections, it’s the value in the last imported file (according to the order above) that is used.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Both these points are valid only if the sections with the same name are not commented.</p>
</div>
<div class="section" id="configuration-principale">
<h3>Main configuration<a class="headerlink" href="#configuration-principale" title="Permalink to this headline">¶</a></h3>
<p>The main configuration is made in the <code class="file docutils literal notranslate"><span class="pre">/etc/prewikka/prewikka.conf</span></code> file.</p>
<div class="section" id="id5">
<h4><strong>[general] section</strong><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>The <strong>help_location</strong> option defines the URL used for building the contextual help link.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">help_location: http://doc.prelude/rst/${lang}/${path}</span>
</pre></div>
</div>
<p>The <strong>heartbeat_count</strong> option defines the number of heartbeats to analyze in the heartbeat analysis view:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">heartbeat_count: 30</span>
</pre></div>
</div>
<p>If the offset between two heartbeats is off by more than the specified offset (in seconds), the analyzer will be represented as offline. The offset is defined by heartbeat_error_margin option:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">heartbeat_error_margin: 3</span>
</pre></div>
</div>
<p>This option allows to open external links in a new window (references, IP lookup, and port lookup):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">external_link_new_window: yes</span>
</pre></div>
</div>
<p>Enable the links giving more information about an IP / domain, a port, a protocol, and a reference on an alert (<em>no</em> by default):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">enable_details: no</span>
</pre></div>
</div>
<p>Enables display of the python traceback on error (set to <em>yes</em> by default):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">enable_error_traceback: yes</span>
</pre></div>
</div>
<p>Script link providing more details about an IP or a domain of an alert:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">host_details_url: https://www.prelude-siem.com/host_details.php</span>
</pre></div>
</div>
<p>An IP address will be passed as an argument in the URL as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>https://www.prelude-siem.com/host_details.php?host=127.0.0.1
</pre></div>
</div>
<p>Script link providing more details about a port and protocol for an alert:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">port_details_url: https://www.prelude-siem.com/port_details.php</span>
</pre></div>
</div>
<p>A port and a protocol will be passed in argument in the URL as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>https://www.prelude-siem.com/port_details.php?port=2048&amp;protocol=tcp
</pre></div>
</div>
<p>Script link providing more details about the reference of an alert.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">reference_details_url: https://www.prelude-siem.com/reference_details.php</span>
</pre></div>
</div>
<p>The origin of the reference, its name, as well as its URL will be passed in argument in the URL as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>http://www.prelude-siem.com/reference_details.php?origin=vendor-specific&amp;name=MyName&amp;url=http://vendor-site.com
</pre></div>
</div>
<p>When the number of classifications, sources or targets exceeds the defined value, an expansion link will be provided to look up the remaining entry.</p>
<p>The default values for these options are the following:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">max_aggregated_source: 3</span>
<span class="na">max_aggregated_target: 3</span>
<span class="na">max_aggregated_classification: 10</span>
</pre></div>
</div>
<p><strong>Asynchronous DNS resolution</strong></p>
<p>The asynchronous DNS resolution requires the python modules:</p>
<ul class="simple">
<li><code class="xref py py-mod docutils literal notranslate"><span class="pre">twisted.names</span></code>;</li>
<li><code class="xref py py-mod docutils literal notranslate"><span class="pre">twisted.internet</span></code>.</li>
</ul>
<p>While rendering view containing address scheduled for asynchronous DNS resolution, it ispossible that the rendering terminate too fast for all DNS requests to complete.</p>
<p>The <strong>dns_max_delay</strong> setting determines the <strong>Prelude GUI</strong> behavior. The possible values are the following:</p>
<ul class="simple">
<li>-1: No DNS resolution performed;</li>
<li>0: Sends results to the client immediately;</li>
<li>x: Waits at most x seconds, then sends results to the client, ‘x’ being an integer.</li>
</ul>
<p>By default, the value is fixed to 0.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">dns_max_delay: 0</span>
</pre></div>
</div>
<p>Default language to use. By default, the <strong>Prelude GUI</strong> is set in English:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">default_locale: en_GB</span>
</pre></div>
</div>
<p>The supported locales are:</p>
<table border="1" class="docutils" id="available-languages-for-prelude-gui">
<caption><span class="caption-text">Available languages for Prelude GUI</span><a class="headerlink" href="#available-languages-for-prelude-gui" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Associated language</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>de_DE</td>
<td>German</td>
</tr>
<tr class="row-odd"><td>en_GB</td>
<td>English</td>
</tr>
<tr class="row-even"><td>es_ES</td>
<td>Spanish</td>
</tr>
<tr class="row-odd"><td>fr_FR</td>
<td>French</td>
</tr>
<tr class="row-even"><td>it_IT</td>
<td>Italian</td>
</tr>
<tr class="row-odd"><td>pl_PL</td>
<td>Polish</td>
</tr>
<tr class="row-even"><td>pt_BR</td>
<td>Portuguese (brazilian)</td>
</tr>
<tr class="row-odd"><td>ru_RU</td>
<td>Russian</td>
</tr>
</tbody>
</table>
<p>Theme to use. Set to <em>cs</em> by default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">default_theme: cs</span>
</pre></div>
</div>
<p>There are other supported themes such as:</p>
<ul class="simple">
<li>blue;</li>
<li>bright;</li>
<li>classic;</li>
<li>cs;</li>
<li>dark;</li>
<li>green;</li>
<li>yellow.</li>
</ul>
<p>Timezone to use by default when creating a new user:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">default_timezone: UTC</span>
</pre></div>
</div>
<p>Encoding to use. Set to <em>utf8</em> by default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">encoding: utf8</span>
</pre></div>
</div>
<p>It is possible to change the encoding according to the selected language.</p>
<p>Refer to the table <span class="xref std std-ref">Languages available for Prelude GUI</span> to see others possible encoding.</p>
<p>Public path to the <strong>Prelude GUI</strong> in case the application is being served through a reverse proxy, including any necessary port information. Commented by default:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">reverse_path: http://example.com/proxied/prelude/</span>
</pre></div>
</div>
</div>
<div class="section" id="section-interface">
<h4>[interface] section<a class="headerlink" href="#section-interface" title="Permalink to this headline">¶</a></h4>
<p>Some interface elements are customizable using the following options:</p>
<ul class="simple">
<li><strong>software</strong>: software name displayed in the top left corner (displays a logo if this option is not defined);</li>
<li><strong>browser_title:</strong> webpage title.</li>
<li><strong>menu_order</strong>: YAML file containing the menu layout. Refer to the section <span class="xref std std-ref">Menu settings</span>.</li>
</ul>
<p>By default, thoses options are commented:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># [interface]</span>
<span class="c1"># software: Prelude</span>
<span class="c1"># browser_title: Prelude SIEM</span>
<span class="c1"># menu_order: menu.yml</span>
</pre></div>
</div>
<p><strong>Customizable links</strong></p>
<p>It is possible to add custom links on a host, classification, or date in the respective columns in the alert view.</p>
<p>These links are arranged in 3 different sections:</p>
<ul class="simple">
<li><strong>[url host]</strong>: defines links on a host;</li>
<li><strong>[url classification]</strong>: defines the links on a classification;</li>
<li><strong>[url time]</strong>: defines the links on a date.</li>
</ul>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[url host]</span>
<span class="na">link1: http://my-url.com</span>

<span class="k">[url classification]</span>
<span class="na">link2: http://another-url.com</span>

<span class="k">[url time]</span>
<span class="na">link3: http://url3.com</span>
</pre></div>
</div>
<p>These links will take the form of a button when you click on one of the aforementioned elements. The button text is the name of the key.</p>
<p>The links can contain the variable <em>$value</em>, which will be replaced when the button is generated. The meaning of this variable depends on the section:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="21%" />
<col width="58%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Variable</strong></td>
<td><strong>Section</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td rowspan="3">$value</td>
<td>host</td>
<td>IP address / hostname</td>
</tr>
<tr class="row-odd"><td>classification</td>
<td>Classification name</td>
</tr>
<tr class="row-even"><td>time</td>
<td>Analyzer time</td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table: meaning of the dynamic links variables</strong></p><p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[url classification]</span>
<span class="na">Search classification: http://google.com/#q</span><span class="o">=</span><span class="s">$value</span>

<span class="k">[url host]</span>
<span class="na">Inventory: http://my-assets.com/?host</span><span class="o">=</span><span class="s">$value</span>

<span class="k">[url time]</span>
<span class="na">Archive: http://my-archive/?start</span><span class="o">=</span><span class="s">$value</span>
</pre></div>
</div>
<p>It is possible to create several links in the same section by declaring several entries, provided you have a different key for each link.</p>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[url classification]</span>
<span class="na">Search classification: http://google.com/#q</span><span class="o">=</span><span class="s">$value</span>
<span class="na">Knowledge base: http://my-kbbase.com/?event</span><span class="o">=</span><span class="s">$value</span>
</pre></div>
</div>
<p><strong>Databases</strong></p>
</div>
<div class="section" id="section-idmef-database">
<h4>[idmef_database] section<a class="headerlink" href="#section-idmef-database" title="Permalink to this headline">¶</a></h4>
<p>The database where the <strong>Prelude GUI</strong> reads the stored alerts by <strong>Prelude Manager</strong>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[idmef_database]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">&lt;pgsql | mysql | sqlite3&gt;</span>
<span class="c1"># for sqlit3, add the &#39;file&#39; option</span>
<span class="c1"># file: /path/to/base/sqlite.db</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">&lt;database host&gt;</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">&lt;database name&gt;</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">&lt;username for the database connection if necessary&gt;</span>
<span class="na">pass</span> <span class="o">=</span> <span class="s">&lt;password associated with the username&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[idmef_database]</span>
<span class="na">type: pgsql</span>
<span class="na">host: localhost</span>
<span class="na">user: prelude</span>
<span class="na">pass: prelude</span>
<span class="na">name: prelude</span>
</pre></div>
</div>
</div>
<div class="section" id="section-database">
<h4>[database] section<a class="headerlink" href="#section-database" title="Permalink to this headline">¶</a></h4>
<p>Database required by <strong>Prelude GUI</strong> to save user preferences, users, and internal configuration variables.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[database]</span>
<span class="na">type</span> <span class="o">=</span> <span class="s">&lt;pgsql | mysql | sqlite3&gt;</span>
<span class="c1"># for sqlit3, add the &#39;file&#39; option</span>
<span class="c1"># file: /path/to/base/sqlite.db</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">&lt;database host&gt;</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">&lt;database name&gt;</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">&lt;username for the database connection if necessary&gt;</span>
<span class="na">pass</span> <span class="o">=</span> <span class="s">&lt;password associated with the username&gt;</span>
</pre></div>
</div>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[database]</span>
<span class="na">type: pgsql</span>
<span class="na">host: localhost</span>
<span class="na">user: preludegui</span>
<span class="na">pass: preludegui</span>
<span class="na">name: preludegui</span>
</pre></div>
</div>
<p><strong>Logging</strong></p>
<p><strong>Prelude GUI</strong> generates its own logs. You can activate several log sections.</p>
<p>The log level might be set to:</p>
<ul class="simple">
<li>all/debug;</li>
<li>info;</li>
<li>warning;</li>
<li>error;</li>
<li>critical.</li>
</ul>
<p>If unspecified, the default level is set to <em>warning</em>. The following sections are part of the default configuration of the <strong>Prelude GUI</strong>.</p>
</div>
<div class="section" id="section-log-stderr">
<h4>[log stderr] section<a class="headerlink" href="#section-log-stderr" title="Permalink to this headline">¶</a></h4>
<p>This section allows to report logs of the <strong>Prelude GUI</strong> on the standard error.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[log stderr]</span>
<span class="na">level: all</span>
</pre></div>
</div>
</div>
<div class="section" id="section-log-file">
<h4>[log file] section<a class="headerlink" href="#section-log-file" title="Permalink to this headline">¶</a></h4>
<p>This section allows to report debug logs of the <strong>Prelude GUI</strong> in a file.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[log file]</span>
<span class="na">level: debug</span>
<span class="na">file: /tmp/prewikka.log</span>
</pre></div>
</div>
<p>In this example, debug logs are now available in the <em>/tmp/prewikka.log</em> file.</p>
</div>
<div class="section" id="section-log-syslog">
<h4>[log syslog] section<a class="headerlink" href="#section-log-syslog" title="Permalink to this headline">¶</a></h4>
<p>This section allows to report logs of the <strong>Prelude GUI</strong> on the syslog format.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[log syslog]</span>
<span class="na">level: info</span>
</pre></div>
</div>
</div>
<div class="section" id="section-log-nteventlog">
<h4>[log nteventlog] section<a class="headerlink" href="#section-log-nteventlog" title="Permalink to this headline">¶</a></h4>
<p>This section writes logs of the <strong>Prelude GUI</strong> to the Windows Event log.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[log nteventlog]</span>
<span class="na">level: info</span>
</pre></div>
</div>
</div>
<div class="section" id="section-log-smtp">
<h4>[log smtp] section<a class="headerlink" href="#section-log-smtp" title="Permalink to this headline">¶</a></h4>
<p>This section allows to report logs of the <strong>Prelude GUI</strong> by emails.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[log smtp]</span>
<span class="na">level: warning</span>
<span class="na">host: mail.domain.com</span>
<span class="na">from: user@address</span>
<span class="na">to: recipient1@address, recipient2@address, recipientN@address</span>
<span class="na">subject: Subject to use</span>
</pre></div>
</div>
<p>Crontab configuration</p>
<p>This sections allows to define cron tasks. These cron tasks need to be enabled in Prelude GUI to be executed.</p>
</div>
<div class="section" id="section-cron-alert">
<h4>[cron alert] section<a class="headerlink" href="#section-cron-alert" title="Permalink to this headline">¶</a></h4>
<p>This section allows to define the periodic deletion of alerts. The <em>age</em> parameter is used to define the minimal retention period (in days) for alerts. The oldest alerts will be deleted. The default is not to delete any alert. It is possible to define this value per alert severity.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[cron alert]</span>
<span class="na">age: 30</span>
<span class="na">high: 365</span>
<span class="na">medium: 90</span>
<span class="na">low: 30</span>
<span class="na">info: 7</span>
</pre></div>
</div>
</div>
<div class="section" id="section-cron-heartbeat">
<h4>[cron heartbeat] section<a class="headerlink" href="#section-cron-heartbeat" title="Permalink to this headline">¶</a></h4>
<p>This section allows to define the periodic deletion of heartbeats. The <em>age</em> parameter is used to define the minimal retention period (in days) for heartbeats. The oldest heartbeats will be deleted. The default is not to delete any heartbeat.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[cron heartbeat]</span>
<span class="na">age: 7</span>
</pre></div>
</div>
</div>
<div class="section" id="section-cron-search-history">
<h4>[cronsearch_history] section<a class="headerlink" href="#section-cron-search-history" title="Permalink to this headline">¶</a></h4>
<p>This section allows de define the periodic deletion of search history. The <em>size</em> parameter allow the configuration of the number of saved searches per user. This parameter is set to 10 by default.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[cron search_history]</span>
<span class="na">size: 10</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h4><strong>[include] section</strong><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>This section allows to include files. This section imports additional configuration files for the the <strong>Prelude GUI</strong>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[include]</span>
<span class="na">conf.d/*.conf</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-des-menus">
<h3>Menu settings<a class="headerlink" href="#configuration-des-menus" title="Permalink to this headline">¶</a></h3>
<p>This section describes how to set <strong>Prelude GUI</strong> menus.</p>
<p>By default, the <code class="file docutils literal notranslate"><span class="pre">/etc/prewikka/menu.yml</span></code> file is used to customize <strong>Prelude GUI</strong>’s menus.</p>
<p>The file to use is defined through the <strong>menu_order</strong> option of the <cite>prewikka.conf</cite> file.</p>
<p>The format used is YAML, which represents menus in the form of lists and sublists. There are 3 levels of indentation:</p>
<ol class="arabic simple">
<li>A menu may have several categories;</li>
<li>A category may have several sections;</li>
<li>A section can have multiple tabs.</li>
</ol>
<p><em>Example:</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Menu1</span>
  <span class="l l-Scalar l-Scalar-Plain">categories</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Categorie 1</span>
        <span class="l l-Scalar l-Scalar-Plain">sections</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Section 1</span>
              <span class="l l-Scalar l-Scalar-Plain">tabs</span><span class="p p-Indicator">:</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Onglet 1</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Onglet 2</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Section 2</span>
              <span class="l l-Scalar l-Scalar-Plain">tabs</span><span class="p p-Indicator">:</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Onglet 1</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Onglet 2</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Menu2</span>
  <span class="l l-Scalar l-Scalar-Plain">categories</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sections</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Section 1</span>
              <span class="l l-Scalar l-Scalar-Plain">tabs</span><span class="p p-Indicator">:</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Onglet 1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A category may not have a name, the <em>Menu2</em> category does not.</p>
</div>
<p>Keywords can be added at certain levels to further customize the menu.</p>
<table border="1" class="docutils" id="keywords-available-from-the-menu-customization">
<caption><span class="caption-text">Keywords available from the menu customization</span><a class="headerlink" href="#keywords-available-from-the-menu-customization" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Keyword</th>
<th class="head">Indentation level</th>
<th class="head">Possible value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>icon</td>
<td>1 and 2</td>
<td>Those on <a class="reference external" href="http://fontawesome.io/icons/">http://fontawesome.io/icons/</a></td>
<td>Allows you to add an icon to the menu entry.</td>
</tr>
<tr class="row-odd"><td>default</td>
<td>1</td>
<td>true</td>
<td>Allows you to define a default menu where the views that do not have an entry in the menu will be stored.</td>
</tr>
<tr class="row-even"><td>default_tab</td>
<td>3</td>
<td>Name of the default tab (name of the view)</td>
<td>Allows you to set the default tab of a section.</td>
</tr>
<tr class="row-odd"><td>expand</td>
<td>3</td>
<td>true</td>
<td>Allows you to specify that the section contains several views to be displayed in the menu, by unfolding the menu when hovering the mouse.</td>
</tr>
</tbody>
</table>
<p><em>Example:</em></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Utilisateur</span>
  <span class="l l-Scalar l-Scalar-Plain">icon</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">user</span>
  <span class="l l-Scalar l-Scalar-Plain">categories</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sections</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Préférences</span>
              <span class="l l-Scalar l-Scalar-Plain">icon</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">key</span>
              <span class="l l-Scalar l-Scalar-Plain">expand</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
              <span class="l l-Scalar l-Scalar-Plain">default_tab</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Permissions</span>
              <span class="l l-Scalar l-Scalar-Plain">tabs</span><span class="p p-Indicator">:</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Changer mot de passe</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Timezone</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Permissions</span>
                  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Changer e-mail</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Autres</span>
  <span class="l l-Scalar l-Scalar-Plain">icon</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">question</span>
  <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration-additionnelle-fichier-external-app-conf">
<h3>Additional configuration: external_app.conf file<a class="headerlink" href="#configuration-additionnelle-fichier-external-app-conf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="section-appli-app1">
<h4>[appli app1] section<a class="headerlink" href="#section-appli-app1" title="Permalink to this headline">¶</a></h4>
<p>It is possible to declare external applications and display them inside <strong>Prelude GUI</strong> through an iframe.</p>
<p>These settings are required when importing an application:</p>
<table border="1" class="docutils" id="configuration-of-an-external-application">
<caption><span class="caption-text">Configuration of an external application</span><a class="headerlink" href="#configuration-of-an-external-application" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>permission</td>
<td>Existing or custom permission. Non-existing permissions are created on the fly.</td>
</tr>
<tr class="row-odd"><td>section</td>
<td>Name of the section to store the application. Refer to <span class="xref std std-ref">Menu settings</span></td>
</tr>
<tr class="row-even"><td>base_url</td>
<td>URL of the external application</td>
</tr>
<tr class="row-odd"><td>tab</td>
<td>Name of the view tabs, each view can have one or more tabs. Refer to <span class="xref std std-ref">Menu settings</span></td>
</tr>
<tr class="row-even"><td>tab_html</td>
<td>URLs for tabs, absolute or relative based on <em>base_url</em></td>
</tr>
<tr class="row-odd"><td>help</td>
<td>Link provided in the contextual link</td>
</tr>
</tbody>
</table>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[appli app1]</span>
<span class="na">permission: APP1_VIEW</span>
<span class="na">section: Application1</span>
<span class="na">base_url: http://app1/</span>
<span class="na">tab: tab1, tab2</span>
<span class="na">tab_url: http://app1/tab1, http://app1/tab2</span>
<span class="na">help: http://app1/help.html</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-additionnelle-fichier-logs-conf">
<h3>Additional configuration: logs.conf file<a class="headerlink" href="#configuration-additionnelle-fichier-logs-conf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="sections-elasticsearch">
<h4>[elasticsearch] sections<a class="headerlink" href="#sections-elasticsearch" title="Permalink to this headline">¶</a></h4>
<p>Prelude SIEM uses the Elasticsearch solution for log management. For more information about this solution, refer to its documentation: <a class="reference external" href="https://www.elastic.co/guide/index.html">https://www.elastic.co/guide/index.html</a></p>
<p>It is possible to configure the date format expected by Elasticsearch. By default, the date format is ISO.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">es_timeformat: %Y-%m-%d %H:%M:%S</span>
</pre></div>
</div>
<p>A section should provide:</p>
<ul class="simple">
<li><strong>es_type</strong>: instance type (“log” in case of logs);</li>
<li><strong>es_url</strong>: URL, with the index, of Elasticsearch;</li>
<li><strong>es_user</strong>: user name required for connection;</li>
<li><strong>es_pass</strong>: password required for login.</li>
</ul>
<p><em>Example:</em></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[elasticsearch log1]</span>
<span class="na">es_url: http://my-elasticsearch:9200/index-*</span>
<span class="na">es_type: log</span>
<span class="na">es_user:</span>
<span class="na">es_pass:</span>
</pre></div>
</div>
<p>It is possible to configure several sections of this type, typically for managing a multi-tenant organization. In this example, “log1” is the name which will be used in the GUI for identifying this instance.</p>
<p>Port <em>9200</em> is the default port of Elasticsearch, and must be changed to match the value set when you installed and configured Elasticsearch.</p>
<p>Indexes can contain wildcards.</p>
<p>This section also contain fields defined by the Elasticsearch indexes and those recognized by <strong>Prelude GUI</strong>. Here, a key can have up to two values, thus enabling the field to be used during a standard query and an aggregated query. If only one field is entered, or if the second field does not match what is found in the result of the aggregated query, the first field will be used:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">program: syslog_program, syslog_program.raw</span>
<span class="na">host: syslog_hostname, syslog_hostname.raw</span>
<span class="na">message: syslog_message</span>
<span class="na">timestamp: @timestamp</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The configuration file contains, by default, the fields required for logs. However, your Elasticsearch indexes may have more fields. If you want these fields to appear in the <span class="guilabel">Archive</span> interface, it is up to you to add them in the configuration, using the same system as above.</p>
</div>
</div>
</div>
<div class="section" id="configuration-additionnelle-fichiers-auth-conf">
<h3>Additional configuration: auth.conf file<a class="headerlink" href="#configuration-additionnelle-fichiers-auth-conf" title="Permalink to this headline">¶</a></h3>
<p><strong>The session modules</strong></p>
<div class="section" id="section-session-loginform">
<h4>[session loginform] section<a class="headerlink" href="#section-session-loginform" title="Permalink to this headline">¶</a></h4>
<p>Allows you to log on from the authentication form. The user enters his or her username and password in a standard web form.</p>
<p>The value of the <strong>expiration</strong> key determines, in minutes, the duration of a session before expiration.</p>
<p>The value of the <strong>footer</strong> key controls the contents of the page footer. The <strong>$version</strong> variable will be replaced by the product version.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">expiration: 60</span>
<span class="na">footer: Prelude SIEM $version</span>
</pre></div>
</div>
</div>
<div class="section" id="section-session-anonymous">
<h4>[session anonymous] section<a class="headerlink" href="#section-session-anonymous" title="Permalink to this headline">¶</a></h4>
<p>This section disables the <strong>Prelude GUI</strong> authentication, so authentication is notrequired. Commented by default to force the authentication.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[session anonymous]</span>
</pre></div>
</div>
<p><strong>The authentication modules</strong></p>
<p>Retrieve the list of the <strong>Prelude GUI</strong> users through two kind of backend: database or LDAP.</p>
</div>
<div class="section" id="section-auth-dbauth">
<h4>[auth dbauth] section<a class="headerlink" href="#section-auth-dbauth" title="Permalink to this headline">¶</a></h4>
<p>Only users in the <strong>Prelude GUI</strong> database are allowed to connect.</p>
<p>If there is no user with administrative rights defined in the database, the initial userwill be created according to these settings:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[auth dbauth]</span>
<span class="na">initial_admin_user: admin</span>
<span class="na">initial_admin_pass: admin</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-additionnelle-fichier-alerts-conf">
<h3>Additional configuration: alerts.conf file<a class="headerlink" href="#configuration-additionnelle-fichier-alerts-conf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="section-datasearch-alert">
<h4>[datasearch alert] section<a class="headerlink" href="#section-datasearch-alert" title="Permalink to this headline">¶</a></h4>
<p>This section is used to add complementary fields in the alert table. It is possible to add any IDMEF field.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">extra_fields</span> <span class="o">=</span> <span class="s">alert.messageid, alert.classification.text</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-additionnelle-fichier-riskoverview-conf">
<h3>Additional configuration: riskoverview.conf file<a class="headerlink" href="#configuration-additionnelle-fichier-riskoverview-conf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="section-riskoverview">
<h4>[riskoverview] section<a class="headerlink" href="#section-riskoverview" title="Permalink to this headline">¶</a></h4>
<p>This section is used to enable or disable entries in the <strong>Risk Overview</strong>.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">agents</span>
<span class="na">tickets</span>
<span class="na">archive</span>
<span class="na">threats</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="glossaire-et-abreviations">
<h1>Glossary &amp; abbreviations<a class="headerlink" href="#glossaire-et-abreviations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="glossaire">
<h2>Glossary<a class="headerlink" href="#glossaire" title="Permalink to this headline">¶</a></h2>
<p>List of terms used by <strong>Prelude SIEM</strong>. Several terms derive from the <strong>IDMEF</strong> standard.</p>
<dl class="glossary docutils">
<dt id="term-agent">Agent</dt>
<dd>A software or equipment using the Libprelude able to directly generate IDMEF alerts and heartbeats. It can be an analyzer or a manager.</dd>
<dt id="term-alerte">Alert</dt>
<dd><p class="first">A data structure describing a security incident technically. It contains information about:</p>
<ul class="simple">
<li>Its classification;</li>
<li>The sensor from which it originates;</li>
<li>The time of detection/creation;</li>
<li>Its source and its target;</li>
<li>Its assessment (impact of the event).</li>
</ul>
<p class="last">It can be a simple alert or the grouping of related alerts into a “correlated alert”.</p>
</dd>
<dt id="term-analyseur-sonde">Analyzer / Sensor</dt>
<dd><p class="first">The emission source of an alert message.</p>
<p class="last">This definition can be extended to cover not only Prelude agents (Prelude LML, Prelude Correlator, Snort, Samhain, etc.) but also services (web server, PAM, ssh, antivirus, etc.) that write in logs instead of emitting alerts.</p>
</dd>
<dt id="term-chemin">Path</dt>
<dd><p class="first">In Prelude SIEM, the paths correspond to a simple syntax that can be used to reference the value of a field in a data structure (IDMEF alert, log entry, incident ticket, etc.). With this mechanism you can update or retrieve the value the path points to.</p>
<p class="last">In particular, all classes and attributes defined in the <span class="target" id="index-5"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc4765.html"><strong>IDMEF</strong></a> can be converted to paths usable by Prelude SIEM. For instance, the path <code class="docutils literal notranslate"><span class="pre">alert.classification.text</span></code> can be used to reference the <code class="docutils literal notranslate"><span class="pre">text</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">Classification</span></code> IDMEF class, the latter being an aggregated class of the <code class="docutils literal notranslate"><span class="pre">Alert</span></code> IDMEF class.</p>
</dd>
<dt id="term-jeu-de-regles">Ruleset</dt>
<dd>A ruleset is a file containing a set of rules related to the same functional field (software, equipment, etc.).</dd>
<dt id="term-libprelude">Libprelude</dt>
<dd>Libprelude is a programming library that guarantees secure connections between Prelude analyzers (Prelude LML, Prelude Correlator, Snort, etc.) and the Prelude Manager. Libprelude provides an API for communication with Prelude sub-systems. It supplies the necessary functionality for generating and emitting IDMEF alerts and automates the saving and re-transmission of data in times of temporary interruption of one of the system’s components.</dd>
<dt id="term-libpreludedb">LibpreludeDB</dt>
<dd>The libpreludeDB programming library provides an abstraction layer upon the type and the format of the database used to store IDMEF alerts. It allows developers to use the Prelude SIEM database easily and efficiently without worrying about its type or storage format.</dd>
<dt id="term-localisation">Location</dt>
<dd><p class="first">The physical site of one or several nodes.</p>
<p class="last">Example: Paris</p>
</dd>
<dt id="term-noeud">Node</dt>
<dd><p class="first">An equipment that hosts one or several analyzers/managers, identified by a network address or a name.</p>
<p class="last">Example: 192.168.2.1</p>
</dd>
<dt id="term-prelude-correlator">Prelude Correlator</dt>
<dd>Prelude Correlator allows conducting multi-stream correlation thanks to a powerful programming language for writing correlation rules. It has the ability to connect and fetch alerts from a remote Prelude Manager, and correlate incoming alerts based on the provided ruleset. Upon successful correlation, IDMEF correlation alerts are raised.</dd>
<dt id="term-prelude-gui">Prelude GUI</dt>
<dd>Prelude GUI is the official graphical user interface for Prelude SIEM exploitation. Providing numerous features, it facilitates the work of operators and analysts, and also provides access to external tools.</dd>
<dt id="term-prelude-lml">Prelude LML</dt>
<dd>Prelude LML is a log analyzer allowing Prelude SIEM to collect and analyze information from all kinds of sources (applications or appliances) emitting logs or syslog messages, in order to detect suspicious activities and normalize them to IDMEF format.</dd>
<dt id="term-prelude-manager">Prelude Manager</dt>
<dd><p class="first">Prelude Manager is the heart of Prelude SIEM and is generally called <em>manager</em>. It concentrates all IDMEF messages from agents, be it alerts or heartbeats.</p>
<p class="last">The manager processes the received data in real time by inserting them for example into a database. It can also act as a relay, i.e. forward the messages to another manager. It is also responsible of transmitting alerts to the correlator.</p>
</dd>
<dt id="term-pulsation">Heartbeat</dt>
<dd><p class="first">A message sent in at regular intervals by agents to their attributed managers, in order to indicate their status (starting, running, stopping, etc).</p>
<p class="last">The lack of some number of consecutive heartbeats indicates a failure of either the agent or its network connection.</p>
</dd>
<dt id="term-syslog">Syslog</dt>
<dd>In computing, Syslog is a standard for message logging. It allows separation of the software that generates messages, the system that stores them, and the software that reports and analyzes them.</dd>
</dl>
</div>
<div class="section" id="abreviations">
<h2>Abbreviations<a class="headerlink" href="#abreviations" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils" id="definitions-of-abbreviations">
<caption><span class="caption-text">Definitions of abbreviations</span><a class="headerlink" href="#definitions-of-abbreviations" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Abbreviations</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>API</td>
<td>Application Programming Interface</td>
</tr>
<tr class="row-odd"><td>HIDS</td>
<td>Host Intrusion Detection System</td>
</tr>
<tr class="row-even"><td>IDS</td>
<td>Intrusion Detection System</td>
</tr>
<tr class="row-odd"><td>IDMEF</td>
<td>Intrusion Detection Message Exchange Format</td>
</tr>
<tr class="row-even"><td>LML</td>
<td>Log Monitoring Lackey</td>
</tr>
<tr class="row-odd"><td>HMI</td>
<td>Human to Machine Interface</td>
</tr>
<tr class="row-even"><td>NIDS</td>
<td>Network Intrusion Detection System</td>
</tr>
<tr class="row-odd"><td>PCRE</td>
<td>Perl Compatible Regular Expression</td>
</tr>
<tr class="row-even"><td>SIEM</td>
<td>Security Information &amp; Event Management</td>
</tr>
<tr class="row-odd"><td>SOC</td>
<td>Security Operations Center</td>
</tr>
<tr class="row-even"><td>TLS</td>
<td>Transport Layer Security</td>
</tr>
<tr class="row-odd"><td>N/A</td>
<td>Not applicable</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="annexe-criteres-et-chemins-idmef">
<h1>Annex: IDMEF criteria and paths<a class="headerlink" href="#annexe-criteres-et-chemins-idmef" title="Permalink to this headline">¶</a></h1>
<div class="section" id="criteres-idmef">
<h2>IDMEF criteria<a class="headerlink" href="#criteres-idmef" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creation-de-filtre-a-l-aide-de-criteres-idmef">
<h3>Filter creation with IDMEF criteria<a class="headerlink" href="#creation-de-filtre-a-l-aide-de-criteres-idmef" title="Permalink to this headline">¶</a></h3>
<p>IDMEF criteria are filters on IDMEF fields. Several Prelude SIEM components use IDMEF criteria:</p>
<ul class="simple">
<li>Prelude Manager is distributed with the <code class="docutils literal notranslate"><span class="pre">idmef-criteria</span></code> plugin, which can be installed and used with IDMEF criteria. It is possible to define specific actions to be executed based on an incoming event (relaying, storage in a specific database, etc.).</li>
<li>Prelude GUI allows the user to define criteria in order to filter the results of a search or an analysis.</li>
</ul>
</div>
<div class="section" id="syntaxe-des-criteres-idmef">
<h3>IDMEF criteria syntax<a class="headerlink" href="#syntaxe-des-criteres-idmef" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">IDMEF</span> <span class="n">Path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">operator</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Simple example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">alert.analyzer(-1).name</span> <span class="o">=</span> <span class="s">&#39;MySensor&#39;</span>
</pre></div>
</div>
<p><em>AND</em> and <em>OR</em> operators can be used:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">alert.analyzer(-1).name</span> <span class="o">=</span> <span class="s">&#39;My Sensor&#39; &amp;&amp; (&#39;alert.assessment.impact.severity</span>
<span class="o">=</span> <span class="s">&#39;high&#39; || alert.assessment.impact.completion = &#39;succeeded&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="chemins-idmef">
<h2>IDMEF paths<a class="headerlink" href="#chemins-idmef" title="Permalink to this headline">¶</a></h2>
<p>In Prelude SIEM, an IDMEF path is a pointer to a specific value in an IDMEF message.</p>
<p>Using this pointer, you can update or retrieve the value pointed by that path.</p>
<p>Any class specified in the <a class="reference external" href="https://www.ietf.org/rfc/rfc4765.txt">IDMEF RFC</a> can be converted to an IDMEF path.</p>
<div class="section" id="correspondance-des-classes-idmef-et-des-chemins-idmef">
<h3>Mapping an IDMEF class to an IDMEF path<a class="headerlink" href="#correspondance-des-classes-idmef-et-des-chemins-idmef" title="Permalink to this headline">¶</a></h3>
<p>When mapping an IDMEF class to a IDMEF path, you should obey the following rules:</p>
<ul class="simple">
<li>IDMEF paths must be written in lowercase;</li>
<li>Subsequent elements of an access path must be separated using dots <code class="docutils literal notranslate"><span class="pre">.</span></code>;</li>
<li>Wherever the IDMEF class uses uppercase letters for word separation, Prelude SIEM uses an underscore <code class="docutils literal notranslate"><span class="pre">_</span></code>;</li>
<li>In case a path element is a list, you can use a specific index between brackets to access the element, for example: <code class="docutils literal notranslate"><span class="pre">alert.source(0).node.name</span></code>.</li>
</ul>
</div>
<div class="section" id="elements-indexes">
<h3>Indexed elements<a class="headerlink" href="#elements-indexes" title="Permalink to this headline">¶</a></h3>
<p>When accessing a list (e.g.: <code class="docutils literal notranslate"><span class="pre">alert.source</span></code>, <code class="docutils literal notranslate"><span class="pre">alert.additional_data</span></code>, etc.), the index must be specified as a number. When retrieving a value, the specified index must exist in the list.</p>
<p>In the context of an assignment, the first unassigned index of the list can also be used. For example, if <code class="docutils literal notranslate"><span class="pre">alert.source(0)</span></code> and <code class="docutils literal notranslate"><span class="pre">alert.source(1)</span></code> are defined, you may use either 0, 1, or 2 as the index to assign data, but not 3.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>You may also use negative indexes (-1, -2, -n, …) to access elements starting from the end of the list.</p>
<p class="last">In this case, -1 points to the last element of the list, -2 to the penultimate, etc.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Additionally, in the context of an assignment, you might use the <strong>&gt;&gt;</strong> (append) or <strong>&lt;&lt;</strong> (prepend) operators.</p>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">alert.source(&gt;&gt;).interface</span> <span class="o">=</span> <span class="s">eth1</span>
<span class="na">alert.source(-1).node.name</span> <span class="o">=</span> <span class="s">myNode</span>
</pre></div>
</div>
<p>The example above appends a new source object to the <em>alert.source</em> list, by setting the value of the <em>interface</em> attribute to <em>eth1</em>. It then sets the <em>node.name</em> attribute of this new entry to <em>myNode</em>.</p>
</div>
</div>
</div>
<div class="section" id="annexe-fichiers-de-configuration">
<h1>Annex: Configuration files<a class="headerlink" href="#annexe-fichiers-de-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fichier-de-configuration-global-global-conf">
<h2>Global configuration file: global.conf<a class="headerlink" href="#fichier-de-configuration-global-global-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[prelude]</span>

<span class="c1"># This is the default configuration for all programs</span>
<span class="c1"># (sensors, agents, and manager) using libprelude.</span>
<span class="c1">#</span>
<span class="c1"># Entry in this configuration file might be overriden by entry directly</span>
<span class="c1"># provided by the respective program configuration file.</span>

<span class="c1">#</span>
<span class="c1"># Set heartbeat interval, the default value is 600 seconds (10 minutes).</span>
<span class="c1">#</span>
<span class="c1"># heartbeat-interval = 600</span>


<span class="c1">#</span>
<span class="c1"># Optional data carried with alert/heartbeats.</span>
<span class="c1">#</span>
<span class="c1"># analyzer-name = Name for the analyzer</span>
<span class="c1"># node-name = Name of the equipment</span>
<span class="c1"># node-location = Location of the equipment</span>
<span class="c1"># node-category = Type of node:</span>
<span class="c1">#</span>
<span class="c1"># unknown            Domain unknown or not relevant</span>
<span class="c1"># ads                Windows 2000 Advanced Directory Services</span>
<span class="c1"># afs                Andrew File System (Transarc)</span>
<span class="c1"># coda               Coda Distributed File System</span>
<span class="c1"># dfs                Distributed File System (IBM)</span>
<span class="c1"># dns                Domain Name System</span>
<span class="c1"># hosts              Local hosts file</span>
<span class="c1"># kerberos           Kerberos realm</span>
<span class="c1"># nds                Novell Directory Services</span>
<span class="c1"># nis                Network Information Services (Sun)</span>
<span class="c1"># nisplus            Network Information Services Plus (Sun)</span>
<span class="c1"># nt                 Windows NT domain</span>
<span class="c1"># wfw                Windows for Workgroups</span>


<span class="c1"># Address contained by this node,</span>
<span class="c1"># You may have several addresses.</span>
<span class="c1">#</span>
<span class="c1"># [Node-Address]</span>
<span class="c1">#</span>
<span class="c1"># address = Address of the equipment</span>
<span class="c1"># netmask = Netmask for this address</span>
<span class="c1"># vlan-name = Name of the Virtual LAN to which the address belongs</span>
<span class="c1"># vlan-num = Number of the Virtual LAN to which the address belongs</span>
<span class="c1">#</span>
<span class="c1"># category = Type of address represented</span>
<span class="c1">#</span>
<span class="c1"># Permitted values for category are (default to unknown) :</span>
<span class="c1">#</span>
<span class="c1"># unknown            Address type unknown</span>
<span class="c1"># atm                Asynchronous Transfer Mode network address</span>
<span class="c1"># e-mail             Electronic mail address (RFC 822)</span>
<span class="c1"># lotus-notes        Lotus Notes e-mail address</span>
<span class="c1"># mac                Media Access Control (MAC) address</span>
<span class="c1"># sna                IBM Shared Network Architecture (SNA) address</span>
<span class="c1"># vm                 IBM VM (&quot;PROFS&quot;) e-mail address</span>
<span class="c1"># ipv4-addr          IPv4 host address in dotted-decimal notation (a.b.c.d)</span>
<span class="c1"># ipv4-addr-hex      IPv4 host address in hexadecimal notation</span>
<span class="c1"># ipv4-net           IPv4 network address in dotted-decimal notation, slash, significant bits (a.b.c.d/nn)</span>
<span class="c1"># ipv4-net-mask      IPv4 network address in dotted-decimal notation, slash, network mask in dotted-decimal notation (a.b.c.d/w.x.y.z)</span>
<span class="c1"># ipv6-addr          IPv6 host address</span>
<span class="c1"># ipv6-addr-hex      IPv6 host address in hexadecimal notation</span>
<span class="c1"># ipv6-net           IPv6 network address, slash, significant bits</span>
<span class="c1"># ipv6-net-mask      IPv6 network address, slash, network mask</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-client-client-conf">
<h2>Client configuration file: client.conf<a class="headerlink" href="#fichier-de-configuration-client-client-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[prelude]</span>

<span class="c1"># This is the default configuration for program client of a manager</span>
<span class="c1"># (sensors and agents) that uses libprelude.</span>
<span class="c1">#</span>
<span class="c1"># Entry in this configuration file might be overriden by entry directly</span>
<span class="c1"># provided by the sensors/agents configuration file.</span>


<span class="c1"># Try to connect on a Manager listening on 127.0.0.1.</span>
<span class="c1">#</span>
<span class="c1"># server-addr = x.x.x.x:port || y.y.y.y &amp;&amp; z.z.z.z</span>
<span class="c1">#</span>
<span class="c1"># This mean the emission should occur on x.x.x.x:port or, if it fail,</span>
<span class="c1"># on y.y.y.y and z.z.z.z (if one of the two host in the AND fail,</span>
<span class="c1"># the emission will be considered as failed involving saving the</span>
<span class="c1"># message locally).</span>

<span class="na">server-addr</span> <span class="o">=</span> <span class="s">127.0.0.1</span>


<span class="c1"># The following settings instruct the operating system when to consider</span>
<span class="c1"># a connection dead in case sent data is left unacknowledged.</span>
<span class="c1">#</span>
<span class="c1"># These options are operating system specific, and might not work on</span>
<span class="c1"># certain platform. In case you modify these settings on an unsupported</span>
<span class="c1"># system, a warning message will be issued when the agent starts.</span>
<span class="c1">#</span>
<span class="c1"># Under Linux, the default system wide configuration is:</span>
<span class="c1"># tcp-keepalive-time   = 7200</span>
<span class="c1"># tcp-keepalive-probes = 9</span>
<span class="c1"># tcp-keepalive-intvl  = 75</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-time represents the number of seconds the connection</span>
<span class="c1"># needs to be idle before TCP begins sending out keep-alive probes.</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-probes represents the number of not acknowledged probes</span>
<span class="c1"># to send before considering the connection dead.</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-intvl represents the interval between subsequent</span>
<span class="c1"># keepalive probes.</span>
<span class="c1">#</span>
<span class="c1"># The average time to notice a dead connection can be calculated using:</span>
<span class="c1"># tcp-keepalive-time + (tcp-keepalive-probes * tcp-keepalive-intvl)</span>
<span class="c1">#</span>
<span class="c1"># Here is an example configuration:</span>
<span class="c1"># tcp-keepalive-time   = 60</span>
<span class="c1"># tcp-keepalive-probes = 3</span>
<span class="c1"># tcp-keepalive-intvl  = 10</span>
<span class="c1">#</span>
<span class="c1"># Using the above settings, a dead connection will be detected within</span>
<span class="c1"># 90 seconds.</span>


<span class="c1">#</span>
<span class="c1"># TLS options (only available with GnuTLS 2.2.0 or higher):</span>
<span class="c1">#</span>
<span class="c1"># Sets priorities for the ciphers, key exchange methods, macs and</span>
<span class="c1"># compression methods.</span>
<span class="c1">#</span>
<span class="c1"># &quot;NORMAL&quot; option enables all &quot;secure&quot; ciphersuites. The 256-bit</span>
<span class="c1"># ciphers are included as a fallback only. The ciphers are sorted by</span>
<span class="c1"># security margin.</span>
<span class="c1">#</span>
<span class="c1"># &quot;SECURE128&quot; flag enables all &quot;secure&quot; ciphersuites with ciphers up to</span>
<span class="c1"># 128 bits, sorted by security margin.</span>
<span class="c1">#</span>
<span class="c1"># &quot;SECURE256&quot; flag enables all &quot;secure&quot; ciphersuites including the 256</span>
<span class="c1"># bit ciphers, sorted by security margin.</span>
<span class="c1">#</span>
<span class="c1"># &quot;EXPORT&quot; all the ciphersuites are enabled, including the low-security</span>
<span class="c1"># 40 bit ciphers.</span>
<span class="c1">#</span>
<span class="c1"># &quot;NONE&quot; nothing is enabled. This disables even protocols and</span>
<span class="c1"># compression methods.</span>
<span class="c1">#</span>
<span class="c1"># Note that much more settings might be enabled or disabled using this</span>
<span class="c1"># option: please see gnutls_priority_init(3) for more details.</span>
<span class="c1">#</span>
<span class="c1"># The default settings is &quot;NORMAL&quot;.</span>
<span class="c1"># tls-options = NORMAL</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-client-idmef-idmef-client-conf">
<h2>IDMEF client configuration file: idmef-client.conf<a class="headerlink" href="#fichier-de-configuration-client-idmef-idmef-client-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">include</span> <span class="o">=</span> <span class="s">/usr/local/etc/prelude/default/global.conf</span>
<span class="na">include</span> <span class="o">=</span> <span class="s">/usr/local/etc/prelude/default/client.conf</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-tls-tls-conf">
<h2>TLS configuration file: tls.conf<a class="headerlink" href="#fichier-de-configuration-tls-tls-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Default size of the client/server generated private key</span>
<span class="c1">#</span>
<span class="na">generated-key-size</span> <span class="o">=</span> <span class="s">2048</span>

<span class="c1">#</span>
<span class="c1"># Number of days the authority certificates (server side) will</span>
<span class="c1"># remain valid. These certificates are only used in order to</span>
<span class="c1"># sign client certificate.</span>
<span class="c1">#</span>
<span class="c1"># Use 0 for the maximum possible value.</span>
<span class="c1">#</span>
<span class="na">authority-certificate-lifetime</span> <span class="o">=</span> <span class="s">0</span>

<span class="c1">#</span>
<span class="c1"># Number of days the generated certificates (client side) will</span>
<span class="c1"># remain valid. These certificates are only used in order to</span>
<span class="c1"># authenticate and encrypt client &lt;-&gt; server communication.</span>
<span class="c1">#</span>
<span class="c1"># Use 0 for the maximum possible value.</span>
<span class="c1">#</span>
<span class="na">generated-certificate-lifetime</span> <span class="o">=</span> <span class="s">0</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-de-prelude-manager-prelude-manager-conf">
<h2>Prelude Manager configuration file: prelude-manager.conf<a class="headerlink" href="#fichier-de-configuration-de-prelude-manager-prelude-manager-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prelude Manager configuration file.</span>
<span class="c1">#</span>
<span class="c1"># &lt;IMPORTANT&gt;</span>
<span class="c1">#</span>
<span class="c1"># Sections are important, and things won&#39;t work correctly if they are</span>
<span class="c1"># not un-commented. For example you need to uncomment [db] if you want</span>
<span class="c1"># the database plugin to be loaded.</span>
<span class="c1">#</span>
<span class="c1"># &lt;/IMPORTANT&gt;</span>


<span class="na">include</span> <span class="o">=</span> <span class="s">@LIBPRELUDE_CONFIG_PREFIX@/default/global.conf</span>


<span class="c1"># Address where the prelude-manager server is listening on.</span>
<span class="c1"># if value is unix, or unix:/path/to/unix/socket, an UNIX domain socket</span>
<span class="c1"># will be used.</span>
<span class="c1">#</span>
<span class="c1"># Multiple listen address are supported.</span>
<span class="c1">#</span>
<span class="c1"># listen = address:port</span>
<span class="c1"># listen = unix:/tmp/prelude-manager.socket</span>
<span class="c1"># listen = unix</span>
<span class="c1">#</span>
<span class="na">listen</span> <span class="o">=</span> <span class="s">127.0.0.1</span>


<span class="c1"># Sets the user/group ID as which prelude-manager will run.</span>
<span class="c1"># In order to use this option, prelude-manager must be run initially as</span>
<span class="c1"># root</span>
<span class="c1">#</span>
<span class="c1"># user = prelude-manager</span>
<span class="c1"># group = prelude</span>


<span class="c1"># Number of seconds prelude-manager waits for an incoming client to</span>
<span class="c1"># successfully authenticate before dropping the connection.</span>
<span class="c1">#</span>
<span class="c1"># connection-timeout = 10</span>


<span class="c1">#</span>
<span class="c1"># Scheduler settings for Prelude-Manager</span>
<span class="c1">#</span>
<span class="c1"># On systems with many concurrent sensors sending events to</span>
<span class="c1"># Prelude-Manager, Prelude-Manager might have a hard time keeping up</span>
<span class="c1"># with the demand for events reporting.</span>
<span class="c1">#</span>
<span class="c1"># The Prelude Manager scheduler allocate reporting time per sensor,</span>
<span class="c1"># allowing to define the maximum number of events processed for one</span>
<span class="c1"># sensor before processing others sensors events (in case a sensor is</span>
<span class="c1"># sending a continuous events burst, this prevents other sensors&#39;</span>
<span class="c1"># starvation).</span>
<span class="c1">#</span>
<span class="c1"># By default, for each sensor connected, a maximum of 100 events will</span>
<span class="c1"># be processed before processing others sensors events.</span>
<span class="c1">#</span>
<span class="c1"># Additionally, priority will be given to events depending on their</span>
<span class="c1"># priority. Assuming there is enough events of each priority, 50 high</span>
<span class="c1"># priority messages will be processed, 30 medium, and 20 low (totalling</span>
<span class="c1"># the maximum of 100 described above).</span>
<span class="c1">#</span>
<span class="c1"># You might use the sched-priority option in order to change this</span>
<span class="c1"># setting:</span>
<span class="c1">#</span>
<span class="c1"># sched-priority = high:50 medium:30 low:20</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># When the number of events waiting to be processed exceeds the defined</span>
<span class="c1"># amount of reserved memory (default is 1 Megabyte), Prelude-Manager</span>
<span class="c1"># will start storing events on disk:</span>
<span class="c1">#</span>
<span class="c1"># sched-buffer-size = 1M</span>


<span class="c1">#</span>
<span class="c1"># TLS options (only available with GnuTLS 2.2.0 or higher):</span>
<span class="c1"># sets availables ciphers, key exchange methods, macs and compression</span>
<span class="c1"># methods.</span>
<span class="c1">#</span>
<span class="c1"># &quot;NORMAL&quot; option enables all &quot;secure&quot; ciphersuites, 256-bit ciphers</span>
<span class="c1"># included.</span>
<span class="c1">#</span>
<span class="c1"># &quot;SECURE128&quot; flag enables all &quot;secure&quot; ciphersuites with ciphers up to</span>
<span class="c1"># 128 bits.</span>
<span class="c1">#</span>
<span class="c1"># &quot;SECURE256&quot; flag enables all &quot;secure&quot; ciphersuites including the 256</span>
<span class="c1"># bit ciphers.</span>
<span class="c1">#</span>
<span class="c1"># &quot;EXPORT&quot; all the ciphersuites are enabled, including the low-security</span>
<span class="c1"># 40 bit ciphers.</span>
<span class="c1">#</span>
<span class="c1"># &quot;NONE&quot; nothing is enabled. This disables even protocols and</span>
<span class="c1"># compression methods.</span>
<span class="c1">#</span>
<span class="c1"># Note that much more settings might be enabled or disabled using this</span>
<span class="c1"># option: please see gnutls_priority_init(3) for more details.</span>
<span class="c1">#</span>
<span class="c1"># The default settings is &quot;NORMAL&quot;.</span>
<span class="c1"># tls-options = NORMAL</span>


<span class="c1">#</span>
<span class="c1"># Number of bits of the prime used in the Diffie Hellman key exchange.</span>
<span class="c1"># Note that the value should be one of 768, 1024, 2048, 3072 or 4096.</span>
<span class="c1"># The default is 1024.</span>
<span class="c1">#</span>
<span class="c1"># dh-prime-length = 1024</span>


<span class="c1"># How often to regenerate the parameters used in the Diffie Hellman key</span>
<span class="c1"># exchange. These should be discarded and regenerated once a day, once</span>
<span class="c1"># a week or once a month. Depending on the security requirements.</span>
<span class="c1">#</span>
<span class="c1"># Generation is a CPU intensive operation. The value is in hours,</span>
<span class="c1"># 0 disables regeneration entirely. The default is 24 hours.</span>
<span class="c1">#</span>
<span class="c1"># dh-parameters-regenerate = 24</span>


<span class="c1"># If you want this Manager to retrieve messages from another Manager</span>
<span class="c1"># (useful if the other Manager is located within a DMZ):</span>
<span class="c1">#</span>
<span class="c1"># child-managers = x.x.x.x</span>
<span class="c1">#</span>
<span class="c1"># This means the messages should be gathered from x.x.x.x</span>

<span class="c1">#</span>
<span class="c1"># If you want a given reporting plugin to be protected against possible</span>
<span class="c1"># failure, use the failover option. Failover will prevent data sent to</span>
<span class="c1"># the report plugin to be lost in case this one fail.</span>
<span class="c1">#</span>
<span class="c1"># You might use this option multiple time for different plugins.</span>
<span class="c1">#</span>
<span class="c1"># failover = name_of_plugin</span>


<span class="c1">#</span>
<span class="c1"># Events normalization parameters</span>
<span class="c1">#</span>
<span class="c1"># Un-comment the following section in case you want to define any</span>
<span class="c1"># normalization parameters:</span>
<span class="c1">#</span>
<span class="c1"># [normalize]</span>
<span class="c1">#</span>
<span class="c1"># For each incoming events, Prelude-Manager will run a number of</span>
<span class="c1"># normalization routine: sanitize address, services information, etc.</span>
<span class="c1">#</span>
<span class="c1"># When the normalizer sees an incoming IPv4 mapped IPv6 address, the</span>
<span class="c1"># default behavior is to map it back to raw IPv4. For example,</span>
<span class="c1"># ::ffff:192.168.0.1 will be mapped back to 192.168.0.1</span>
<span class="c1">#</span>
<span class="c1"># If you do not want IPv4 mapped IPv6 addresses, un-comment the</span>
<span class="c1"># following option:</span>
<span class="c1">#</span>
<span class="c1"># keep-ipv4-mapped-ipv6</span>
<span class="c1">#</span>
<span class="c1"># Alternatively, if you wish for any input IPv4 addresses to be</span>
<span class="c1"># converted to IPv6, un-comment the following option:</span>
<span class="c1">#</span>
<span class="c1"># ipv6-only</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Prelude-Manager normalizer can add geolocation information to events</span>
<span class="c1"># when libmaxminddb support is enabled, and the path to the maxminddb</span>
<span class="c1"># database is provided.</span>
<span class="c1">#</span>
<span class="c1"># geoip-database = /path/to/your/geoip_mmdb_file</span>


<span class="c1">####################################</span>
<span class="c1"># Here start plugins configuration #</span>
<span class="c1">####################################</span>

<span class="c1"># [relaying]</span>
<span class="c1">#</span>
<span class="c1"># If you want the message caught by this manager to be relayed.</span>
<span class="c1"># You can use boolean AND and OR to make the rule.</span>
<span class="c1">#</span>
<span class="c1"># parent-managers = x.x.x.x || y.y.y.y &amp;&amp; z.z.z.z</span>
<span class="c1">#</span>
<span class="c1"># This means the emission should occur on x.x.x.x or, if it fails, on</span>
<span class="c1"># y.y.y.y and z.z.z.z (if one of the two hosts in the AND fail, the</span>
<span class="c1"># emission will be considered as failed involving saving the message</span>
<span class="c1"># locally).</span>


<span class="c1"># [db]</span>

<span class="c1"># The type of database: mysql, pgsql or sqlite3.</span>
<span class="c1"># type = mysql</span>

<span class="c1"># Only if you use sqlite3.</span>
<span class="c1"># file = /your/path/to/your/db/idmef-db.sql</span>

<span class="c1"># Host the database is listening on.</span>
<span class="c1"># host = localhost</span>

<span class="c1"># Port the database is listening on.</span>
<span class="c1"># port = 3306</span>

<span class="c1"># Name of the database.</span>
<span class="c1"># name = prelude</span>

<span class="c1"># Username to be used to connect the database.</span>
<span class="c1"># user = prelude</span>

<span class="c1"># Password used to connect the database.</span>
<span class="c1"># pass = xxxxxx</span>



<span class="c1"># [XmlMod]</span>
<span class="c1">#</span>
<span class="c1"># The Xmlmod plugin allows to report alerts as IDMEF XML in a file,</span>
<span class="c1"># or to dump these alerts to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># The default behavior is to write output to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># Tells Xmlmod to disable output file buffering.</span>
<span class="c1"># This will prevent XML alerts to be truncated and thus make real-time</span>
<span class="c1"># parsing easier:</span>
<span class="c1">#</span>
<span class="c1"># disable-buffering</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Tells Xmlmod to check generated XML against IDMEF DTD:</span>
<span class="c1"># validate</span>
<span class="c1">#</span>
<span class="c1"># Tells Xmlmod to produce a pretty, human-readable xml output:</span>
<span class="c1"># format</span>
<span class="c1">#</span>
<span class="c1"># logfile = /dev/stdout</span>
<span class="c1"># logfile = /var/log/prelude/prelude-xml.log</span>



<span class="c1"># [Debug]</span>
<span class="c1">#</span>
<span class="c1"># The Debug plugin allows to report alerts as text in a file,</span>
<span class="c1"># or to dump these alerts to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># The default behavior is to write output to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># logfile = /dev/stdout</span>
<span class="c1"># logfile = /var/log/prelude/prelude-debug.log</span>
<span class="c1">#</span>
<span class="c1"># You can specify the name of the IDMEF object to print (you might</span>
<span class="c1"># select multiple objects). If no object is provided, &#39;Debug&#39; will</span>
<span class="c1"># print out the entire message.</span>
<span class="c1">#</span>
<span class="c1"># object = alert.classification.text, alert.source(0).node.address(0).address</span>


<span class="c1"># [TextMod]</span>
<span class="c1">#</span>
<span class="c1"># The TextMod plugin allows to report alerts as text in a file,</span>
<span class="c1"># or to dump these alerts to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># The default behavior is to write output to /dev/stdout.</span>
<span class="c1">#</span>
<span class="c1"># logfile = /dev/stdout</span>
<span class="c1"># logfile = /var/log/prelude/prelude-text.log</span>


<span class="c1"># [script]</span>
<span class="c1">#</span>
<span class="c1"># This plugin allows to execute commands depending on the received alerts.</span>
<span class="c1"># If an IDMEF path is prefixed by a dollar symbol, it will be replaced</span>
<span class="c1"># by the corresponding value in the alert.</span>
<span class="c1">#</span>
<span class="c1"># command = /path/to/the/script $alert.classification.text</span>


<span class="c1">#[smtp]</span>
<span class="c1">#</span>
<span class="c1"># Sender to use for the mail message.</span>
<span class="c1"># sender = prelude@myhostname.</span>
<span class="c1">#</span>
<span class="c1"># Who the mail should be sent to.</span>
<span class="c1"># recipients = recipient1@hostname, recipient2@hostname</span>
<span class="c1">#</span>
<span class="c1"># SMTP server to use for sending mail</span>
<span class="c1"># smtp-server = localhost</span>
<span class="c1">#</span>
<span class="c1"># By default, the SMTP plugin sends mail containing the whole IDMEF</span>
<span class="c1"># event. If you wish to send a subset of the information, you may</span>
<span class="c1"># customize the content of the generated mail through several options:</span>
<span class="c1">#</span>
<span class="c1"># You can define a specific subject to use with mail notification.</span>
<span class="c1"># The subject can include information from the event using IDMEF path.</span>
<span class="c1"># subject = Alert: $alert.classification.text</span>
<span class="c1">#</span>
<span class="c1"># You can define a specific message body to use for mail notification.</span>
<span class="c1"># As with the &quot;subject&quot; option, the template can include information</span>
<span class="c1"># from the event using IDMEF path.</span>
<span class="c1">#</span>
<span class="c1"># (Template example available in @DOCDIR@/smtp/template.example)</span>
<span class="c1"># template = /path/to/my/template</span>
<span class="c1">#</span>
<span class="c1"># You can provide your database settings here, so that the SMTP plugin</span>
<span class="c1"># retrieves alerts linked to received CorrelationAlert from the database.</span>
<span class="c1">#</span>
<span class="c1"># dbtype = mysql</span>
<span class="c1"># dbname = prelude</span>
<span class="c1"># dbuser = prelude</span>
<span class="c1"># dbpass = passwd</span>
<span class="c1"># dbhost = localhost</span>
<span class="c1"># Other database options available include dbport, and dbfile (for</span>
<span class="c1"># sqlite3 database).</span>
<span class="c1">#</span>
<span class="c1"># If you have specified your database settings above, you can also</span>
<span class="c1"># use the correlated-alert-template option, which is like the &quot;template&quot;</span>
<span class="c1"># option but is specific to Correlated Alerts retrieved from database.</span>
<span class="c1">#</span>
<span class="c1"># (Template example available in @DOCDIR@/smtp/template.example)</span>
<span class="c1"># correlated-alert-template = /path/to/my/template</span>


<span class="c1">#[snmp]</span>
<span class="c1">#</span>
<span class="c1"># Trap recipient.</span>
<span class="c1"># A specific port may be given using the suffix &quot;:port&quot;, eg. &quot;localhost:16162&quot;.</span>
<span class="c1"># To force the use of an IPv6 transport, add an &quot;udp6:&quot; prefix</span>
<span class="c1"># and put IPv6 addresses between brackets. Eg. &quot;udp6:[::1]&quot;.</span>
<span class="c1">#</span>
<span class="c1"># traphost = localhost</span>
<span class="c1">#</span>
<span class="c1"># Protocol version to use (either v1, v2c or v3).</span>
<span class="c1"># version = v3</span>
<span class="c1">#</span>
<span class="c1"># SNMP community (v1/v2c only).</span>
<span class="c1"># community = public</span>
<span class="c1">#</span>
<span class="c1"># Security username.</span>
<span class="c1"># sec-name = sec-name-not-configured</span>
<span class="c1">#</span>
<span class="c1"># Security level (either noAuthNoPriv, authNoPriv or authPriv).</span>
<span class="c1"># sec-level = authPriv</span>
<span class="c1">#</span>
<span class="c1"># Authentication protocol (either MD5 or SHA1).</span>
<span class="c1"># auth-protocol = SHA1</span>
<span class="c1">#</span>
<span class="c1"># Authentication passphrase.</span>
<span class="c1"># auth-key = snmp-authentication-key</span>
<span class="c1">#</span>
<span class="c1"># Privacy protocol (either DES or AES).</span>
<span class="c1"># priv-protocol = AES</span>
<span class="c1">#</span>
<span class="c1"># Privacy passphrase.</span>
<span class="c1"># priv-key = snmp-privacy-key</span>
<span class="c1">#</span>
<span class="c1"># Engine Identifier, as an hexadecimal string.</span>
<span class="c1"># The raw engine ID must be 5-32 characters long and unique across the network.</span>
<span class="c1"># If omitted, a new random identifier is automatically generated each time</span>
<span class="c1"># the manager starts.</span>
<span class="c1"># engineid = 0x1234567890</span>


<span class="c1">####################################</span>
<span class="c1"># Filtering plugins configuration  #</span>
<span class="c1">####################################</span>

<span class="c1"># The idmef-criteria filtering plugin allows you to filter events based</span>
<span class="c1"># on specific IDMEF-Criteria.</span>
<span class="c1">#</span>
<span class="c1"># [idmef-criteria]</span>
<span class="c1"># rule = alert.classification.text == &#39;User login successful&#39;</span>
<span class="c1"># hook = relaying[default]</span>
<span class="c1">#</span>
<span class="c1"># Will forward any event that match the defined criteria to the</span>
<span class="c1"># default instance of the relaying reporting plugin. The rule argument</span>
<span class="c1"># might also be a filename containing the rules. Example:</span>
<span class="c1">#</span>
<span class="c1"># rule = /path/to/rule.file</span>


<span class="c1"># The thresholding filtering plugin allows you to suppress events based</span>
<span class="c1"># on their value.</span>
<span class="c1">#</span>
<span class="c1"># [thresholding]</span>
<span class="c1"># path = alert.classification.text, alert.source.node.address.address</span>
<span class="c1"># limit = 3600</span>
<span class="c1"># count = 1</span>
<span class="c1"># hook = relaying[default]</span>
<span class="c1">#</span>
<span class="c1"># Will forward one event with the unique alert.classification.text,</span>
<span class="c1"># alert.source.node.address.address value combination to the &#39;default&#39;</span>
<span class="c1"># instance of the &#39;relaying&#39; reporting plugin. Further events with the</span>
<span class="c1"># same value will be suppressed for 3600 seconds.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># [thresholding]</span>
<span class="c1"># path = alert.classification.text, alert.source.node.address.address</span>
<span class="c1"># threshold = 3600</span>
<span class="c1"># count = 10</span>
<span class="c1"># hook = relaying[default]</span>
<span class="c1">#</span>
<span class="c1"># Will forward every tenth event per 3600 seconds with the unique</span>
<span class="c1"># alert.classification.text, alert.source.node.address.address value</span>
<span class="c1"># combination to the &#39;default&#39; instance of the &#39;relaying&#39; reporting</span>
<span class="c1"># plugin.</span>
<span class="c1">#</span>
<span class="c1"># Note that limit and threshold might be combined, allowing to setup a</span>
<span class="c1"># limit as soon as the first threshold is reached.</span>
<span class="c1">#</span>
<span class="c1"># By default, we only pass up to 100 occurrences of the same alert</span>
<span class="c1"># (same source, target and classification combination) every 2 minutes</span>
<span class="c1"># to reporting plugins (eg. to the database).</span>
<span class="k">[thresholding]</span>
<span class="na">path</span> <span class="o">=</span> <span class="s">alert.classification.text, alert.source.node.address.address, alert.target.node.address.address</span>
<span class="na">limit</span> <span class="o">=</span> <span class="s">120</span>
<span class="na">count</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">hook</span> <span class="o">=</span> <span class="s">reporting</span>


<span class="c1">####################################</span>
<span class="c1"># Prelude generic configuration    #</span>
<span class="c1">####################################</span>

<span class="c1"># [prelude]</span>
<span class="c1">#</span>
<span class="c1"># This is the global prelude section, where you can define Prelude</span>
<span class="c1"># related options. Option of matter for Prelude-Manager, are, most</span>
<span class="c1"># specifically, in the context of relaying, the connection options:</span>
<span class="c1">#</span>
<span class="c1"># The following settings instruct the operating system when to consider</span>
<span class="c1"># a connection dead in case sent data is left unacknowledged.</span>
<span class="c1">#</span>
<span class="c1"># These options are operating system specific, and might not work on</span>
<span class="c1"># certain platforms. In case you modify these settings on an unsupported</span>
<span class="c1"># system, a warning message will be issued when the agent starts.</span>
<span class="c1">#</span>
<span class="c1"># Under Linux, the default system wide configuration is:</span>
<span class="c1"># tcp-keepalive-time   = 7200</span>
<span class="c1"># tcp-keepalive-probes = 9</span>
<span class="c1"># tcp-keepalive-intvl  = 75</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-time represents the number of seconds the connection</span>
<span class="c1"># needs to be idle before TCP begins sending out keep-alive probes.</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-probes represents the number of not acknowledged probes</span>
<span class="c1"># to send before considering the connection dead.</span>
<span class="c1">#</span>
<span class="c1"># tcp-keepalive-intvl represents the interval between subsequent</span>
<span class="c1"># keepalive probes.</span>
<span class="c1">#</span>
<span class="c1"># The average time to notice a dead connection can be calculated using:</span>
<span class="c1"># tcp-keepalive-time + (tcp-keepalive-probes * tcp-keepalive-intvl)</span>
<span class="c1">#</span>
<span class="c1"># Here is an example configuration:</span>
<span class="c1"># tcp-keepalive-time   = 60</span>
<span class="c1"># tcp-keepalive-probes = 3</span>
<span class="c1"># tcp-keepalive-intvl  = 10</span>
<span class="c1">#</span>
<span class="c1"># Using the above settings, a dead connection will be detected within</span>
<span class="c1"># 90 seconds.</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-de-prelude-lml-prelude-lml-conf">
<h2>Prelude LML configuration file: prelude-lml.conf<a class="headerlink" href="#fichier-de-configuration-de-prelude-lml-prelude-lml-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################</span>
<span class="c1"># Configuration for the Prelude LML Sensor   #</span>
<span class="c1">##############################################</span>

<span class="na">include</span> <span class="o">=</span> <span class="s">@LIBPRELUDE_CONFIG_PREFIX@/default/idmef-client.conf</span>


<span class="c1"># Address where the Prelude Manager Server is listening on.</span>
<span class="c1"># if value is &quot;127.0.0.1&quot;, the connection will occur through</span>
<span class="c1"># a UNIX socket.</span>
<span class="c1">#</span>
<span class="c1"># This entry is disabled. The default is to use the entry</span>
<span class="c1"># located in the Prelude system-wide clients.conf. You may</span>
<span class="c1"># overwrite the default address for this sensor by uncommenting</span>
<span class="c1"># this entry.</span>
<span class="c1">#</span>
<span class="c1"># [prelude]</span>
<span class="c1"># server-addr = 127.0.0.1</span>


<span class="c1"># FILES TO MONITOR</span>
<span class="c1">#</span>
<span class="c1"># You should define the log message prefix-regex and time-format within</span>
<span class="c1"># a [format] section. If not specified, the default syslog format will</span>
<span class="c1"># be used.</span>
<span class="c1">#</span>
<span class="c1"># The prefix-regex should contain PCRE named subpatterns to pick out the</span>
<span class="c1"># information available in your syslog&#39;s prefix.</span>
<span class="c1">#</span>
<span class="c1"># The available field names are:</span>
<span class="c1">#   - hostname</span>
<span class="c1">#   - process</span>
<span class="c1">#   - pid</span>
<span class="c1">#   - timestamp</span>
<span class="c1">#</span>
<span class="c1"># Please see pcrepattern(3) manpage for help writing the prefix-regex.</span>
<span class="c1"># In order to set the time-format, please have a look at the strptime(3)</span>
<span class="c1"># manpage.</span>
<span class="c1">#</span>
<span class="c1"># Example configuration for syslog output:</span>
<span class="c1">#</span>
<span class="c1"># Each [format] section might have several file entries.</span>
<span class="c1"># Each [format] section might have several udp-server entries.</span>
<span class="c1">#</span>
<span class="c1"># If a file or udp-server entry is listed across different formats,</span>
<span class="c1"># then the first matching format for a given log entry will be used.</span>
<span class="c1">#</span>
<span class="c1"># Additionally, you can specify a pattern in a file entry. LML will then</span>
<span class="c1"># search for all the pathnames matching the pattern according to the rules</span>
<span class="c1"># used by the shell (see glob(7)).</span>
<span class="c1">#</span>
<span class="c1"># Example: file = /var/log/*/*.log</span>
<span class="c1">#</span>


<span class="c1"># CHARACTER ENCODING</span>
<span class="c1">#</span>
<span class="c1"># For each file added to a format, a character encoding can be specified</span>
<span class="c1"># using the &#39;charset&#39; option. Example:</span>
<span class="c1">#</span>
<span class="c1"># [format=MyFormat]</span>
<span class="c1"># charset = ISO-8859-1</span>
<span class="c1"># file = /var/log/log1</span>
<span class="c1"># file = /var/log/log2</span>
<span class="c1"># charset = UTF-8</span>
<span class="c1"># file = /var/log/log3</span>
<span class="c1"># file = /var/log/*.log</span>
<span class="c1"># udp-server = 0.0.0.0</span>
<span class="c1">#</span>
<span class="c1"># This will set the character set for &#39;log1&#39; and &#39;log2&#39; to ISO-8859-1, and</span>
<span class="c1"># to UTF-8 for &#39;log3&#39;, any file that matches &#39;/var/log/*.log&#39;, and any log</span>
<span class="c1"># entry read from the &#39;0.0.0.0&#39; integrated UDP server.</span>
<span class="c1">#</span>
<span class="c1"># Note that if no character encoding is specified, the system will attempt</span>
<span class="c1"># to automatically detect the encoding used. If the detection fails, then</span>
<span class="c1"># the system-wide default (retrieved from locale LC_CTYPE) will be used.</span>
<span class="c1">#</span>

<span class="c1"># ALTERING GENERATED IDMEF EVENTS</span>
<span class="c1">#</span>
<span class="c1"># Within each format, you might use the &#39;idmef-alter&#39; option to modify</span>
<span class="c1"># generated events:</span>
<span class="c1">#</span>
<span class="c1"># Example: idmef-alter = alert.analyzer(-1).node.location = MyLocation;</span>
<span class="c1">#</span>
<span class="c1"># Note that &#39;idmef-alter&#39; will never overwrite an IDMEF path that is</span>
<span class="c1"># already set. Use &#39;idmef-alter-force&#39; if this is what you intend to do.</span>
<span class="c1">#</span>


<span class="k">[format=syslog]</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%b %d %H:%M:%S&quot;</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^(?P&lt;timestamp&gt;.{15}) (?P&lt;hostname&gt;\S+) (?:(?P&lt;process&gt;\S+?)(?:\[(?P&lt;pid&gt;[0-9]+)\])?: )?&quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/messages</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/secure</span>
<span class="c1"># udp-server = 0.0.0.0</span>
<span class="c1"># tcp-server = 0.0.0.0</span>
<span class="c1"># tcp-tls-server = 0.0.0.0</span>

<span class="c1"># Two TLS modes are available:</span>
<span class="c1"># x509: x509 based certificate authentication</span>
<span class="c1"># anonymous: Anonymous TLS connection using ANON-ECDH or ANON-DH</span>
<span class="c1">#</span>
<span class="c1"># Both modes can be combined, and the default value is x509.</span>
<span class="c1"># tls-mode = x509 anonymous</span>

<span class="c1"># Path for client key, certificate, and certificate authority files.</span>
<span class="c1"># tls-key-file = /path/to/client.key</span>
<span class="c1"># tls-cert-file = /path/to/client.cert</span>
<span class="c1"># tls-ca-file = /path/to/server.ca</span>

<span class="c1"># TLS verification options:</span>
<span class="c1">#</span>
<span class="c1"># When a list of trusted fingerprints and/or a list of trusted names</span>
<span class="c1"># is provided, the connecting client has to match one of the provided</span>
<span class="c1"># fingerprints/names, otherwise the connection will be refused.</span>
<span class="c1">#</span>
<span class="c1"># List of trusted client fingerprints (SHA1 and MD5 formats accepted)</span>
<span class="c1"># If this option is used, then the connecting peers have to match one of the specified fingerprints.</span>
<span class="c1"># tls-trusted-fingerprint = SHA1:ae:8a:e5:97:66:2d:6d:cd:85:29:05:95:31:84:81:f1:27:3b:d1:73</span>
<span class="c1">#</span>
<span class="c1"># List of trusted client names (takes into account wildcards, and the</span>
<span class="c1"># DNSName/IPAddress subject alternative name PKIX extension)</span>
<span class="c1"># tls-trusted-name =</span>
<span class="c1">#</span>
<span class="c1"># Client certificate verification option (default is client-cert-required):</span>
<span class="c1"># client-cert-required: client has to provide a valid certificate for the authentication to succeed.</span>
<span class="c1"># client-cert-optional: client may connect without providing a valid x509 certificate.</span>
<span class="c1"># tls-verify = client-cert-required</span>



<span class="c1">#</span>
<span class="c1"># Sample configuration for metalog:</span>
<span class="c1">#</span>
<span class="k">[format=metalog]</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^(?P&lt;timestamp&gt;.{15}) \[(?P&lt;process&gt;\S+)\] &quot;</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%b %d %H:%M:%S&quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/everything/current</span>


<span class="c1">#</span>
<span class="c1"># Sample configuration for apache:</span>
<span class="c1">#</span>
<span class="c1"># Note: For apache &gt;= 2.4, you need to force ErrorLogFormat in apache configuration:</span>
<span class="c1">#       ErrorLogFormat &quot;[%t] [%l] [pid %P] %F: %E: [client %a] %M&quot;</span>
<span class="k">[format=apache]</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%d/%b/%Y:%H:%M:%S&quot;</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;(?P&lt;hostname&gt;\S+) \S+ \S+ \[(?P&lt;timestamp&gt;.{20}) [+-].{4}\] &quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/httpd/access_log</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/apache2/access_log</span>

<span class="k">[format=apache-error]</span>
<span class="na">time-format</span> <span class="o">=</span> <span class="s">&quot;%a %b %d %H:%M:%S %Y&quot;</span>
<span class="na">prefix-regex</span> <span class="o">=</span> <span class="s">&quot;^\[(?P&lt;timestamp&gt;.{24})\] \S+ (\[client (?P&lt;hostname&gt;\S+)\] )?&quot;</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/httpd/error_log</span>
<span class="na">file</span> <span class="o">=</span> <span class="s">/var/log/apache2/error_log</span>


<span class="c1">#</span>
<span class="c1"># Sample configuration for asterisk:</span>
<span class="c1">#</span>
<span class="c1">#[format=asterisk]</span>
<span class="c1">#time-format = &quot;%b %d %H:%M:%S&quot;</span>
<span class="c1">#prefix-regex = &quot;^(?P&lt;timestamp&gt;.{15}) (?P&lt;hostname&gt;\S+) (?:(?P&lt;process&gt;\S+?)(?:\[(?P&lt;pid&gt;[0-9]+)\])? (\S*): )?&quot;</span>
<span class="c1">#file = /var/log/asterisk/messages</span>


<span class="c1">#</span>
<span class="c1"># Specifies the maximum length of logs, in bytes.</span>
<span class="c1"># If the log exceeds this size, it will be split into several parts,</span>
<span class="c1"># each one processed successively et independently of each other.</span>
<span class="c1">#</span>
<span class="c1"># log-max-length = 8192</span>


<span class="c1">#</span>
<span class="c1"># Specifies the maximum difference, in seconds and/or size, between</span>
<span class="c1"># the interval of two logfile rotations. If this difference is reached,</span>
<span class="c1"># a high severity alert will be emitted. The K (kbytes) or M (mbytes)</span>
<span class="c1"># suffix might be used for size definition.</span>
<span class="c1">#</span>
<span class="c1">#max-rotation-size-offset = 1024</span>
<span class="c1">#max-rotation-time-offset = 300</span>


<span class="c1">#</span>
<span class="c1"># Maximum number of warnings a given source should emit in case it can</span>
<span class="c1"># not parse log entries with the provided prefix_regex and time_format.</span>
<span class="c1">#</span>
<span class="c1"># -1 == unlimited number of warnings</span>
<span class="c1">#  0 == no warning at all</span>
<span class="c1">#  X == print at most X warnings.</span>
<span class="c1">#</span>
<span class="c1"># warning-limit = -1</span>


<span class="c1">#####################################</span>
<span class="c1"># Here starts plugins configuration #</span>
<span class="c1">#####################################</span>

<span class="k">[Pcre]</span>

<span class="na">ruleset</span><span class="o">=</span><span class="s">@configdir@/ruleset/pcre.rules</span>


<span class="c1"># [Debug]</span>
<span class="c1">#</span>
<span class="c1"># This plugin issues an alert for each packet.</span>
<span class="c1"># Careful to the logging activity it generates.</span>
<span class="c1">#</span>
<span class="c1"># Trigger reporting to the console.</span>
<span class="c1"># stderr</span>


<span class="c1">#######################</span>
<span class="c1"># Global TLS settings #</span>
<span class="c1">#######################</span>
<span class="c1">#</span>
<span class="c1"># Number of bits for the prime used in the Diffie-Hellman key exchange.</span>
<span class="c1"># Note that the value should be one of 768, 1024, 2048, 3072 or 4096.</span>
<span class="c1"># The default is 1024.</span>
<span class="c1">#</span>
<span class="c1"># dh-prime-length = 1024</span>
<span class="c1">#</span>
<span class="c1"># How often to regenerate the parameters used in the Diffie-Hellman key</span>
<span class="c1"># exchange. These should be discarded and regenerated once a day, once</span>
<span class="c1"># a week or once a month, depending on the security requirements.</span>
<span class="c1">#</span>
<span class="c1"># Generation is a CPU-intensive operation. The value is in hours,</span>
<span class="c1"># 0 disables regeneration entirely. The default is 24 hours.</span>
<span class="c1">#</span>
<span class="c1"># dh-parameters-regenerate = 24</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-de-prelude-correlator-prelude-correlator-conf">
<h2>Prelude Correlator configuration file: prelude-correlator.conf<a class="headerlink" href="#fichier-de-configuration-de-prelude-correlator-prelude-correlator-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a template configuration file for prelude-correlator</span>
<span class="c1">#</span>

<span class="na">include</span> <span class="o">=</span> <span class="s">/etc/prelude/default/idmef-client.conf</span>

<span class="k">[general]</span>
<span class="c1">#</span>
<span class="c1"># Only attempt to correlate input events that match the following criteria:</span>
<span class="c1"># criteria =</span>
<span class="c1">#</span>
<span class="c1"># Only correlate input events sharing the same value for the following path.</span>
<span class="c1"># Note that this feature should be used with caution, as the number of</span>
<span class="c1"># contexts will rise with the number of different existing values.</span>
<span class="c1"># grouping =</span>


<span class="c1"># Plugin configuration:</span>
<span class="c1">#</span>

<span class="c1"># [BruteForcePlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>

<span class="c1"># Disable BusinessHour correlation by default since it is very verbose</span>
<span class="k">[BusinessHourPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">true</span>

<span class="c1">#</span>
<span class="c1"># [OpenSSHAuthPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># [EventScanPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># [EventStormPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># [EventSweepPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># [WormPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1"># repeat-target = 5</span>
<span class="c1">#</span>
<span class="c1"># [CIArmyPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># How often in seconds the CIArmy database should be reloaded (download + reload)</span>
<span class="c1"># (default: once a week). 0 to disable reloading.</span>
<span class="c1"># reload  = 604800</span>
<span class="c1">#</span>
<span class="c1"># The address to load the CIArmy database from:</span>
<span class="c1"># uri = http://cinsscore.com/list/ci-badguys.txt</span>
<span class="c1">#</span>
<span class="c1"># Define the maximum allowed time for downloading the database</span>
<span class="c1"># timeout = 10</span>
<span class="c1">#</span>
<span class="c1"># Define the path to the database file</span>
<span class="c1"># filename = /var/lib/prelude-correlator/prelude-correlator/ciarmy.dat</span>
<span class="c1">#</span>
<span class="c1"># [DshieldPlugin]</span>
<span class="c1"># disable = false</span>
<span class="c1">#</span>
<span class="c1"># How often the Dshield database should be reloaded (download + reload)</span>
<span class="c1"># (default: once a week). 0 to disable reloading.</span>
<span class="c1"># reload  = 604800</span>
<span class="c1">#</span>
<span class="c1"># The address to load the Dshield database from:</span>
<span class="c1"># uri = http://www.dshield.org/ipsascii.html?limit=10000</span>
<span class="c1">#</span>
<span class="c1"># Define the maximum allowed time for downloading the database</span>
<span class="c1"># timeout = 10</span>
<span class="c1">#</span>
<span class="c1"># Define the path to the database file</span>
<span class="c1"># filename = /var/lib/prelude-correlator/prelude-correlator/dshield.dat</span>

<span class="c1"># [SpamhausDropPlugin]</span>
<span class="c1">#</span>
<span class="c1"># Note: the python-netaddr package is required for this plugin to work.</span>
<span class="c1"># Also, versions 0.7.10 to 0.7.15 (inclusive) are known to be very slow</span>
<span class="c1"># due to a bug in python-netaddr.</span>
<span class="c1"># See https://github.com/drkjam/netaddr/issues/94 for more information</span>
<span class="c1">#</span>
<span class="c1"># disable = true</span>
<span class="c1">#</span>
<span class="c1"># How often the Spamhaus database should be reloaded (download + reload)</span>
<span class="c1"># (default: once a week). 0 to disable reloading.</span>
<span class="c1"># reload  = 604800</span>
<span class="c1">#</span>
<span class="c1"># The address to load the Spamhaus database from:</span>
<span class="c1"># uri = http://www.spamhaus.org/drop/drop.txt</span>
<span class="c1">#</span>
<span class="c1"># Define the maximum allowed time for downloading the database</span>
<span class="c1"># timeout = 10</span>
<span class="c1">#</span>
<span class="c1"># Define the path to the database file</span>
<span class="c1"># filename = /var/lib/prelude-correlator/prelude-correlator/spamhaus_drop.dat</span>
<span class="c1">#</span>
<span class="c1"># This plugin will report CorrelationAlert for events / sets of events</span>
<span class="c1"># that appear to have passed through a firewall known to protect the</span>
<span class="c1"># target machine.</span>
<span class="c1">#</span>
<span class="c1"># If no firewall ever emit block concerning a given host, then this host</span>
<span class="c1"># is considered un-protected, and there is no point in reporting</span>
<span class="c1"># CorrelationAlert.</span>
<span class="c1">#</span>
<span class="c1"># The &#39;flush-protected-hosts&#39; variable allow you to define how much</span>
<span class="c1"># time a given target hosts should be considered as protected when a</span>
<span class="c1"># firewall drop is noticed for this machine.</span>
<span class="c1">#</span>
<span class="c1"># The plugin is disabled by default since it tend to be very verbose</span>

<span class="k">[FirewallPlugin]</span>
<span class="na">disable</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">flush-protected-hosts</span> <span class="o">=</span> <span class="s">3600</span>

<span class="c1"># [python_rules]</span>
<span class="c1"># Python rules folder</span>
<span class="c1"># paths = /etc/prelude-correlator/rules/python</span>

<span class="c1"># Logging configuration might also be defined in this file:</span>
<span class="c1"># http://docs.python.org/library/logging.html</span>

<span class="c1"># Include additional configuration files</span>
<span class="k">[include]</span>
<span class="na">conf.d/*.conf</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-de-prelude-gui-prewikka-conf">
<h2>Prelude GUI configuration file: prewikka.conf<a class="headerlink" href="#fichier-de-configuration-de-prelude-gui-prewikka-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">##########################</span>
<span class="c1"># Prewikka configuration</span>
<span class="c1">##########################</span>

<span class="k">[general]</span>
<span class="c1"># Location of the help server</span>
<span class="c1">#help_location: http://doc.prelude/rst/${lang}/${path}</span>

<span class="c1"># Number of heartbeats to analyze in the heartbeat analysis view.</span>
<span class="c1">#heartbeat_count: 30</span>

<span class="c1"># If the offset between two heartbeats is off by more than the specified</span>
<span class="c1"># offset (in seconds), the analyzer will be represented as offline.</span>
<span class="c1">#heartbeat_error_margin: 3</span>

<span class="c1"># Open external (references, IP lookup, and port lookup) links</span>
<span class="c1"># in a new windows.</span>
<span class="na">external_link_new_window: yes</span>

<span class="c1"># Enables details links (default: no)</span>
<span class="na">enable_details: no</span>
<span class="c1"># Enable error traceback (default: yes)</span>
<span class="na">enable_error_traceback: yes</span>
<span class="c1"># URL to get details about an host</span>
<span class="na">host_details_url: http://www.prelude-siem.com/host_details.php</span>
<span class="c1"># URL to get details about a port</span>
<span class="na">port_details_url: http://www.prelude-siem.com/port_details.php</span>
<span class="c1"># URL to get details about a classification reference</span>
<span class="na">reference_details_url: http://www.prelude-siem.com/reference_details.php</span>

<span class="c1"># When the number of classifications, sources or targets exceeds</span>
<span class="c1"># the defined value, an expansion link will be provided to look up</span>
<span class="c1"># the remaining entries.</span>
<span class="c1">#</span>
<span class="c1"># max_aggregated_source: 3</span>
<span class="c1"># max_aggregated_target: 3</span>
<span class="c1"># max_aggregated_classification: 10</span>

<span class="c1"># Asynchronous DNS resolution (require twisted.names and twisted.internet)</span>
<span class="c1">#</span>
<span class="c1"># While rendering view containing address scheduled for asynchronous</span>
<span class="c1"># DNS resolution, it is possible that the rendering terminate too fast</span>
<span class="c1"># for all DNS requests to complete.</span>
<span class="c1">#</span>
<span class="c1"># The dns_max_delay setting determine Prewikka behavior:</span>
<span class="c1"># - [-1] No DNS resolution is performed.</span>
<span class="c1"># - [0] Do not wait, immediatly send results to the client.</span>
<span class="c1"># - [x] Wait at most x seconds, then send results to the client.</span>
<span class="c1">#</span>
<span class="c1"># dns_max_delay: 0</span>


<span class="c1"># Default locale to use (default is English)</span>
<span class="c1"># The supported locales are: de_DE, en_GB, es_ES, fr_FR, it_IT, pl_PL, pt_BR, ru_RU</span>
<span class="c1">#</span>
<span class="c1"># default_locale: en_GB</span>

<span class="c1"># Default theme to use (default is cs)</span>
<span class="c1"># The supported themes are: blue, bright, classic, cs, dark, green, yellow</span>
<span class="c1">#</span>
<span class="c1"># default_theme: cs</span>

<span class="c1"># Default timezone to use (default is the local timezone)</span>
<span class="c1"># The supported timezones follow the IANA naming convention,</span>
<span class="c1"># for instance: UTC, Africa/Abidjan, Europe/Zurich...</span>
<span class="c1">#</span>
<span class="c1"># default_timezone: UTC</span>

<span class="c1"># Default encoding to use (default is UTF8):</span>
<span class="c1"># encoding: utf8</span>

<span class="c1"># Public path to Prewikka in case the application is being served</span>
<span class="c1"># through a reverse proxy, including any necessary port information.</span>
<span class="c1"># reverse_path: http://example.com/proxied/prewikka/</span>


<span class="k">[interface]</span>
<span class="c1"># Software name displayed in the top left corner (displays logo if not defined)</span>
<span class="c1"># software: Prelude</span>

<span class="c1"># Webpage title</span>
<span class="c1"># browser_title: Prelude</span>

<span class="c1"># Path to the file defining the menu entries order:</span>
<span class="c1"># menu_order: menu.yml</span>


<span class="c1">############################</span>
<span class="c1"># Customizable search pages</span>
<span class="c1">############################</span>
<span class="c1"># Define additional fields to be displayed in search pages</span>

<span class="c1"># [datasearch alert]</span>
<span class="c1"># extra_fields: alert.source.user.user_id.name, alert.target.user.user_id.name</span>

<span class="c1"># [datasearch heartbeat]</span>
<span class="c1"># extra_fields: heartbeat.messageid</span>


<span class="c1">#####################</span>
<span class="c1"># Customizable links</span>
<span class="c1">#####################</span>
<span class="c1"># Define custom links and paths for which these links may be displayed</span>

<span class="c1"># [url host]</span>
<span class="c1"># paths: alert.source.node.address.address, alert.target.node.address.address</span>
<span class="c1"># label: http://url?host=$value</span>

<span class="c1"># [url classification]</span>
<span class="c1"># paths: alert.classification.text</span>
<span class="c1"># label: http://url?classification=$value</span>

<span class="c1"># [url time]</span>
<span class="c1"># paths: alert.create_time</span>
<span class="c1"># label: http://url?time=$value</span>


<span class="c1">############</span>
<span class="c1"># Databases</span>
<span class="c1">############</span>

<span class="c1"># Events DB</span>
<span class="k">[idmef_database]</span>
<span class="c1"># type: pgsql | mysql | sqlite3</span>
<span class="c1"># For sqlite, add</span>
<span class="c1"># file: /path/to/your/sqlite_database</span>
<span class="c1">#</span>
<span class="na">type: pgsql</span>
<span class="na">host: localhost</span>
<span class="na">user: prelude</span>
<span class="na">pass: prelude</span>
<span class="na">name: prelude</span>

<span class="c1"># Prewikka DB</span>
<span class="k">[database]</span>
<span class="na">type: pgsql</span>
<span class="na">host: localhost</span>
<span class="na">user: prelude</span>
<span class="na">pass: prelude</span>
<span class="na">name: prewikka</span>


<span class="c1">##########</span>
<span class="c1"># Logging</span>
<span class="c1">##########</span>
<span class="c1"># - You can activate several log section.</span>
<span class="c1"># - Log level might be set to all/debug, info, warning, error, critical.</span>
<span class="c1">#   If unspecified, the default level is &quot;warning&quot;.</span>

<span class="c1"># [log stderr]</span>
<span class="c1"># level: info</span>

<span class="c1"># [log file]</span>
<span class="c1"># level: debug</span>
<span class="c1"># file: /tmp/prewikka.log</span>

<span class="k">[log syslog]</span>
<span class="na">level: info</span>

<span class="c1"># [log nteventlog]</span>
<span class="c1"># level: info</span>

<span class="c1"># [log smtp]</span>
<span class="c1"># level: warning</span>
<span class="c1"># host: mail.domain.com</span>
<span class="c1"># from: user@address</span>
<span class="c1"># to: recipient1@address, recipient2@address, recipientN@address</span>
<span class="c1"># subject: Subject to use</span>


<span class="c1">############</span>
<span class="c1"># Cron jobs</span>
<span class="c1">############</span>
<span class="c1"># Define parameters for different cron jobs.</span>
<span class="c1"># Cron jobs must be enabled from the GUI to be executed.</span>

<span class="c1"># Periodic alert deletion</span>
<span class="c1"># [cron alert]</span>
<span class="c1">#</span>
<span class="c1"># Minimal age in days for alerts to be deleted (default is not to delete alerts)</span>
<span class="c1"># age: 30</span>
<span class="c1">#</span>
<span class="c1"># It is also possible to define this value per severity (default is to use the age above):</span>
<span class="c1"># high: 365</span>
<span class="c1"># medium: 90</span>
<span class="c1"># low: 30</span>
<span class="c1"># info: 7</span>

<span class="c1"># Periodic heartbeat deletion</span>
<span class="c1"># [cron heartbeat]</span>
<span class="c1">#</span>
<span class="c1"># Minimal age in days for heartbeats to be deleted (default is not to delete heartbeats)</span>
<span class="c1"># age: 7</span>

<span class="c1"># Periodic search history entries deletion</span>
<span class="c1"># [cron search_history]</span>
<span class="c1">#</span>
<span class="c1"># Maximal number of entries per user to be kept (default is 10)</span>
<span class="c1"># size: 10</span>


<span class="k">[include]</span>
<span class="na">conf.d/*.conf</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-additionnel-de-prelude-gui-alerts-conf">
<h2>Additional Prelude GUI configuration file: alerts.conf<a class="headerlink" href="#fichier-de-configuration-additionnel-de-prelude-gui-alerts-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================= Prelude SIEM Configuration =========================</span>
<span class="c1">#</span>
<span class="c1"># This file is a part of the Prelude SIEM configurations files.</span>
<span class="c1"># Purpose:  Tune the datasearch pages based on alerts data (such as alerts,</span>
<span class="c1">#           threats).</span>
<span class="c1">#</span>
<span class="c1"># ----------------------------------- Alerts -----------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Add extra columns to any DataSearch page containing data from this type:</span>
<span class="c1">#   - Must be a valid IDMEF path (RFC 4765)</span>
<span class="c1">#</span>
<span class="c1">#[datasearch alert]</span>
<span class="c1">#extra_fields = alert.messageid, alert.classification.text</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-additionnel-de-prelude-gui-auth-conf">
<h2>Additional Prelude GUI configuration file: auth.conf<a class="headerlink" href="#fichier-de-configuration-additionnel-de-prelude-gui-auth-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================= Prelude SIEM Configuration =========================</span>
<span class="c1">#</span>
<span class="c1"># This file is a part of the Prelude SIEM configuration files.</span>
<span class="c1"># Purpose:  Tune the authentication process.</span>
<span class="c1">#</span>
<span class="c1"># -------------------------- Standard authentication ---------------------------</span>
<span class="c1">#</span>
<span class="c1"># Use the standard login/password authentication with a session expiration time:</span>
<span class="c1">#</span>
<span class="k">[session loginform]</span>
<span class="na">expiration: 60</span>
<span class="na">footer: Prelude SIEM $version</span>
<span class="c1">#</span>
<span class="c1"># --------------------------- Disable authentication ---------------------------</span>
<span class="c1">#</span>
<span class="c1"># Disable Prewikka authentication:</span>
<span class="c1">#</span>
<span class="c1">#[session anonymous]</span>
<span class="c1">#</span>
<span class="c1"># ------------------------------- Users database -------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Retrieve Prewikka Users through database.</span>
<span class="c1"># If there is no user with administrative rights defined in the database,</span>
<span class="c1"># the initial user will be created according to these settings:</span>
<span class="c1">#</span>
<span class="k">[auth dbauth]</span>
<span class="na">initial_admin_user: admin</span>
<span class="na">initial_admin_pass: admin</span>
<span class="c1">#</span>
<span class="c1"># List of supported hashing algorithms for passwords, separated by spaces.</span>
<span class="c1"># The first one available on the system will be used.</span>
<span class="c1"># See http://passlib.readthedocs.io/en/stable/lib/passlib.hash.html</span>
<span class="na">password_schemes: sha256_crypt</span>
<span class="c1">#</span>
<span class="c1"># List of deprecated hashing algorithms for passwords, separated by spaces.</span>
<span class="c1"># Passwords hashed using one of these algorithms will be rehashed</span>
<span class="c1"># when the user next logs in.</span>
<span class="na">deprecated_password_schemes: hex_md5</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-additionnel-de-prelude-gui-external-app-conf">
<h2>Additional Prelude GUI configuration file: external_app.conf<a class="headerlink" href="#fichier-de-configuration-additionnel-de-prelude-gui-external-app-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================= Prelude SIEM Configuration =========================</span>
<span class="c1">#</span>
<span class="c1"># This file is a part of the Prelude SIEM configurations files.</span>
<span class="c1"># Purpose:  Add your external applications and their configurations.</span>
<span class="c1">#</span>
<span class="c1"># ---------------------------- External applications ---------------------------</span>
<span class="c1">#</span>
<span class="c1"># Add external applications displayed into an iframe:</span>
<span class="c1">#   - section:    text displayed in the menu and to use in menupro.yml</span>
<span class="c1">#   - base_url:   initial URL of the external application</span>
<span class="c1">#   - tab:        view&#39;s tabs, each view can have one or more tab</span>
<span class="c1">#   - tab_url:    URL for each tab, can be absolute or relative (to the base_url)</span>
<span class="c1">#   - permission: existing or custom access permission (optional)</span>
<span class="c1">#   - help:       absolute URL pointing to a help page about the application (optional)</span>
<span class="c1">#</span>
<span class="c1">#[appli app1]</span>
<span class="c1">#section: Application1</span>
<span class="c1">#base_url: http://app1</span>
<span class="c1">#tab: tab1, tab2</span>
<span class="c1">#tab_url: /tab1, /tab2</span>
<span class="c1">#permission: CUSTOM_PERMISSION</span>
<span class="c1">#help: http://app1/help.html</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-additionnel-de-prelude-gui-logs-conf">
<h2>Additional Prelude GUI configuration file: logs.conf<a class="headerlink" href="#fichier-de-configuration-additionnel-de-prelude-gui-logs-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================= Prelude SIEM Configuration =========================</span>
<span class="c1">#</span>
<span class="c1"># This file is a part of the Prelude SIEM configuration files.</span>
<span class="c1"># Purpose:  Tune the way of retrieving the logs data from an Elasticsearch</span>
<span class="c1">#           instance.</span>
<span class="c1">#</span>
<span class="c1"># ------------------------------------ Logs ------------------------------------</span>
<span class="c1">#</span>
<span class="c1"># The section below defines a mapping between the fields recognized by Prelude</span>
<span class="c1"># and the fields defined in the logs index(es) of the Elasticsearch cluster.</span>
<span class="c1">#</span>
<span class="c1"># Fields must only use alphanumeric chars, &quot;_&quot; or &quot;-&quot; and must not start with &quot;-&quot;.</span>
<span class="c1">#</span>
<span class="c1"># The first value is the field used during regular searches.</span>
<span class="c1"># The second value is the field used for aggregation.</span>
<span class="c1"># If omitted, it defaults to the first value.</span>
<span class="c1">#</span>
<span class="c1">#[elasticsearch log]</span>
<span class="c1">#es_url: http://&lt;es-ip&gt;:9200/&lt;index-name-for-logs&gt;</span>
<span class="c1">#es_user:</span>
<span class="c1">#es_pass:</span>
<span class="c1">#es_type: log</span>
<span class="c1">#</span>
<span class="c1"># Time format expected by Elasticsearch (default is to use ISO formatting)</span>
<span class="c1"># Special &quot;@&quot; value that formats the dates/times into UNIX timestamps</span>
<span class="c1">#es_timeformat: %Y-%m-%d %H:%M:%S</span>
<span class="c1">#</span>
<span class="c1"># Default field to use when typing in the search bar</span>
<span class="c1">#default_field: message</span>
<span class="c1">#</span>
<span class="c1"># Fields:</span>
<span class="c1">#program: syslog_program, syslog_program.raw</span>
<span class="c1">#host: syslog_hostname, syslog_hostname.raw</span>
<span class="c1">#message: syslog_message</span>
<span class="c1">#timestamp: @timestamp</span>
</pre></div>
</div>
</div>
<div class="section" id="fichier-de-configuration-additionnel-de-prelude-gui-riskoverview-conf">
<h2>Additional Prelude GUI configuration file: riskoverview.conf<a class="headerlink" href="#fichier-de-configuration-additionnel-de-prelude-gui-riskoverview-conf" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================= Prelude SIEM Configuration =========================</span>
<span class="c1">#</span>
<span class="c1"># This file is a part of the Prelude SIEM configuration files.</span>
<span class="c1"># Purpose:  Configure the risk overview.</span>
<span class="c1">#</span>
<span class="c1"># -------------------------------- Risk Overview -------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Reordering entries will affect the display order of the widgets in the GUI.</span>
<span class="c1"># Commenting an entry will disable the display of the widget.</span>
<span class="c1">#</span>
<span class="c1"># [riskoverview]</span>
<span class="c1"># agents</span>
<span class="c1"># archive</span>
<span class="c1"># alerts</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="annexe-aide-de-prelude-siem">
<h1>Annex: Prelude SIEM help<a class="headerlink" href="#annexe-aide-de-prelude-siem" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aide-de-prelude-manager">
<h2>Prelude Manager help<a class="headerlink" href="#aide-de-prelude-manager" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME
   prelude-manager - Collects and normalize events.

SYNOPSIS
   prelude-manager [options]

DESCRIPTION
   Prelude Manager is a high-availability server which can collect, fil-
ter, relay, reverse-relay, normalize and store events. Events can come
from registered analyzers and/or managers. The common usage is to
store nomalized events into a database, thus this can be extended to
store informations in plain text or xml files.

OPTIONS
   Some prelude-manager option are contextual, they have to be prefixed
   by another.
   --prelude Prelude generic options
   --profile=&lt;name&gt; Profile to use for this analyzer
   --heartbeat-interval=&lt;interval&gt; Number of seconds between two heart-
   beat
   --server-addr=&lt;address&gt; Address where this sensor should report to
   (addr:port)
   --analyzer-name=&lt;name&gt; Name for this analyzer
   --db=&lt;INAME&gt;

      Options for the libpreludedb plugin
      -t, --type=&lt;type&gt; Type of database (mysql/pgsql/sqlite3)
      -l, --log=&lt;file name&gt; Log all queries in a file, should be only
      used for debugging purpose
      -h, --host=&lt;address&gt; The host where the database server is run-
      ning (in case of client/server database)
      -f, --file=&lt;file name&gt; The file where the database is stored (in
      case of file based database)
      -p, --port=&lt;port number&gt; The port where the database server is
      listening (in case of client/server database)
      -d, --name=&lt;name&gt; The name of the database where the alerts will
      be stored
      -u, --user=&lt;user&gt; User of the database (in case of client/server
      database)
      -P, --pass=&lt;password&gt; Password for the user (in case of
      client/server database)

   --debug=&lt;INAME&gt;
      Option for the debug plugin
      -o, --object=&lt;name&gt; Name of IDMEF object to print (no object pro-
      vided will print the entire message)
      -l, --logfile=&lt;file name&gt; Specify output file to use (default to
      stdout)

   --relaying=&lt;INAME&gt;
      Relaying plugin option
      -p, --parent-managers=&lt;address&gt; List of managers address:port
      pair where messages should be sent to

   --textmod=&lt;INAME&gt;
      Option for the textmod plugin
      -l, --logfile=&lt;file name&gt; Specify logfile to use

   --xmlmod=&lt;INAME&gt;
      Option for the xmlmod plugin
      -l, --logfile=&lt;file name&gt; Specify output file to use
      -v, --validate=&lt;xml&gt; Validate IDMEF XML output against DTD
      -f, --format=&lt;format&gt; Format XML output so that it is readable
      -d, --disable-buffering=&lt;boolean&gt; Disable output file buffering
      to prevent truncated tags
      --idmef-criteria-filter=&lt;INAME&gt; Filter message based on IDMEF
      criteria
      -r, --rule=&lt;rule&gt; Filter rule, or filename containing rule
      --hook=&lt;value&gt; Where the filter should be hooked (report-
      ing|reverse-relaying|plugin name)

   --config=&lt;file name&gt;
      Configuration file to use

   -v, --version
      Print version number

   -D, --debug-level=&lt;level&gt;
      Run in debug mode

   -d, --daemon
      Run in daemon mode

   -P, --pidfile=&lt;file name&gt;
      Write Prelude PID to pidfile

   -c, --child-managers=&lt;address&gt;
      List of managers address:port pair where messages should be gath-
      ered from

   -l, --listen=&lt;address&gt;
      Address the sensors server should listen on (addr:port)

   -f, --failover=&lt;boolean&gt;
      Enable failover for specified report plugin

   -h, --help
      Print help

FILES
   /etc/prelude/prelude-manager.conf - the configuration file

BUGS
   This man page hadn’t been proof-read yet.

SEE ALSO
   prelude-adduser(1)
</pre></div>
</div>
</div>
<div class="section" id="aide-de-prelude-lml">
<h2>Prelude LML help<a class="headerlink" href="#aide-de-prelude-lml" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME

Prelude LML - Analyze and convert &quot;syslog&quot; contents in IDMEF format.

SYNOPSIS

prelude-lml [options]

DESCRIPTION

Prelude LML is a part of the project that deals with host based intrusion detection
aspects through log analysis. It can monitor files created by a syslog daemon coming from
different hosts on heterogeneous platforms, other types of single-line event logs, or
simulate a syslog server on its own. Thus any system generating logs can benefit from the
Prelude LML&#39;s analysis engine

OPTIONS

Some Prelude LML options are contextual, they have to be prefixed by another one.

--prelude                         Prelude generic options
   --profile=ARG                   Profile to use for this analyzer
   --heartbeat-interval=ARG        Number of seconds between two heartbeat
   --server-addr=ARG               Address where this agent should report
                                   events to (addr:port)
   --tls-options=ARG               TLS ciphers, key exchange methods,
                                   protocols, macs, and compression options
   --analyzer-name=[ARG]           Name for this analyzer

--debug=[INAME]                   Debug plugin option
   -s, --stderr                    Output to stderr when plugin is called

--pcre=[INAME]                    Pcre plugin option
   -r, --ruleset=ARG               Ruleset to use
   -l, --last-first                Process rules with the &quot;last&quot; attribute first
       --dump-unmatched            Dump unmatched log entry

-h, --help                        Print this help
-v, --version                     Print version number
    --user=ARG                    Set the user ID used by Prelude LML
    --group=ARG                   Set the group ID used by Prelude LML
-q, --quiet                       Quiet mode
-D, --debug-level=[ARG]           Debug mode
-d, --daemon                      Run in daemon mode
-P, --pidfile=ARG                 Write Prelude LML PID to specified file
    --text-output=[ARG]           Dump alert to stdout, or to the specified file
    --dry-run                     No alert emission / Prelude connection
-c, --config=ARG                  Configuration file to use
-l, --log-max-length=ARG          Specify maximum line length for log (default is 8192 bytes).
    --max-rotation-time-offset=ARG Specifies the maximum time difference, in seconds, between
                                  the time of logfiles rotation. If this amount is reached,
                                  a high severity alert will be emitted
    --max-rotation-size-offset=ARG Specifies the maximum size difference between two logfile
                                  rotation. If this difference is reached,
                                  a high severity alert will be emitted
    --warning-limit=ARG           Limit the number of parse warnings reported from sources
                                  (0 suppress, -1 unlimited, or user defined number)
-b, --batch-mode                  Tell LML to run in batch mode
    --metadata=ARG                Specify whether log analysis should begin from &#39;head&#39;, &#39;tail&#39;,
                                  or &#39;last&#39; known file position. You can also use the &#39;nowrite&#39;
                                  attribute so that existing file metadata are not overwritten.
                                  The default value is &#39;last&#39;
    --no-resolve                  Do not attempt to resolve target address (useful for profiling)

--format=[INAME]
  -t, --time-format=ARG            Specify the input timestamp format
  -p, --prefix-regex=ARG           Specify the input prefix format
  -f, --file=ARG                   Specify a file to monitor (use &quot;-&quot; for standard input)
  -u, --udp-server=[ARG]           address:port pair to listen to syslog to UDP messages
                                   (default port 514) -- default protocol
  -w, --tcp-server=[ARG]           address:port pair to listen to syslog to TCP messages
                                   (default port 514)
  -s, --tcp-tls-server=[ARG]       address:port pair to listen to syslog to TCP/TLS messages
                                   (default port 6514)
      --tls-ca-file=[ARG]          Access path of certificate authority file
      --tls-key-file=[ARG]         Access path of private key file
      --tls-cert-file=[ARG]        Access path of certificate file
      --tls-trusted-name=ARG       List of trusted certificate name
      --tls-trusted-fingerprint=ARG List of trusted certificate fingerprint
                                   (MD5 and SHA1 supported)
      --tls-mode=[ARG]             TLS authentification mode, separated by space.
                                   Supported mode are &#39;x509&#39; and &#39;anonymous&#39;
                                   (default value is &#39;x509&#39;).
      --tls-verify=[ARG]           Type of certificate verification :
                                   &#39;client-cert-required&#39; or &#39;client-cert-optional&#39;
  -c, --charset=ARG                Specify the charset used by the input file
      --idmef-alter=ARG            Assign specific IDMEF path/value to matching log entry
      --idmef-alter-force=ARG      Assign specific IDMEF path/value to matching log entry,
                                   even if path is already used
</pre></div>
</div>
</div>
<div class="section" id="aide-de-prelude-correlator">
<h2>Prelude Correlator help<a class="headerlink" href="#aide-de-prelude-correlator" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME

    Prelude Correlator

SYNOPSIS

    prelude-correlator [options]

DESCRIPTION

    Prelude-Correlator allows conducting multistream correlations thanks to a powerful programming
    language for writing correlation rules. With any type of alert able to be correlated, event
    analysis becomes simpler, quicker and more incisive.

OPTIONS

    --version             show program&#39;s version number and exit
    -h, --help            show this help message and exit
    -c FILE, --config=FILE
                          Configuration file to use
    --dry-run             No report to the specified Manager will occur
    -d, --daemon          Run in daemon mode
    -P FILE, --pidfile=FILE
                          Write Prelude Correlator PID to specified file
    --print-input=FILE    Dump alert input from manager to the specified file
    --print-output=FILE   Dump alert output to the specified file
    -D LEVEL, --debug=LEVEL
                          Enable debug output (optional debug level argument)

    IDMEF Input:
      Read IDMEF events from file

      --input-file=FILE   Read IDMEF events from the specified file
      --input-offset=OFFSET
                          Start processing events starting at the given offset
      --input-limit=LIMIT
                          Read events until the given limit is reached

    Prelude:
      Prelude generic options

      --profile=PROFILE   Profile to use for this analyzer
</pre></div>
</div>
</div>
<div class="section" id="aide-de-prelude-admin">
<h2>prelude-admin help<a class="headerlink" href="#aide-de-prelude-admin" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME
   prelude-admin - Manage agents accounts

SYNOPSIS
   prelude-admin &lt;subcommand&gt; [options] [args]
   prelude-admin add &lt;profile name&gt; [--uid UID] [--gid GID]
   prelude-admin chown &lt;profile name&gt; [--uid UID] [--gid GID]
   prelude-admin del &lt;profile name&gt;
   prelude-admin rename &lt;profile name&gt; &lt;profile name&gt;
   prelude-admin register &lt;profile name&gt; &lt;wanted permission&gt; &lt;registration-
   server address&gt; [--uid UID] [--gid GID] [--passwd=PASSWD&gt;] [--passwd-
   file=&lt;FILE&gt;]
   prelude-admin registration-server &lt;profile name&gt; [--uid UID] [--gid GID]
   [--prompt] [--passwd=PASSWD&gt;] [--passwd-file=&lt;FILE&gt;] [--keepalive] [--no-
   confirm] [--listen]
   prelude-admin revoke &lt;profile&gt; &lt;analyzerID&gt; [--uid UID] [--gid GID]

DESCRIPTION

   In order for an agent to communicate with a manager, it must be registered.
   Registration involves several steps:
   - Allocating an unique identity for the agent
   - Creating directory to be used by the agent (example: failover purpose)
   - Registering to a remote ’prelude-manager’: get a signed X509 certificate
   that will allow communication between agent and manager using the specified
   permissions.

   All these informations are stored in an agent profile.

   An agent profile is identified by its name. When an agent is started, it
   will load the profile of the same name as the program itself, that is, if
   your agent is named &quot;prelude-lml&quot;, the agent will load the profile named
   &quot;prelude-lml&quot;.

   The name of the profile can be overriden using the ’--prelude --profile
   name_of_my_profile’ command line option. It is possible to define the pro-
   file name so that you can have several instances of one agent running with
   different permissions, using different profiles.
   Note that profiles are not specific to agents, but are used in all programs
   of the Prelude suite (agents, managers, etc).

   If you are not sure which permission your agent should get, just start it
   and default permissions will be displayed.

OPTIONS
   &lt;profile name&gt; is the default name of the agent you are installing or your
   own defined name.

   If you start your agent without prior registration, a warning is displayed
   including the default profile name on how to register the agent.
   &lt;requested permission&gt; is the permission your agent needs. It is composed
   of permission attributes (idmef or admin) and access type: read/write
   (r/w). By default, an agent need permissions for writing IDMEF to a man-
   ager, and reading administrative command sent to it. That is : &quot;idmef:w
   admin:r&quot;.

   &lt;manager address&gt; is the address of the prelude-manager you wish to regis-
   ter. this can either be its IP address or its hostname. If you made a local
   installation, you can write localhost to connect via unix socket.

   Remember to use the correct uid/gid when registering your agent. For
   instance, if you want to register snort (running with snort euid / egid),
   use --uid snort --gid snort.

   add &lt;analyzer profile&gt;
      Setup a new agent user.

      --uid=UID UID or user to use to setup agent files.
      --gid=GID GID or group to use to setup agent files.

   chown &lt;analyzer profile&gt;
      Change analyzer owner.

      --uid=UID UID or user to use to setup agent files.
      --gid=GID GID or group to use to setup agent files.

   del &lt;analyzer profile&gt;
      The delete command will remove the agent files created through &quot;add&quot;
      command. Once this is done, the analyzer can’t be used unless &quot;regis-
      ter&quot; or &quot;add&quot; is called again.

   rename &lt;analyzer profile&gt; &lt;analyzer profile&gt;
      Rename an existing analyzer.

   register &lt;profile name&gt; &lt;wanted permission&gt; &lt;registration-server address&gt;
      Register an analyzer.
      Register and create the analyzer basic setup if needed. It will also
      configure communication of this analyzer with a receiving analyzer
      (like a Manager) through the specified registration-server.

      --uid=UID UID or user to use to setup analyzer files.
      --gid=GID GID or group to use to setup analyzer files.

      --passwd=PASSWD Use provided password instead of prompting it.
      --passwd-file=-|FILE Read password from file instead of prompting it
      (- for stdin).

   registration-server &lt;profile name&gt;
      Start a registration server to register agents. This is used in order
      to register ’sending’ analyzer to ’receiving’ analyzer. &lt;profile name&gt;
      should be set to the profile name of the specified registration-server.

      --uid=UID UID or user to use to setup ’receiving’ analyzer files.
      --gid=GID GID or group to use to setup ’receiving’ analyzer files.
      --prompt Prompt for a password instead of auto generating it.
      --passwd=PASSWD Use provided password instead of auto generating it.
      --passwd-file=-|FILE Read password from file instead of auto generat-
      ing it (- for stdin).
      --keepalive Register analyzer in an infinite loop.
      --no-confirm Do not ask for confirmation on agent registration.
      --listen Address to listen on for registration request (default is
      any:5553).

   revoke &lt;profile name&gt;
      Revoke access to &lt;profile&gt; for the given analyzerID.
      --uid=UID UID or user to use to setup analyzer files.
      --gid=GID GID to group to use to setup analyzer files.

--help
   Print help
</pre></div>
</div>
</div>
<div class="section" id="aide-de-preludedb-admin">
<h2>preludedb-admin help<a class="headerlink" href="#aide-de-preludedb-admin" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME
   preludedb-admin - tool to copy, move, delete, save or restore a prelude
   database

SYNOPSIS
   preludedb-admin copy|move|delete|load|save arguments

DESCRIPTION
   preludedb-admin can be used to copy, move, delete, save or restore a pre-
   lude database, partly or in whole, while preserving IDMEF data consistency.
   Mandatory arguments

   copy Make a copy of a Prelude database to another database.

   delete Delete content of a Prelude database.

   load Load a Prelude database from a file.

   move Move content of a Prelude database to another database.

   save Save a Prelude database to a file.

   Running a command without providing arguments will display a detailed help.

EXAMPLES
   Obtaining help on a specific command:
   # preludedb-admin save
   Usage : save &lt;alert|heartbeat&gt; &lt;database&gt; &lt;filename&gt; [options]
   Example: preludedb-admin save alert &quot;type=mysql name=dbname user=prelude&quot; outputfile

   Save messages from &lt;database&gt; into [filename].
   If no filename argument is provided, data will be written to standard output.

   Database arguments:
      type : Type of database (mysql/pgsql).
      name : Name of the database.
      user : User to access the database.
      pass : Password to access the database.

   Valid options:
      --offset &lt;offset&gt; : Skip processing until ’offset’ events.
      --count &lt;count&gt; : Process at most count events.
      --query-logging [filename] : Log SQL query to the specified file.
      --criteria &lt;criteria&gt; : Only process events matching criteria.
      --events-per-transaction : Maximum number of event to process per transaction (default
      1000).

   Preludedb-admin can be useful to delete events from a prelude database :

      preludedb-admin delete alert --criteria &lt;criteria&gt; &quot;type=&lt;mysql&gt; name=&lt;dbname&gt;
      user=&lt;prelude-user&gt; pass=&lt;pass&gt;&quot;

   where criteria is an IDMEF criteria :

      preludedb-admin delete alert --criteria &quot;alert.classification.text == ’UDP packet
      dropped’&quot; &quot;type=mysql name=prelude user=prelude-user pass=prelude-pass&quot;

   This will delete all event with the classification text &quot;UDP packet
   dropped&quot; from the database.

SEE ALSO
   The Prelude Handbook: https://www.prelude-siem.org/projects/pre-
   lude/wiki/ManualUser

   Prelude homepage: http://www.prelude-siem.com/

   Creating filter using IDMEF Criteria: https://www.prelude-
   siem.org/projects/prelude/wiki/IDMEFCriteria

   Prelude IDMEF Path: https://www.prelude-siem.org/projects/pre-
   lude/wiki/IDMEFPath

BUGS
   To report a bug, please visit https://www.prelude-siem.org/
</pre></div>
</div>
<div class="figure align-center">
<img alt="../_images/cs-logo1.png" src="../_images/cs-logo1.png" />
<div class="legend">
<p><strong>CS GROUP - France</strong></p>
<p>22, Avenue Galilée</p>
<p>92350 Le Plessis-Robinson - France</p>
<p>Tel: +33 (0)1 41 28 40 00</p>
<p>Fax: +33 (0)1 41 28 40 40</p>
<p><strong>www.csgroup.eu</strong></p>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../preludesiem-installation/preludesiem-installation.html" class="btn btn-neutral float-right" title="Prelude SIEM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../preludesiem-user-guide/preludesiem-user-guide.html" class="btn btn-neutral" title="Prelude SIEM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Prelude Team.
      Last updated on 16 Sep 2020.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'5.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>